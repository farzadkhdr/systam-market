l<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>سیستەمی فرۆشتی ئەلکترۆنیات</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* هەموو CSS لێرە */
        :root {
            --primary: #4361ee;
            --primary-dark: #3a56d4;
            --secondary: #7209b7;
            --success: #4cc9f0;
            --danger: #f72585;
            --warning: #f8961e;
            --info: #4895ef;
            --dark: #212529;
            --light: #f8f9fa;
            --gray: #6c757d;
            --gray-light: #e9ecef;
            --border-radius: 10px;
            --box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--dark);
            min-height: 100vh;
            direction: rtl;
            overflow-x: hidden;
            height: 100vh;
        }
        
        /* شێوازی پەڕەی چوونەژوورەوە */
        #loginPage {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            padding: 20px;
            animation: gradientBG 10s ease infinite;
            background-size: 400% 400%;
        }
        
        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .login-container {
            width: 100%;
            max-width: 450px;
            margin: 0 auto;
        }
        
        .login-box {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 40px 30px;
            position: relative;
            overflow: hidden;
            animation: fadeIn 0.8s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .login-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .login-header .logo {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        
        .login-header h2 {
            color: var(--dark);
            margin-bottom: 10px;
            font-size: 1.8rem;
        }
        
        .login-header p {
            color: var(--gray);
            font-size: 0.9rem;
        }
        
        .login-form {
            margin-top: 20px;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--dark);
            font-weight: 500;
        }
        
        .input-group input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
        }
        
        .input-group input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }
        
        .input-group.remember {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .input-group.remember input {
            width: auto;
            margin-left: 10px;
        }
        
        .login-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            border: none;
            border-radius: var(--border-radius);
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .login-btn:hover {
            background: linear-gradient(to right, var(--primary-dark), #6310a3);
            transform: translateY(-3px);
            box-shadow: 0 7px 20px rgba(0,0,0,0.15);
        }
        
        .login-btn i {
            margin-left: 10px;
        }
        
        .login-footer {
            margin-top: 20px;
            text-align: center;
            color: var(--gray);
            font-size: 0.9rem;
        }
        
        .login-footer a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
        }
        
        .login-footer a:hover {
            text-decoration: underline;
        }
        
        .login-animation {
            display: flex;
            justify-content: center;
            margin-top: 30px;
            gap: 15px;
        }
        
        .circle {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background-color: var(--primary);
            animation: bounce 1.5s infinite;
        }
        
        .circle:nth-child(2) {
            animation-delay: 0.2s;
            background-color: var(--secondary);
        }
        
        .circle:nth-child(3) {
            animation-delay: 0.4s;
            background-color: var(--success);
        }
        
        @keyframes bounce {
            0%, 60%, 100% {
                transform: translateY(0);
            }
            30% {
                transform: translateY(-15px);
            }
        }
        
        /* شێوازی پەڕەی سەرەکی */
        .container {
            display: flex;
            min-height: 100vh;
            display: none; /* شاردراوە بۆ دەستپێک */
        }
        
        /* بارەگەی لای چەپ - مێنیو */
        .sidebar {
            width: 250px;
            background: linear-gradient(180deg, var(--dark) 0%, #343a40 100%);
            color: white;
            padding: 20px 0;
            transition: var(--transition);
            position: fixed;
            height: 100vh;
            z-index: 100;
            box-shadow: 3px 0 15px rgba(0,0,0,0.1);
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--primary) rgba(255,255,255,0.1);
        }
        
        .sidebar::-webkit-scrollbar {
            width: 6px;
        }
        
        .sidebar::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
        }
        
        .sidebar::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 10px;
        }
        
        .sidebar::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }
        
        .sidebar.collapsed {
            transform: translateX(-250px);
        }
        
        .sidebar-header {
            padding: 0 20px 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .sidebar-header h3 {
            font-size: 1.5rem;
            font-weight: 600;
        }
        
        .close-sidebar {
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            display: none;
        }
        
        .nav-menu {
            list-style: none;
        }
        
        .nav-item {
            margin-bottom: 5px;
        }
        
        .nav-link {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            transition: var(--transition);
            border-right: 3px solid transparent;
        }
        
        .nav-link:hover, .nav-link.active {
            background-color: rgba(255,255,255,0.1);
            color: white;
            border-right-color: var(--primary);
        }
        
        .nav-link i {
            margin-left: 10px;
            font-size: 1.2rem;
            width: 25px;
        }
        
        /* بەشی سەرەوە */
        .header {
            height: 70px;
            background-color: white;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
            display: flex;
            align-items: center;
            padding: 0 30px;
            position: fixed;
            top: 0;
            right: 0;
            left: 250px;
            z-index: 99;
            transition: var(--transition);
        }
        
        .header.collapsed {
            left: 0;
        }
        
        .header-left {
            display: flex;
            align-items: center;
        }
        
        .menu-toggle {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--dark);
            cursor: pointer;
            margin-left: 20px;
        }
        
        .logo {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--primary);
            text-shadow: 1px 1px 3px rgba(0,0,0,0.1);
        }
        
        .header-center {
            flex: 1;
            text-align: center;
        }
        
        .header-center h1 {
            font-size: 1.5rem;
            color: var(--dark);
        }
        
        .header-right {
            display: flex;
            align-items: center;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            background-color: var(--gray-light);
            padding: 8px 15px;
            border-radius: 30px;
            margin-left: 15px;
        }
        
        .user-info i {
            margin-left: 8px;
            color: var(--primary);
            font-size: 1.3rem;
        }
        
        .logout-btn {
            background-color: var(--danger);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
        }
        
        .logout-btn:hover {
            background-color: #e11575;
        }
        
        /* بەشی ناوەڕاست */
        .main-content {
            flex: 1;
            padding: 100px 30px 30px;
            margin-right: 250px;
            transition: var(--transition);
            background-color: #f5f7fa;
            min-height: 100vh;
            overflow-y: auto;
            height: calc(100vh - 70px);
            margin-top: 70px;
        }
        
        .main-content::-webkit-scrollbar {
            width: 8px;
        }
        
        .main-content::-webkit-scrollbar-track {
            background: var(--gray-light);
            border-radius: 10px;
        }
        
        .main-content::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 10px;
        }
        
        .main-content::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }
        
        .main-content.collapsed {
            margin-right: 0;
        }
        
        /* بەشەکانی ناوەڕاست */
        .content-section {
            display: none;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease, transform 0.5s ease;
        }
        
        .content-section.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }
        
        /* کارتەکانی داشبۆرد */
        .section-title {
            font-size: 1.8rem;
            margin-bottom: 25px;
            color: var(--dark);
            position: relative;
            padding-bottom: 10px;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: 0;
            width: 80px;
            height: 3px;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            border-radius: 3px;
        }
        
        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .card {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 25px;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.12);
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(to right, var(--primary), var(--secondary));
        }
        
        .card-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            margin-bottom: 20px;
            color: white;
        }
        
        .card-1 .card-icon { background-color: var(--primary); }
        .card-2 .card-icon { background-color: var(--success); }
        .card-3 .card-icon { background-color: var(--warning); }
        .card-4 .card-icon { background-color: var(--danger); }
        .card-5 .card-icon { background-color: var(--secondary); }
        .card-6 .card-icon { background-color: var(--info); }
        .card-7 .card-icon { background-color: #9d4edd; }
        
        .card h3 {
            font-size: 1.1rem;
            color: var(--gray);
            margin-bottom: 10px;
        }
        
        .card-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 15px;
        }
        
        .card-change {
            font-size: 0.9rem;
            display: flex;
            align-items: center;
        }
        
        .card-change.positive {
            color: #28a745;
        }
        
        .card-change.negative {
            color: var(--danger);
        }
        
        /* رەنگەکانی بڕی پارە بەپێی جۆری قەرز */
        .item-value.debt-positive {
            color: #f72585; /* سۆر - کاتێ کەس قەرزداری منە */
            font-weight: 600;
        }
        
        .item-value.debt-negative {
            color: #212529; /* رەش - کاتێ من قەرزداری شەریکم */
            font-weight: 600;
        }
        
        .item-value.debt-zero {
            color: #6c757d; /* خۆڵەمێشی - بێ قەرز */
            font-weight: 600;
        }
        
        .item-value.debt-payment {
            color: #28a745; /* سەوز - پارەواسڵکردن */
            font-weight: 600;
        }
        
        .item-value.debt-expense {
            color: #f8961e; /* پرتەقاڵی - سەرفکردن */
            font-weight: 600;
        }
        
        /* لیستەکان */
        .lists-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .list-box {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 25px;
        }
        
        .list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--gray-light);
        }
        
        .list-header h3 {
            font-size: 1.3rem;
            color: var(--dark);
        }
        
        .list-actions button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            margin-left: 10px;
        }
        
        .list-actions button:hover {
            background-color: var(--primary-dark);
        }
        
        .list-items {
            list-style: none;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .list-item {
            padding: 15px;
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: var(--transition);
        }
        
        .list-item:hover {
            background-color: var(--gray-light);
        }
        
        .item-name {
            font-weight: 500;
            color: var(--dark);
        }
        
        .item-value {
            font-weight: 600;
            color: var(--primary);
        }
        
        /* بەشی فرۆشتن و کڕین */
        .sale-purchase-container {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 30px;
            margin-bottom: 40px;
        }
        
        .tab-buttons {
            display: flex;
            margin-bottom: 30px;
            border-bottom: 1px solid var(--gray-light);
        }
        
        .tab-btn {
            background: none;
            border: none;
            padding: 15px 25px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: var(--transition);
            color: var(--gray);
            font-weight: 500;
            position: relative;
        }
        
        .tab-btn.active {
            color: var(--primary);
        }
        
        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            right: 0;
            width: 100%;
            height: 3px;
            background-color: var(--primary);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .search-container {
            margin-bottom: 25px;
        }
        
        .search-box {
            position: relative;
            max-width: 500px;
        }
        
        .search-box input {
            width: 100%;
            padding: 15px 50px 15px 15px;
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
        }
        
        .search-box input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }
        
        .search-box i {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }
        
        .suggestions {
            position: absolute;
            top: 100%;
            right: 0;
            left: 0;
            background-color: white;
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            z-index: 10;
            max-height: 300px;
            overflow-y: auto;
            display: none;
        }
        
        .suggestion-item {
            padding: 12px 15px;
            cursor: pointer;
            transition: var(--transition);
            border-bottom: 1px solid var(--gray-light);
        }
        
        .suggestion-item:hover {
            background-color: var(--gray-light);
        }
        
        .suggestion-item:last-child {
            border-bottom: none;
        }
        
        .cart-container {
            background-color: var(--gray-light);
            border-radius: var(--border-radius);
            padding: 25px;
            margin-top: 30px;
        }
        
        .cart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .cart-items {
            list-style: none;
            max-height: 250px;
            overflow-y: auto;
            margin-bottom: 20px;
        }
        
        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background-color: white;
            border-radius: var(--border-radius);
            margin-bottom: 15px;
        }
        
        .cart-item-info {
            display: flex;
            align-items: center;
        }
        
        .cart-item-image {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            background-color: var(--primary);
            margin-left: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
        }
        
        .payment-options {
            display: flex;
            margin-top: 20px;
            gap: 15px;
        }
        
        .payment-option {
            flex: 1;
            padding: 15px;
            border: 2px solid var(--gray-light);
            border-radius: var(--border-radius);
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .payment-option.selected {
            border-color: var(--primary);
            background-color: rgba(67, 97, 238, 0.05);
        }
        
        .action-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 30px;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn i {
            margin-left: 8px;
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--primary-dark);
        }
        
        .btn-success {
            background-color: var(--success);
            color: white;
        }
        
        .btn-success:hover {
            background-color: #3ab8e0;
        }
        
        .btn-danger {
            background-color: var(--danger);
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #e11575;
        }
        
        .btn-warning {
            background-color: var(--warning);
            color: white;
        }
        
        .btn-warning:hover {
            background-color: #e68905;
        }
        
        /* بەشی مخزن */
        .inventory-tabs {
            display: flex;
            margin-bottom: 30px;
        }
        
        .inventory-tab {
            background: none;
            border: none;
            padding: 15px 25px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: var(--transition);
            color: var(--gray);
            font-weight: 500;
            position: relative;
        }
        
        .inventory-tab.active {
            color: var(--primary);
        }
        
        .inventory-tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            right: 0;
            width: 100%;
            height: 3px;
            background-color: var(--primary);
        }
        
        .inventory-content {
            display: none;
        }
        
        .inventory-content.active {
            display: block;
        }
        
        .item-form {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 30px;
            margin-bottom: 40px;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--dark);
            font-weight: 500;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
        }
        
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }
        
        /* بەشی پارەواسڵکردن */
        .payment-container {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 30px;
            margin-bottom: 40px;
        }
        
        /* مۆدالی پرێنت */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            background-color: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background-color: white;
            border-radius: var(--border-radius);
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            animation: modalFadeIn 0.3s ease;
        }
        
        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(-30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 30px;
            border-bottom: 1px solid var(--gray-light);
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
        }
        
        .modal-body {
            padding: 30px;
        }
        
        .invoice {
            font-family: Arial, sans-serif;
            line-height: 1.6;
        }
        
        .invoice-header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--primary);
            padding-bottom: 20px;
        }
        
        .invoice-logo {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .invoice-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .invoice-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
        }
        
        .invoice-table th, .invoice-table td {
            padding: 12px 15px;
            text-align: right;
            border-bottom: 1px solid var(--gray-light);
        }
        
        .invoice-table th {
            background-color: var(--gray-light);
            font-weight: 600;
        }
        
        .invoice-total {
            text-align: left;
            margin-top: 30px;
            font-size: 1.2rem;
        }
        
        .print-options {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 40px;
        }
        
        /* وەڵامی مۆبایل */
        @media (max-width: 992px) {
            .sidebar {
                transform: translateX(-250px);
                box-shadow: none;
            }
            
            .sidebar.active {
                transform: translateX(0);
                box-shadow: 3px 0 15px rgba(0,0,0,0.1);
            }
            
            .header {
                left: 0;
            }
            
            .main-content {
                margin-right: 0;
            }
            
            .close-sidebar {
                display: block;
            }
        }
        
        @media (max-width: 768px) {
            .dashboard-cards {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }
            
            .lists-container {
                grid-template-columns: 1fr;
            }
            
            .payment-options {
                flex-direction: column;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }
        
        /* بۆستەی بچووک بۆ بەکارهێنان لە لیستەکان */
        .btn-sm {
            padding: 5px 10px;
            font-size: 0.8rem;
        }
    </style>
</head>
<body>
    <!-- پەڕەی چوونەژوورەوە -->
    <div id="loginPage" class="login-container">
        <div class="login-box">
            <div class="login-header">
                <div class="logo">الکترۆنیات</div>
                <h2>سیستەمی فرۆشتی ئەلکترۆنیات</h2>
                <p>تکایە ناوی بەکارهێنەر و وشەی نهێنی داخڵ بکە</p>
            </div>
            
            <form id="loginForm" class="login-form">
                <div class="input-group">
                    <label for="username"><i class="fas fa-user"></i> ناوی بەکارهێنەر</label>
                    <input type="text" id="username" placeholder="ناوی بەکارهێنەر" value="farzad">
                </div>
                
                <div class="input-group">
                    <label for="password"><i class="fas fa-lock"></i> وشەی نهێنی</label>
                    <input type="password" id="password" placeholder="وشەی نهێنی" value="farzad1234">
                </div>
                
                <div class="input-group remember">
                    <input type="checkbox" id="remember" checked>
                    <label for="remember">لەبیرم مەکە</label>
                </div>
                
                <button type="submit" class="login-btn">
                    <i class="fas fa-sign-in-alt"></i> چوونەژوورەوە
                </button>
                
                <div class="login-footer">
                    <p>وشەی نهێنیت لەبیرچووە؟ <a href="#">کلیک لێرە بکە</a></p>
                </div>
            </form>
            
            <div class="login-animation">
                <div class="circle"></div>
                <div class="circle"></div>
                <div class="circle"></div>
            </div>
        </div>
    </div>

    <!-- پەڕەی سەرەکی سیستم -->
    <div id="mainPage" class="container">
        <!-- بارەگەی لای چەپ -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h3>مێنیو</h3>
                <button class="close-sidebar" id="closeSidebar">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="#" class="nav-link active" data-section="dashboard">
                        <i class="fas fa-tachometer-alt"></i>
                        داشبۆرد
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="sales">
                        <i class="fas fa-shopping-cart"></i>
                        فرۆشتن
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="purchase">
                        <i class="fas fa-shopping-bag"></i>
                        کڕین
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="inventory">
                        <i class="fas fa-warehouse"></i>
                        مخزن
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="payment">
                        <i class="fas fa-money-bill-wave"></i>
                        پارەواسڵکردن
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="partnerExpense">
                        <i class="fas fa-hand-holding-usd"></i>
                        سەرف و حیسابی شەریکەکان
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="history">
                        <i class="fas fa-history"></i>
                        مێژوو
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="customers">
                        <i class="fas fa-users"></i>
                        کەسەکان
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="partners">
                        <i class="fas fa-handshake"></i>
                        شەریکەکان
                    </a>
                </li>
            </ul>
        </aside>

        <!-- بەشی سەرەوە -->
        <header class="header" id="header">
            <div class="header-left">
                <button class="menu-toggle" id="menuToggle">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="logo">الکترۆنیات</div>
            </div>
            
            <div class="header-center">
                <h1>سیستەمی فرۆشتی ئەلکترۆنیات</h1>
            </div>
            
            <div class="header-right">
                <div class="user-info">
                    <i class="fas fa-user-circle"></i>
                    <span id="currentUser">فەرزاد</span>
                </div>
                <button class="logout-btn" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i> چوونەدەرەوە
                </button>
            </div>
        </header>

        <!-- بەشی ناوەڕاست -->
        <main class="main-content" id="mainContent">
            <!-- داشبۆرد -->
            <section id="dashboardSection" class="content-section active">
                <h2 class="section-title">داشبۆرد</h2>
                
                <div class="dashboard-cards">
                    <div class="card card-1">
                        <div class="card-icon">
                            <i class="fas fa-wallet"></i>
                        </div>
                        <h3>کۆی پارەی واسڵ کراو</h3>
                        <div class="card-value" id="cashBalanceDisplay">٣٬٥٤٠٫٠٠٠ <span>دینار</span></div>
                        <div class="card-change positive">
                            <i class="fas fa-arrow-up"></i> ١٢٪ زیاتر لە هەفتەی ڕابردوو
                        </div>
                    </div>
                    
                    <div class="card card-2">
                        <div class="card-icon">
                            <i class="fas fa-shopping-cart"></i>
                        </div>
                        <h3>کۆی کڕین</h3>
                        <div class="card-value">١٬٢٣٠٫٠٠٠ <span>دینار</span></div>
                        <div class="card-change negative">
                            <i class="fas fa-arrow-down"></i> ٥٪ کەمتر لە هەفتەی ڕابردوو
                        </div>
                    </div>
                    
                    <div class="card card-3">
                        <div class="card-icon">
                            <i class="fas fa-exchange-alt"></i>
                        </div>
                        <h3>جیاوازی کڕین و واسڵ کراو</h3>
                        <div class="card-value">٢٬٣١٠٫٠٠٠ <span>دینار</span></div>
                        <div class="card-change positive">
                            <i class="fas fa-arrow-up"></i> ٨٪ زیاتر لە هەفتەی ڕابردوو
                        </div>
                    </div>
                    
                    <div class="card card-4">
                        <div class="card-icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <h3>کۆی کاڵای کەم بوو</h3>
                        <div class="card-value">٢٤ <span>جۆر</span></div>
                        <div class="card-change positive">
                            <i class="fas fa-arrow-down"></i> ٣ جۆر کەمتر لە هەفتەی ڕابردوو
                        </div>
                    </div>
                    
                    <div class="card card-5">
                        <div class="card-icon">
                            <i class="fas fa-user-ow"></i>
                        </div>
                        <h3>کۆی پارەی قەرزداران</h3>
                        <div class="card-value">٤٥٠٫٠٠٠ <span>دینار</span></div>
                        <div class="card-change negative">
                            <i class="fas fa-arrow-up"></i> ١٥٪ زیاتر لە هەفتەی ڕابردوو
                        </div>
                    </div>
                    
                    <div class="card card-6">
                        <div class="card-icon">
                            <i class="fas fa-handshake"></i>
                        </div>
                        <h3>قەرزدارم بە شەریکەکان</h3>
                        <div class="card-value">٧٨٠٫٠٠٠ <span>دینار</span></div>
                        <div class="card-change positive">
                            <i class="fas fa-arrow-down"></i> ١٠٪ کەمتر لە هەفتەی ڕابردوو
                        </div>
                    </div>
                    
                    <div class="card card-7">
                        <div class="card-icon">
                            <i class="fas fa-file-invoice-dollar"></i>
                        </div>
                        <h3>کۆی سەرفکردن (ئەم مانگە)</h3>
                        <div class="card-value" id="monthlyExpenseTotal">٠ <span>دینار</span></div>
                        <div class="card-change" id="expenseChange">
                            <i class="fas fa-minus"></i> ٠٪ جیاوازی لە مانگی ڕابردوو
                        </div>
                    </div>
                </div>
                
                <div class="lists-container">
                    <div class="list-box">
                        <div class="list-header">
                            <h3>کاڵای کەم بووەکان</h3>
                            <div class="list-actions">
                                <button id="refreshLowStock">نوێکردنەوە</button>
                            </div>
                        </div>
                        <ul class="list-items" id="lowStockList">
                            <!-- داتاکان لە JavaScript دا زیاد دەکرێن -->
                        </ul>
                    </div>
                    
                    <div class="list-box">
                        <div class="list-header">
                            <h3>قەرزدارانی ئەم هەفتەیە</h3>
                            <div class="list-actions">
                                <button id="refreshDebtors">نوێکردنەوە</button>
                            </div>
                        </div>
                        <ul class="list-items" id="debtorsList">
                            <!-- داتاکان لە JavaScript دا زیاد دەکرێن -->
                        </ul>
                    </div>
                </div>
            </section>

            <!-- بەشی فرۆشتن -->
            <section id="salesSection" class="content-section">
                <h2 class="section-title">فرۆشتن</h2>
                
                <div class="sale-purchase-container">
                    <div class="tab-buttons">
                        <button class="tab-btn active" data-tab="newSale">فرۆشتی نوێ</button>
                        <button class="tab-btn" data-tab="saleHistory">مێژووی فرۆشتن</button>
                    </div>
                    
                    <div class="tab-content active" id="newSale">
                        <div class="search-container">
                            <div class="search-box">
                                <input type="text" id="productSearch" placeholder="گەڕان بەدوای ناوی کاڵا...">
                                <i class="fas fa-search"></i>
                                <div class="suggestions" id="productSuggestions"></div>
                            </div>
                        </div>
                        
                        <div class="cart-container">
                            <div class="cart-header">
                                <h3>سەبەتە</h3>
                                <button class="btn btn-danger" id="clearCart">
                                    <i class="fas fa-trash"></i> سڕینەوەی سەبەتە
                                </button>
                            </div>
                            
                            <ul class="cart-items" id="cartItems">
                                <!-- کاڵاکانی سەبەتە لێرە زیاد دەکرێن -->
                                <li class="empty-cart">هیچ کاڵایەک لە سەبەتەدا نییە</li>
                            </ul>
                            
                            <div class="payment-options">
                                <div class="payment-option" data-payment="cash">
                                    <i class="fas fa-money-bill-wave fa-2x"></i>
                                    <h4>نەقدی</h4>
                                    <p>پارەی رەت</p>
                                </div>
                                <div class="payment-option" data-payment="credit">
                                    <i class="fas fa-credit-card fa-2x"></i>
                                    <h4>قەرز</h4>
                                    <p>فرۆشتن بە قەرز</p>
                                </div>
                            </div>
                            
                            <div id="customerSelection" style="display: none; margin-top: 20px;">
                                <div class="search-box">
                                    <input type="text" id="customerSearch" placeholder="گەڕان بەدوای ناوی کەس...">
                                    <i class="fas fa-search"></i>
                                    <div class="suggestions" id="customerSuggestions"></div>
                                </div>
                            </div>
                            
                            <div class="action-buttons">
                                <button class="btn btn-warning" id="printInvoice">
                                    <i class="fas fa-print"></i> پرێنت کردن
                                </button>
                                <button class="btn btn-success" id="completeSale">
                                    <i class="fas fa-check-circle"></i> تەواوکردنی فرۆشتن
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="saleHistory">
                        <div class="search-container">
                            <div class="search-box">
                                <input type="text" id="saleHistorySearch" placeholder="گەڕان بە کۆدی فاکتوورە یان ناوی کەس...">
                                <i class="fas fa-search"></i>
                            </div>
                        </div>
                        
                        <div class="list-box" style="margin-top: 20px;">
                            <div class="list-header">
                                <h3>مێژووی فرۆشتن</h3>
                                <div class="list-actions">
                                    <button id="refreshSaleHistory">نوێکردنەوە</button>
                                </div>
                            </div>
                            <ul class="list-items" id="saleHistoryList">
                                <!-- مێژووی فرۆشتن لێرە زیاد دەکرێن -->
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- بەشی کڕین -->
            <section id="purchaseSection" class="content-section">
                <h2 class="section-title">کڕین</h2>
                
                <div class="sale-purchase-container">
                    <div class="tab-buttons">
                        <button class="tab-btn active" data-tab="newPurchase">کڕینی نوێ</button>
                        <button class="tab-btn" data-tab="purchaseHistory">مێژووی کڕین</button>
                    </div>
                    
                    <div class="tab-content active" id="newPurchase">
                        <div class="search-container">
                            <div class="search-box">
                                <input type="text" id="purchaseProductSearch" placeholder="گەڕان بەدوای ناوی کاڵا یان بارکۆد...">
                                <i class="fas fa-search"></i>
                                <div class="suggestions" id="purchaseProductSuggestions"></div>
                            </div>
                        </div>
                        
                        <div class="cart-container">
                            <div class="cart-header">
                                <h3>سەبەتەی کڕین</h3>
                                <button class="btn btn-danger" id="clearPurchaseCart">
                                    <i class="fas fa-trash"></i> سڕینەوەی سەبەتە
                                </button>
                            </div>
                            
                            <ul class="cart-items" id="purchaseCartItems">
                                <li class="empty-cart">هیچ کاڵایەک لە سەبەتەدا نییە</li>
                            </ul>
                            
                            <div class="payment-options">
                                <div class="payment-option" data-payment="cash">
                                    <i class="fas fa-money-bill-wave fa-2x"></i>
                                    <h4>نەقدی</h4>
                                    <p>پارەی رەت</p>
                                </div>
                                <div class="payment-option" data-payment="credit">
                                    <i class="fas fa-credit-card fa-2x"></i>
                                    <h4>قەرز</h4>
                                    <p>کڕین بە قەرز</p>
                                </div>
                            </div>
                            
                            <div id="partnerSelection" style="display: none; margin-top: 20px;">
                                <div class="search-box">
                                    <input type="text" id="partnerSearchPurchase" placeholder="گەڕان بەدوای ناوی شەریک...">
                                    <i class="fas fa-search"></i>
                                    <div class="suggestions" id="partnerSuggestionsPurchase"></div>
                                </div>
                            </div>
                            
                            <div class="action-buttons">
                                <button class="btn btn-warning" id="printPurchaseInvoice">
                                    <i class="fas fa-print"></i> پرێنت کردن
                                </button>
                                <button class="btn btn-success" id="completePurchase">
                                    <i class="fas fa-check-circle"></i> تەواوکردنی کڕین
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="purchaseHistory">
                        <div class="search-container">
                            <div class="search-box">
                                <input type="text" id="purchaseHistorySearch" placeholder="گەڕان بە کۆدی فاکتوورە یان ناوی شەریک...">
                                <i class="fas fa-search"></i>
                            </div>
                        </div>
                        
                        <div class="list-box" style="margin-top: 20px;">
                            <div class="list-header">
                                <h3>مێژووی کڕین</h3>
                                <div class="list-actions">
                                    <button id="refreshPurchaseHistory">نوێکردنەوە</button>
                                </div>
                            </div>
                            <ul class="list-items" id="purchaseHistoryList">
                                <!-- مێژووی کڕین لێرە زیاد دەکرێن -->
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- بەشی مخزن -->
            <section id="inventorySection" class="content-section">
                <h2 class="section-title">مخزن</h2>
                
                <div class="inventory-tabs">
                    <button class="inventory-tab active" data-inventory-tab="products">کاڵاکان</button>
                </div>
                
                <div class="inventory-content active" id="productsTab">
                    <div class="search-container">
                        <div class="search-box">
                            <input type="text" id="inventorySearch" placeholder="گەڕان بەدوای ناوی کاڵا...">
                            <i class="fas fa-search"></i>
                        </div>
                    </div>
                    
                    <div class="list-box" style="margin-bottom: 30px;">
                        <div class="list-header">
                            <h3>لیستی کاڵاکان</h3>
                            <div class="list-actions">
                                <button id="addProductBtn">زیادکردنی کاڵا</button>
                            </div>
                        </div>
                        <ul class="list-items" id="productList">
                            <!-- لیستی کاڵاکان لێرە زیاد دەکرێن -->
                        </ul>
                    </div>
                    
                    <div class="item-form" id="productForm" style="display: none;">
                        <h3 style="margin-bottom: 20px;">زیادکردن/گۆڕانکاری کاڵا</h3>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="productName">ناوی کاڵا</label>
                                <input type="text" id="productName" placeholder="ناوی کاڵا">
                            </div>
                            
                            <div class="form-group">
                                <label for="productBarcode">بارکۆد (ئارەزوومەندانە)</label>
                                <input type="text" id="productBarcode" placeholder="بارکۆد">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="purchasePrice">نرخی کڕین</label>
                                <input type="number" id="purchasePrice" placeholder="نرخی کڕین">
                            </div>
                            
                            <div class="form-group">
                                <label for="salePrice">نرخی فرۆشتن</label>
                                <input type="number" id="salePrice" placeholder="نرخی فرۆشتن">
                            </div>
                            
                            <div class="form-group">
                                <label for="stockQuantity">بڕی کاڵا</label>
                                <input type="number" id="stockQuantity" placeholder="بڕی کاڵا">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="primaryUnit">یەکەی سەرەکی</label>
                                <select id="primaryUnit">
                                    <option value="piece">پارچە</option>
                                    <option value="carton">کارتۆن</option>
                                    <option value="unit">دانە</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="secondaryUnit">یەکەی دووەم (ئارەزوومەندانە)</label>
                                <select id="secondaryUnit">
                                    <option value="">هیچ</option>
                                    <option value="piece">پارچە</option>
                                    <option value="carton">کارتۆن</option>
                                    <option value="unit">دانە</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="secondaryUnitQuantity">بڕ لە یەکەی دووەم (ئەگەر هەیە)</label>
                                <input type="number" id="secondaryUnitQuantity" placeholder="بڕ لە یەکەی دووەم">
                            </div>
                        </div>
                        
                        <div class="action-buttons">
                            <button class="btn btn-danger" id="cancelProductBtn">پاشگەزبوونەوە</button>
                            <button class="btn btn-success" id="saveProductBtn">هەڵگرتن</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- بەشی پارەواسڵکردن -->
            <section id="paymentSection" class="content-section">
                <h2 class="section-title">پارەواسڵکردن و سەرفکردن</h2>
                
                <div class="payment-container">
                    <div class="tab-buttons">
                        <button class="tab-btn active" data-tab="debtPayment">پارەواسڵکردن</button>
                        <button class="tab-btn" data-tab="expense">سەرفکردن</button>
                        <button class="tab-btn" data-tab="paymentHistory">مێژووی پارەواسڵکردن</button>
                    </div>
                    
                    <div class="tab-content active" id="debtPayment">
                        <div class="search-container">
                            <div class="search-box">
                                <input type="text" id="debtorSearch" placeholder="گەڕان بەدوای ناوی کەس...">
                                <i class="fas fa-search"></i>
                                <div class="suggestions" id="debtorSuggestions"></div>
                            </div>
                        </div>
                        
                        <div id="debtorInfo" style="display: none; margin-top: 20px;">
                            <div class="list-box">
                                <div class="list-header">
                                    <h3>زانیاری قەرزدار</h3>
                                </div>
                                <div style="padding: 20px;">
                                    <p><strong>ناوی کەس:</strong> <span id="debtorName"></span></p>
                                    <p><strong>کۆی قەرز:</strong> <span id="totalDebtAmount"></span> دینار</p>
                                    <p><strong>کۆی پارەی واسڵ کراو:</strong> <span id="totalPaidAmount"></span> دینار</p>
                                </div>
                            </div>
                            
                            <div class="item-form" style="margin-top: 20px;">
                                <h4>تۆمارکردنی پارەواسڵکردن</h4>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="paymentAmountInput">بڕی پارە</label>
                                        <input type="number" id="paymentAmountInput" placeholder="بڕی پارە بە دینار" min="1">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="paymentDateInput">بەروار</label>
                                        <input type="date" id="paymentDateInput" value="${new Date().toISOString().split('T')[0]}">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="paymentMethodSelect">شێوازی پارەدان</label>
                                        <select id="paymentMethodSelect">
                                            <option value="cash">نەقدی</option>
                                            <option value="transfer">گوازینەوە</option>
                                            <option value="check">چەک</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="paymentNotesInput">تێبینی (ئارەزوومەندانە)</label>
                                    <input type="text" id="paymentNotesInput" placeholder="تێبینی">
                                </div>
                                
                                <div class="action-buttons">
                                    <button class="btn btn-success" id="submitPaymentBtn">
                                        <i class="fas fa-check-circle"></i> تۆمارکردنی پارەواسڵکردن
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="expense">
                        <div class="item-form">
                            <h4>تۆمارکردنی سەرفکردن</h4>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="expenseType">جۆری سەرفکردن</label>
                                    <select id="expenseType">
                                        <option value="partner">شەریکەکان</option>
                                        <option value="customer">کەسەکان</option>
                                        <option value="other">هۆکاری تر</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label for="expenseAmount">بڕی سەرفکردن</label>
                                    <input type="number" id="expenseAmount" placeholder="بڕی سەرفکردن بە دینار" min="1">
                                </div>
                                
                                <div class="form-group">
                                    <label for="expenseDate">بەروار</label>
                                    <input type="date" id="expenseDate" value="${new Date().toISOString().split('T')[0]}">
                                </div>
                            </div>
                            
                            <!-- بەشەکەی شەریکەکان -->
                            <div id="expensePartnerSection" style="display: none;">
                                <div class="search-container">
                                    <div class="search-box">
                                        <input type="text" id="expensePartnerSearch" placeholder="گەڕان بەدوای ناوی شەریک...">
                                        <i class="fas fa-search"></i>
                                        <div class="suggestions" id="expensePartnerSuggestions"></div>
                                    </div>
                                </div>
                                
                                <div class="form-group" id="selectedPartnerInfo" style="display: none; margin-top: 15px; padding: 15px; background-color: var(--gray-light); border-radius: var(--border-radius);">
                                    <p><strong>شەریکی هەڵبژێردراو:</strong> <span id="selectedPartnerName"></span></p>
                                    <p><strong>قەرزی ئێستا:</strong> <span id="selectedPartnerDebt"></span> دینار</p>
                                </div>
                            </div>
                            
                            <!-- بەشەکەی کەسەکان -->
                            <div id="expenseCustomerSection" style="display: none;">
                                <div class="search-container">
                                    <div class="search-box">
                                        <input type="text" id="expenseCustomerSearch" placeholder="گەڕان بەدوای ناوی کەس...">
                                        <i class="fas fa-search"></i>
                                        <div class="suggestions" id="expenseCustomerSuggestions"></div>
                                    </div>
                                </div>
                                
                                <div class="form-group" id="selectedCustomerInfo" style="display: none; margin-top: 15px; padding: 15px; background-color: var(--gray-light); border-radius: var(--border-radius);">
                                    <p><strong>کەسی هەڵبژێردراو:</strong> <span id="selectedCustomerName"></span></p>
                                    <p><strong>قەرزی ئێستا:</strong> <span id="selectedCustomerDebt"></span> دینار</p>
                                </div>
                            </div>
                            
                            <!-- بەشەکەی هۆکاری تر -->
                            <div id="expenseOtherSection" style="display: block;">
                                <div class="form-group">
                                    <label for="expenseCategory">پۆلی سەرفکردن</label>
                                    <select id="expenseCategory">
                                        <option value="rent">کرێ</option>
                                        <option value="salary">مووچە</option>
                                        <option value="utility">کەرەستە</option>
                                        <option value="transport">گواستنەوە</option>
                                        <option value="maintenance">چاکسازی</option>
                                        <option value="marketing">بازرگانی</option>
                                        <option value="office">ئۆفیس</option>
                                        <option value="other">هی تر</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label for="expenseDescription">پێناسە (هۆکاری سەرفکردن)</label>
                                    <input type="text" id="expenseDescription" placeholder="پێناسەی سەرفکردن">
                                </div>
                            </div>
                            
                            <div class="action-buttons">
                                <button class="btn btn-success" id="submitExpenseBtn">
                                    <i class="fas fa-check-circle"></i> تۆمارکردنی سەرفکردن
                                </button>
                            </div>
                        </div>
                        
                        <!-- مێژووی سەرفکردن -->
                        <div class="list-box" style="margin-top: 40px;">
                            <div class="list-header">
                                <h3>مێژووی سەرفکردن</h3>
                                <div class="list-actions">
                                    <button id="refreshExpenseHistory">نوێکردنەوە</button>
                                </div>
                            </div>
                            <ul class="list-items" id="expenseHistoryList">
                                <!-- مێژووی سەرفکردن لێرە زیاد دەکرێن -->
                            </ul>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="paymentHistory">
                        <div class="search-container">
                            <div class="search-box">
                                <input type="text" id="paymentHistorySearch" placeholder="گەڕان بە ناوی کەس یان کۆدی فاکتوورە...">
                                <i class="fas fa-search"></i>
                            </div>
                        </div>
                        
                        <div class="list-box" style="margin-top: 20px;">
                            <div class="list-header">
                                <h3>مێژووی پارەواسڵکردن</h3>
                                <div class="list-actions">
                                    <button id="refreshPaymentHistory">نوێکردنەوە</button>
                                </div>
                            </div>
                            <ul class="list-items" id="paymentHistoryList">
                                <!-- مێژووی پارەواسڵکردن لێرە زیاد دەکرێن -->
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- بەشی سەرف و حیسابی شەریکەکان -->
            <section id="partnerExpenseSection" class="content-section">
                <h2 class="section-title">سەرف و حیسابی شەریکەکان</h2>
                
                <div class="sale-purchase-container">
                    <div class="tab-buttons">
                        <button class="tab-btn active" data-tab="expenseToPartner">سەرف بۆ شەریک</button>
                        <button class="tab-btn" data-tab="expenseToCustomer">سەرف بۆ کەس</button>
                        <button class="tab-btn" data-tab="expenseOther">سەرف بۆ هۆکی تر</button>
                    </div>
                    
                    <!-- بەشی ١: سەرف بۆ شەریک -->
                    <div class="tab-content active" id="expenseToPartner">
                        <div class="item-form">
                            <h3 style="margin-bottom: 20px;">سەرفکردنی پارە بۆ شەریک</h3>
                            
                            <div class="search-container">
                                <div class="search-box">
                                    <input type="text" id="expensePartnerSearchMain" placeholder="گەڕان بەدوای ناوی شەریک...">
                                    <i class="fas fa-search"></i>
                                    <div class="suggestions" id="expensePartnerSuggestionsMain"></div>
                                </div>
                            </div>
                            
                            <div id="selectedPartnerInfoMain" style="display: none; margin-top: 20px;">
                                <div class="list-box">
                                    <div class="list-header">
                                        <h3>زانیاری شەریک</h3>
                                    </div>
                                    <div style="padding: 20px;">
                                        <p><strong>ناوی شەریک:</strong> <span id="selectedPartnerNameMain"></span></p>
                                        <p><strong>ژمارەی موبایل:</strong> <span id="selectedPartnerPhoneMain"></span></p>
                                        <p><strong>کۆی قەرزی ئێستا:</strong> <span id="selectedPartnerDebtMain"></span> دینار</p>
                                        <p><strong>کۆی پارەی واسڵکراو:</strong> <span id="selectedPartnerPaidMain"></span> دینار</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-row" style="margin-top: 30px;">
                                <div class="form-group">
                                    <label for="expenseToPartnerAmount">بڕی پارەی سەرفکردن</label>
                                    <input type="number" id="expenseToPartnerAmount" placeholder="بڕی پارە بە دینار" min="1">
                                </div>
                                
                                <div class="form-group">
                                    <label for="expenseToPartnerDate">بەرواری سەرفکردن</label>
                                    <input type="date" id="expenseToPartnerDate" value="${new Date().toISOString().split('T')[0]}">
                                </div>
                                
                                <div class="form-group">
                                    <label for="expenseToPartnerReason">هۆکاری سەرفکردن (ئارەزوومەندانە)</label>
                                    <input type="text" id="expenseToPartnerReason" placeholder="هۆکی سەرفکردن">
                                </div>
                            </div>
                            
                            <div class="action-buttons" style="margin-top: 30px;">
                                <button class="btn btn-success" id="submitExpenseToPartnerBtn">
                                    <i class="fas fa-check-circle"></i> تۆمارکردنی سەرفکردن بۆ شەریک
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- بەشی ٢: سەرف بۆ کەس -->
                    <div class="tab-content" id="expenseToCustomer">
                        <div class="item-form">
                            <h3 style="margin-bottom: 20px;">سەرفکردنی پارە بۆ کەس</h3>
                            
                            <div class="search-container">
                                <div class="search-box">
                                    <input type="text" id="expenseCustomerSearchMain" placeholder="گەڕان بەدوای ناوی کەس...">
                                    <i class="fas fa-search"></i>
                                    <div class="suggestions" id="expenseCustomerSuggestionsMain"></div>
                                </div>
                            </div>
                            
                            <div id="selectedCustomerInfoMain" style="display: none; margin-top: 20px;">
                                <div class="list-box">
                                    <div class="list-header">
                                        <h3>زانیاری کەس</h3>
                                    </div>
                                    <div style="padding: 20px;">
                                        <p><strong>ناوی کەس:</strong> <span id="selectedCustomerNameMain"></span></p>
                                        <p><strong>ژمارەی موبایل:</strong> <span id="selectedCustomerPhoneMain"></span></p>
                                        <p><strong>کۆی قەرزی ئێستا:</strong> <span id="selectedCustomerDebtMain"></span> دینار</p>
                                        <p><strong>کۆی پارەی واسڵکراو:</strong> <span id="selectedCustomerPaidMain"></span> دینار</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-row" style="margin-top: 30px;">
                                <div class="form-group">
                                    <label for="expenseToCustomerAmount">بڕی پارەی سەرفکردن</label>
                                    <input type="number" id="expenseToCustomerAmount" placeholder="بڕی پارە بە دینار" min="1">
                                </div>
                                
                                <div class="form-group">
                                    <label for="expenseToCustomerDate">بەرواری سەرفکردن</label>
                                    <input type="date" id="expenseToCustomerDate" value="${new Date().toISOString().split('T')[0]}">
                                </div>
                                
                                <div class="form-group">
                                    <label for="expenseToCustomerReason">هۆکاری سەرفکردن (ئارەزوومەندانە)</label>
                                    <input type="text" id="expenseToCustomerReason" placeholder="هۆکی سەرفکردن">
                                </div>
                            </div>
                            
                            <div class="action-buttons" style="margin-top: 30px;">
                                <button class="btn btn-success" id="submitExpenseToCustomerBtn">
                                    <i class="fas fa-check-circle"></i> تۆمارکردنی سەرفکردن بۆ کەس
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- بەشی ٣: سەرف بۆ هۆکی تر -->
                    <div class="tab-content" id="expenseOther">
                        <div class="item-form">
                            <h3 style="margin-bottom: 20px;">سەرفکردنی پارە بۆ هۆکی تر</h3>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="otherExpenseAmount">بڕی پارەی سەرفکردن</label>
                                    <input type="number" id="otherExpenseAmount" placeholder="بڕی پارە بە دینار" min="1">
                                </div>
                                
                                <div class="form-group">
                                    <label for="otherExpenseDate">بەرواری سەرفکردن</label>
                                    <input type="date" id="otherExpenseDate" value="${new Date().toISOString().split('T')[0]}">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="otherExpenseCategory">پۆلی سەرفکردن</label>
                                    <select id="otherExpenseCategory">
                                        <option value="rent">کرێ</option>
                                        <option value="salary">مووچە</option>
                                        <option value="utility">کەرەستە</option>
                                        <option value="transport">گواستنەوە</option>
                                        <option value="maintenance">چاکسازی</option>
                                        <option value="marketing">بازرگانی</option>
                                        <option value="office">ئۆفیس</option>
                                        <option value="other">هی تر</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label for="otherExpenseDescription">پێناسە (هۆکاری سەرفکردن)</label>
                                    <input type="text" id="otherExpenseDescription" placeholder="پێناسەی سەرفکردن">
                                </div>
                            </div>
                            
                            <div class="action-buttons" style="margin-top: 30px;">
                                <button class="btn btn-success" id="submitOtherExpenseBtn">
                                    <i class="fas fa-check-circle"></i> تۆمارکردنی سەرفکردن
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- لیستی مێژووی سەرفکردن -->
                <div class="list-box" style="margin-top: 40px;">
                    <div class="list-header">
                        <h3>مێژووی سەرفکردن</h3>
                        <div class="list-actions">
                            <button id="refreshExpenseHistoryMain">نوێکردنەوە</button>
                        </div>
                    </div>
                    <ul class="list-items" id="expenseHistoryMainList">
                        <!-- مێژووی سەرفکردن لێرە زیاد دەکرێن -->
                    </ul>
                </div>
            </section>

            <!-- بەشی مێژوو -->
            <section id="historySection" class="content-section">
                <h2 class="section-title">مێژوو</h2>
                <p style="text-align: center; padding: 40px; color: var(--gray);">
                    بەشی مێژوو لێرە دەبێت کە مێژووی هەموو فرۆشتن و کڕین و پارەواسڵکردنەکان تێدا بێت.
                </p>
            </section>
            
            <!-- بەشی کەسەکان -->
            <section id="customersSection" class="content-section">
                <h2 class="section-title">کەسەکان</h2>
                
                <div class="sale-purchase-container">
                    <div class="tab-buttons">
                        <button class="tab-btn active" data-tab="customersList">لیستی کەسەکان</button>
                        <button class="tab-btn" data-tab="addCustomer">زیادکردنی کەس</button>
                    </div>
                    
                    <div class="tab-content active" id="customersList">
                        <div class="search-container">
                            <div class="search-box">
                                <input type="text" id="customerSearchMain" placeholder="گەڕان بەدوای ناوی کەس...">
                                <i class="fas fa-search"></i>
                                <div class="suggestions" id="customerSearchSuggestions"></div>
                            </div>
                        </div>
                        
                        <div class="list-box" style="margin-top: 20px;">
                            <div class="list-header">
                                <h3>لیستی کەسەکان</h3>
                                <div class="list-actions">
                                    <button id="refreshCustomers">نوێکردنەوە</button>
                                    <button id="addCustomerBtn">زیادکردنی کەس</button>
                                </div>
                            </div>
                            <ul class="list-items" id="customersMainList">
                                <!-- لیستی کەسەکان لێرە زیاد دەکرێن -->
                            </ul>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="addCustomer">
                        <div class="item-form">
                            <h3 style="margin-bottom: 20px;">زیادکردنی کەسی نوێ</h3>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="newCustomerName">ناوی کەس</label>
                                    <input type="text" id="newCustomerName" placeholder="ناوی کەس">
                                </div>
                                
                                <div class="form-group">
                                    <label for="newCustomerPhone">ژمارەی موبایل</label>
                                    <input type="text" id="newCustomerPhone" placeholder="٠٧٧٠١٢٣٤٥٦٧">
                                </div>
                                
                                <div class="form-group">
                                    <label for="newCustomerAddress">ناونیشان (ئارەزوومەندانە)</label>
                                    <input type="text" id="newCustomerAddress" placeholder="ناونیشان">
                                </div>
                            </div>
                            
                            <div class="action-buttons">
                                <button class="btn btn-danger" id="cancelCustomerBtn">پاشگەزبوونەوە</button>
                                <button class="btn btn-success" id="saveCustomerBtn">هەڵگرتن</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- بەشی شەریکەکان -->
            <section id="partnersSection" class="content-section">
                <h2 class="section-title">شەریکەکان</h2>
                
                <div class="sale-purchase-container">
                    <div class="tab-buttons">
                        <button class="tab-btn active" data-tab="partnersList">لیستی شەریکەکان</button>
                        <button class="tab-btn" data-tab="addPartner">زیادکردنی شەریک</button>
                    </div>
                    
                    <div class="tab-content active" id="partnersList">
                        <div class="search-container">
                            <div class="search-box">
                                <input type="text" id="partnerSearch" placeholder="گەڕان بەدوای ناوی شەریک...">
                                <i class="fas fa-search"></i>
                            </div>
                        </div>
                        
                        <div class="list-box" style="margin-top: 20px;">
                            <div class="list-header">
                                <h3>لیستی شەریکەکان</h3>
                                <div class="list-actions">
                                    <button id="refreshPartners">نوێکردنەوە</button>
                                    <button id="addPartnerBtn">زیادکردنی شەریک</button>
                                </div>
                            </div>
                            <ul class="list-items" id="partnersListItems">
                                <!-- لیستی شەریکەکان لێرە زیاد دەکرێن -->
                            </ul>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="addPartner">
                        <div class="item-form">
                            <h3 style="margin-bottom: 20px;">زیادکردنی شەریکی نوێ</h3>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="newPartnerName">ناوی شەریک</label>
                                    <input type="text" id="newPartnerName" placeholder="ناوی شەریک">
                                </div>
                                
                                <div class="form-group">
                                    <label for="newPartnerPhone">ژمارەی موبایل</label>
                                    <input type="text" id="newPartnerPhone" placeholder="٠٧٧٠١٢٣٤٥٦٧">
                                </div>
                                
                                <div class="form-group">
                                    <label for="newPartnerAddress">ناونیشان (ئارەزوومەندانە)</label>
                                    <input type="text" id="newPartnerAddress" placeholder="ناونیشان">
                                </div>
                            </div>
                            
                            <div class="action-buttons">
                                <button class="btn btn-danger" id="cancelPartnerBtn">پاشگەزبوونەوە</button>
                                <button class="btn btn-success" id="savePartnerBtn">هەڵگرتن</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- مۆدالی پرێنت -->
    <div class="modal" id="printModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>پرێنتکردنی فاکتوور</h3>
                <button class="modal-close" id="closePrintModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="invoice">
                    <div class="invoice-header">
                        <div class="invoice-logo">الکترۆنیات</div>
                        <h2>فاکتووری فرۆشتن</h2>
                        <p>کۆدی فاکتوورە: <span id="invoiceCode">INV-2023-001</span></p>
                        <p>بەروار: <span id="invoiceDate">٢٠٢٣/١٢/١٥</span></p>
                    </div>
                    
                    <div class="invoice-details">
                        <div>
                            <h4>زانیاری فرۆشەر:</h4>
                            <p>ناوی سیستەم: الکترۆنیات</p>
                            <p>ژمارەی موبایل: ٠٧٧٠١٢٣٤٥٦٧</p>
                            <p>ناونیشان: هەولێر، کوردستان</p>
                        </div>
                        
                        <div>
                            <h4>زانیاری کڕیار:</h4>
                            <p id="customerName">ناوی کڕیار: عەلی محەممەد</p>
                            <p id="customerPhone">ژمارەی موبایل: ٠٧٧٠٧٦٥٤٣٢١</p>
                            <p id="customerAddress">ناونیشان: نەزانراو</p>
                        </div>
                    </div>
                    
                    <table class="invoice-table">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>ناوی کاڵا</th>
                                <th>یەکە</th>
                                <th>بڕ</th>
                                <th>نرخ</th>
                                <th>کۆی گشتی</th>
                            </tr>
                        </thead>
                        <tbody id="invoiceItems">
                            <!-- کاڵاکانی فاکتوور لێرە زیاد دەکرێن -->
                        </tbody>
                    </table>
                    
                    <div class="invoice-total">
                        <p><strong>کۆی گشتی:</strong> <span id="invoiceTotal">٠ دینار</span></p>
                        <p><strong>قەرزی پێشوو:</strong> <span id="previousDebt">٠ دینار</span></p>
                        <p><strong>قەرزی ئێستا:</strong> <span id="currentDebt">٠ دینار</span></p>
                        <p><strong>کۆی قەرزی دوای فرۆشتن:</strong> <span id="totalDebt">٠ دینار</span></p>
                    </div>
                    
                    <div class="print-options">
                        <button class="btn btn-warning" id="printSmall">
                            <i class="fas fa-print"></i> پرێنتی بچووک
                        </button>
                        <button class="btn btn-primary" id="printA4">
                            <i class="fas fa-print"></i> پرێنتی A4
                        </button>
                        <button class="btn btn-danger" id="closeInvoice">
                            <i class="fas fa-times"></i> داخستن
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- مۆدالی بینینی و بەڕێوەبردنی کەس -->
    <div class="modal" id="customerModal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h3>زانیاری کەس: <span id="modalCustomerName">عەلی محەممەد</span></h3>
                <button class="modal-close" id="closeCustomerModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="tab-buttons">
                    <button class="tab-btn active" data-customer-tab="info">زانیاری کەس</button>
                    <button class="tab-btn" data-customer-tab="debt">پارەواسڵکردن</button>
                    <button class="tab-btn" data-customer-tab="invoices">فاکتوورەکان</button>
                </div>
                
                <div class="tab-content active" id="customerInfoTab">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="editCustomerName">ناوی کەس</label>
                            <input type="text" id="editCustomerName" placeholder="ناوی کەس">
                        </div>
                        
                        <div class="form-group">
                            <label for="editCustomerPhone">ژمارەی موبایل</label>
                            <input type="text" id="editCustomerPhone" placeholder="٠٧٧٠١٢٣٤٥٦٧">
                        </div>
                        
                        <div class="form-group">
                            <label for="editCustomerAddress">ناونیشان</label>
                            <input type="text" id="editCustomerAddress" placeholder="ناونیشان">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="customerTotalDebt">کۆی قەرز</label>
                            <input type="text" id="customerTotalDebt" readonly style="background-color: var(--gray-light);">
                        </div>
                        
                        <div class="form-group">
                            <label for="customerLastPurchase">کۆتا فرۆشتن</label>
                            <input type="text" id="customerLastPurchase" readonly style="background-color: var(--gray-light);">
                        </div>
                        
                        <div class="form-group">
                            <label for="customerTotalPurchases">کۆی فرۆشتن</label>
                            <input type="text" id="customerTotalPurchases" readonly style="background-color: var(--gray-light);">
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn btn-danger" id="deleteCustomerBtn">
                            <i class="fas fa-trash"></i> سڕینەوەی کەس
                        </button>
                        <button class="btn btn-warning" id="printCustomerInfo">
                            <i class="fas fa-print"></i> پرێنتکردنی زانیاری
                        </button>
                        <button class="btn btn-success" id="saveCustomerChanges">
                            <i class="fas fa-save"></i> هەڵگرتنی گۆڕانکاریەکان
                        </button>
                    </div>
                </div>
                
                <div class="tab-content" id="customerDebtTab">
                    <div class="payment-container">
                        <h4 style="margin-bottom: 20px;">پارەواسڵکردن بۆ کەسەکە</h4>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="paymentAmount">بڕی پارە</label>
                                <input type="number" id="paymentAmount" placeholder="بڕی پارە بە دینار">
                            </div>
                            
                            <div class="form-group">
                                <label for="paymentDate">بەروار</label>
                                <input type="date" id="paymentDate">
                            </div>
                            
                            <div class="form-group">
                                <label for="paymentMethod">شێوازی پارەدان</label>
                                <select id="paymentMethod">
                                    <option value="cash">نەقدی</option>
                                    <option value="transfer">گوازینەوە</option>
                                    <option value="check">چەک</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="paymentNotes">تێبینی (ئارەزوومەندانە)</label>
                            <input type="text" id="paymentNotes" placeholder="تێبینی">
                        </div>
                        
                        <div class="action-buttons">
                            <button class="btn btn-success" id="submitPaymentBtnModal">
                                <i class="fas fa-check-circle"></i> تۆمارکردنی پارەواسڵکردن
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="tab-content" id="customerInvoicesTab">
                    <div class="search-container">
                        <div class="search-box">
                            <input type="text" id="customerInvoiceSearch" placeholder="گەڕان بە کۆدی فاکتوورە...">
                            <i class="fas fa-search"></i>
                        </div>
                    </div>
                    
                    <div class="list-box" style="margin-top: 20px;">
                        <div class="list-header">
                            <h3>فاکتوورەکانی کەسەکە</h3>
                            <div class="list-actions">
                                <button id="refreshCustomerInvoices">نوێکردنەوە</button>
                            </div>
                        </div>
                        <ul class="list-items" id="customerInvoicesList">
                            <!-- فاکتوورەکانی کەس لێرە زیاد دەکرێن -->
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- مۆدالی بینینی فاکتوور -->
    <div class="modal" id="invoiceDetailModal">
        <div class="modal-content" style="max-width: 1000px;">
            <div class="modal-header">
                <h3>فاکتوور: <span id="modalInvoiceCode">INV-2023-001</span></h3>
                <button class="modal-close" id="closeInvoiceModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="invoice" id="invoiceDetailContent">
                    <!-- نەخشەی فاکتوور لێرە کۆپی دەکرێت -->
                </div>
                
                <div class="print-options" style="margin-top: 30px;">
                    <button class="btn btn-warning" id="printInvoiceSmallDetail">
                        <i class="fas fa-print"></i> پرێنتی بچووک
                    </button>
                    <button class="btn btn-primary" id="printInvoiceA4Detail">
                        <i class="fas fa-print"></i> پرێنتی A4
                    </button>
                    <button class="btn btn-danger" id="deleteInvoiceBtn">
                        <i class="fas fa-trash"></i> سڕینەوەی فاکتوور
                    </button>
                    <button class="btn btn-info" id="editInvoiceBtn">
                        <i class="fas fa-edit"></i> گۆڕانکاری فاکتوور
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- هەموو JavaScript لێرە -->
    <script>
        // داتای نموونەیی بۆ سیستمەکە
        const sampleData = {
            products: [
                { id: 1, name: "مۆبایلی سامسۆنگ", barcode: "123456", purchasePrice: 500000, salePrice: 650000, stock: 15, unit: "piece", image: "mobile" },
                { id: 2, name: "تەلەفزیۆنی LG", barcode: "234567", purchasePrice: 1200000, salePrice: 1500000, stock: 8, unit: "piece", image: "tv" },
                { id: 3, name: "کۆمپیوتەری ڕوومێزی", barcode: "345678", purchasePrice: 800000, salePrice: 950000, stock: 12, unit: "piece", image: "computer" },
                { id: 4, name: "قاڵبی کارتۆنی", barcode: "456789", purchasePrice: 50000, salePrice: 70000, stock: 3, unit: "carton", image: "cardboard" },
                { id: 5, name: "مایکرۆوەیڤ", barcode: "567890", purchasePrice: 400000, salePrice: 500000, stock: 7, unit: "piece", image: "microwave" },
                { id: 6, name: "سەرعەم", barcode: "678901", purchasePrice: 200000, salePrice: 250000, stock: 0, unit: "piece", image: "headphone" },
                { id: 7, name: "کۆمپیوتەری لاپتۆپ", barcode: "789012", purchasePrice: 1500000, salePrice: 1800000, stock: 5, unit: "piece", image: "laptop" },
                { id: 8, name: "ئامێری دەنگ", barcode: "890123", purchasePrice: 300000, salePrice: 380000, stock: 2, unit: "piece", image: "speaker" }
            ],
            customers: [
                { id: 1, name: "عەلی محەممەد", phone: "07701234567", address: "هەولێر", debt: 120000 },
                { id: 2, name: "سەلام کەریم", phone: "07702345678", address: "سلێمانی", debt: 0 },
                { id: 3, name: "نەوزاد عەبدوڵڵا", phone: "07703456789", address: "هەولێر", debt: 75000 },
                { id: 4, name: "هەڤال ئەحمەد", phone: "07704567890", address: "دهۆک", debt: 250000 },
                { id: 5, name: "رێزان محەممەد", phone: "07705678901", address: "هەولێر", debt: 0 }
            ],
            partners: [
                { id: 1, name: "کۆمپانیای ئەلکترۆنی", phone: "07711223344", address: "هەولێر", debt: -450000 },
                { id: 2, name: "فرۆشگای کوردسات", phone: "07722334455", address: "سلێمانی", debt: -330000 },
                { id: 3, name: "کۆمپانیای ئێسپرێس", phone: "07733445566", address: "هەولێر", debt: 0 }
            ],
            sales: [
                { id: 1, code: "INV-2023-001", customer: "عەلی محەممەد", date: "2023-12-10", total: 650000, payment: "credit", items: ["مۆبایلی سامسۆنگ"] },
                { id: 2, code: "INV-2023-002", customer: "سەلام کەریم", date: "2023-12-11", total: 1500000, payment: "cash", items: ["تەلەفزیۆنی LG"] },
                { id: 3, code: "INV-2023-003", customer: "نەوزاد عەبدوڵڵا", date: "2023-12-12", total: 950000, payment: "credit", items: ["کۆمپیوتەری ڕوومێزی"] }
            ],
            purchases: [],
            cashBalance: 3540000,
            expenseHistory: [],
            paymentHistory: []
        };

        // داتای نموونەیی بۆ مێژووی کڕین
        const samplePurchaseData = {
            purchases: [
                { id: 1, code: "PUR-2023-001", partner: "کۆمپانیای ئەلکترۆنی", date: "2023-12-05", total: 1500000, payment: "credit", items: ["مۆبایلی سامسۆنگ", "مۆبایلی سامسۆنگ"] },
                { id: 2, code: "PUR-2023-002", partner: "فرۆشگای کوردسات", date: "2023-12-08", total: 800000, payment: "cash", items: ["کۆمپیوتەری ڕوومێزی"] }
            ]
        };

        // دۆمینەکان
        let currentUser = null;
        let cart = [];
        let purchaseCart = [];
        let selectedPayment = "cash";
        let selectedCustomer = null;

        // کۆدی چوونەژوورەوە - چاکسازیکراو
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            // چێکی کردنی ناوی بەکارهێنەر و وشەی نهێنی
            if (username && password) {
                // چاکسازی: فەرزاد یان admin دەتوانن بچنە ژوورەوە
                if ((username === 'farzad' && password === 'farzad1234') || (username === 'admin' && password === 'admin123')) {
                    currentUser = username;
                    
                    // نیشاندانی پەڕەی سەرەکی و شاردنەوەی پەڕەی چوونەژوورەوە
                    document.getElementById('loginPage').style.display = 'none';
                    document.getElementById('mainPage').style.display = 'flex';
                    
                    // زیادکردنی ناوی بەکارهێنەر
                    document.getElementById('currentUser').textContent = username === 'farzad' ? 'فەرزاد' : 'ئەدمین';
                    
                    // زیادکردنی داتای نموونەیی
                    populateSampleData();
                    
                    // چالاککردنی داشبۆرد وەک یەکەم بەش
                    showSection('dashboard');
                } else {
                    alert('ناوی بەکارهێنەر یان وشەی نهێنی هەڵەە! تکایە دووبارە هەوڵ بدەرەوە.\n\nتێبینی:\nناوی بەکارهێنەر: farzad، وشەی نهێنی: farzad1234\nیان\nناوی بەکارهێنەر: admin، وشەی نهێنی: admin123');
                }
            } else {
                alert('تکایە هەردوو خانە پڕ بکەرەوە!');
            }
        });

        // فانکشنی نیشاندانی بەش
        function showSection(sectionId) {
            // لابردنی چالاکی لە هەموو بەشەکان
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // لابردنی چالاکی لە هەموو بەستەرەکانی مێنیو
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            // زیادکردنی چالاکی بۆ بەشەکە
            const sectionElement = document.getElementById(sectionId + 'Section');
            if (sectionElement) {
                sectionElement.classList.add('active');
            }
            
            // زیادکردنی چالاکی بۆ بەستەری مێنیو
            const navLink = document.querySelector(`.nav-link[data-section="${sectionId}"]`);
            if (navLink) {
                navLink.classList.add('active');
            }
            
            // داخستنی مێنیو لەسەر مۆبایل
            if (window.innerWidth <= 992) {
                document.getElementById('sidebar').classList.remove('active');
            }
        }

        // چوونەدەرەوە
        document.getElementById('logoutBtn').addEventListener('click', function() {
            currentUser = null;
            cart = [];
            purchaseCart = [];
            selectedCustomer = null;
            selectedPayment = "cash";
            
            document.getElementById('mainPage').style.display = 'none';
            document.getElementById('loginPage').style.display = 'flex';
            
            // پاککردنەوەی خانەکانی چوونەژوورەوە
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            
            // پاککردنەوەی سەبەتە
            updateCartDisplay();
            updatePurchaseCartDisplay();
            
            // پاککردنەوەی هەڵبژاردنەکانی پارەدان
            document.querySelectorAll('.payment-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            document.querySelector('.payment-option[data-payment="cash"]').classList.add('selected');
            document.getElementById('customerSelection').style.display = 'none';
            document.getElementById('partnerSelection').style.display = 'none';
            if (document.getElementById('customerSearch')) {
                document.getElementById('customerSearch').value = '';
            }
            if (document.getElementById('partnerSearchPurchase')) {
                document.getElementById('partnerSearchPurchase').value = '';
            }
        });

        // نوێکردنەوەی کۆی پارە لە داشبۆرد
        function updateDashboardCash() {
            const cashCard = document.getElementById('cashBalanceDisplay');
            if (cashCard) {
                cashCard.innerHTML = `${sampleData.cashBalance.toLocaleString()} <span>دینار</span>`;
            }
        }

        // فەنکشنی هەژمارکردنی کۆی سەرفکردنی مانگی ئێستا
        function calculateMonthlyExpense() {
            const now = new Date();
            const currentMonth = now.getMonth();
            const currentYear = now.getFullYear();
            
            const monthlyExpenses = sampleData.expenseHistory.filter(expense => {
                const expenseDate = new Date(expense.date);
                return expenseDate.getMonth() === currentMonth && 
                       expenseDate.getFullYear() === currentYear;
            });
            
            const total = monthlyExpenses.reduce((sum, expense) => sum + expense.amount, 0);
            
            // هەژمارکردنی مانگی پێشوو
            const lastMonth = currentMonth === 0 ? 11 : currentMonth - 1;
            const lastMonthYear = currentMonth === 0 ? currentYear - 1 : currentYear;
            
            const lastMonthExpenses = sampleData.expenseHistory.filter(expense => {
                const expenseDate = new Date(expense.date);
                return expenseDate.getMonth() === lastMonth && 
                       expenseDate.getFullYear() === lastMonthYear;
            });
            
            const lastMonthTotal = lastMonthExpenses.reduce((sum, expense) => sum + expense.amount, 0);
            
            // نیشاندانی لە داشبۆرد
            const monthlyExpenseElement = document.getElementById('monthlyExpenseTotal');
            const expenseChangeElement = document.getElementById('expenseChange');
            
            if (monthlyExpenseElement) {
                monthlyExpenseElement.innerHTML = `${total.toLocaleString()} <span>دینار</span>`;
            }
            
            if (expenseChangeElement && lastMonthTotal > 0) {
                const change = total - lastMonthTotal;
                const percentage = Math.round((change / lastMonthTotal) * 100);
                
                if (change > 0) {
                    expenseChangeElement.innerHTML = `<i class="fas fa-arrow-up"></i> ${Math.abs(percentage)}% زیاتر لە مانگی ڕابردوو`;
                    expenseChangeElement.className = 'card-change negative';
                } else if (change < 0) {
                    expenseChangeElement.innerHTML = `<i class="fas fa-arrow-down"></i> ${Math.abs(percentage)}% کەمتر لە مانگی ڕابردوو`;
                    expenseChangeElement.className = 'card-change positive';
                } else {
                    expenseChangeElement.innerHTML = `<i class="fas fa-minus"></i> ٠% جیاوازی لە مانگی ڕابردوو`;
                    expenseChangeElement.className = 'card-change';
                }
            }
        }

        // زیادکردنی داتای نموونەیی
        function populateSampleData() {
            // زیادکردنی کاڵای کەم بووەکان
            const lowStockList = document.getElementById('lowStockList');
            if (lowStockList) {
                lowStockList.innerHTML = '';
                
                sampleData.products.filter(p => p.stock <= 5).forEach(product => {
                    const li = document.createElement('li');
                    li.className = 'list-item';
                    li.innerHTML = `
                        <div class="item-name">${product.name}</div>
                        <div class="item-value">${product.stock} ${product.unit === 'piece' ? 'پارچە' : product.unit === 'carton' ? 'کارتۆن' : 'دانە'}</div>
                    `;
                    lowStockList.appendChild(li);
                });
            }
            
            // زیادکردنی قەرزدارەکان
            const debtorsList = document.getElementById('debtorsList');
            if (debtorsList) {
                debtorsList.innerHTML = '';
                
                // قەرزدارەکان بریتین لە: کەسەکان کە قەرزداری منن (قەرز +) و شەریکەکان کە من قەرزداری ئەوانم (قەرز -)
                const allDebtors = [
                    ...sampleData.customers.filter(c => c.debt > 0).map(c => ({
                        name: c.name,
                        debt: c.debt,
                        type: 'کەس',
                        debtClass: 'debt-positive'
                    })),
                    ...sampleData.partners.filter(p => p.debt < 0).map(p => ({
                        name: p.name,
                        debt: Math.abs(p.debt),
                        type: 'شەریک',
                        debtClass: 'debt-negative'
                    }))
                ];
                
                allDebtors.forEach(debtor => {
                    const li = document.createElement('li');
                    li.className = 'list-item';
                    li.innerHTML = `
                        <div class="item-name">${debtor.name} (${debtor.type})</div>
                        <div class="item-value ${debtor.debtClass}">${debtor.debt.toLocaleString()} دینار</div>
                    `;
                    debtorsList.appendChild(li);
                });
            }
            
            // زیادکردنی لیستی کاڵاکان بۆ مخزن
            const productList = document.getElementById('productList');
            if (productList) {
                productList.innerHTML = '';
                
                sampleData.products.forEach(product => {
                    const li = document.createElement('li');
                    li.className = 'list-item';
                    li.innerHTML = `
                        <div class="item-name">${product.name}</div>
                        <div class="item-value">
                            <span style="margin-left: 15px;">${product.stock} ${product.unit === 'piece' ? 'پارچە' : product.unit === 'carton' ? 'کارتۆن' : 'دانە'}</span>
                            <span>${product.salePrice.toLocaleString()} دینار</span>
                        </div>
                    `;
                    productList.appendChild(li);
                });
            }
            
            // زیادکردنی مێژووی فرۆشتن
            const saleHistoryList = document.getElementById('saleHistoryList');
            if (saleHistoryList) {
                saleHistoryList.innerHTML = '';
                
                sampleData.sales.forEach(sale => {
                    const li = document.createElement('li');
                    li.className = 'list-item';
                    li.innerHTML = `
                        <div>
                            <div class="item-name">${sale.code} - ${sale.customer}</div>
                            <div style="font-size: 0.9rem; color: var(--gray);">
                                ${sale.date} - ${sale.payment === 'cash' ? 'نەقدی' : 'قەرز'}
                            </div>
                        </div>
                        <div class="item-value">${sale.total.toLocaleString()} دینار</div>
                    `;
                    saleHistoryList.appendChild(li);
                });
            }
            
            // زیادکردنی لیستی کەسەکان بۆ بەشی سەرەکی
            const customersMainList = document.getElementById('customersMainList');
            if (customersMainList) {
                customersMainList.innerHTML = '';
                
                sampleData.customers.forEach(customer => {
                    // دیاریکردنی رەنگ بەپێی قەرز
                    let debtClass = customer.debt > 0 ? 'debt-positive' : 'debt-zero';
                    
                    const li = document.createElement('li');
                    li.className = 'list-item';
                    li.setAttribute('data-customer-id', customer.id);
                    li.innerHTML = `
                        <div>
                            <div class="item-name">${customer.name}</div>
                            <div style="font-size: 0.9rem; color: var(--gray);">${customer.phone}</div>
                        </div>
                        <div>
                            <div class="item-value ${debtClass}">${customer.debt.toLocaleString()} دینار قەرز</div>
                            <div style="margin-top: 10px;">
                                <button class="btn btn-info btn-sm" onclick="viewCustomerDetails(${customer.id})">
                                    <i class="fas fa-eye"></i> بینین
                                </button>
                            </div>
                        </div>
                    `;
                    customersMainList.appendChild(li);
                });
            }
            
            // زیادکردنی لیستی شەریکەکان
            const partnersListItems = document.getElementById('partnersListItems');
            if (partnersListItems) {
                partnersListItems.innerHTML = '';
                
                sampleData.partners.forEach(partner => {
                    // دیاریکردنی رەنگ بەپێی جۆری قەرز
                    let debtText, debtClass;
                    
                    if (partner.debt > 0) {
                        // شەریک قەرزداری منە (مثبت) - سۆر
                        debtText = `${partner.debt.toLocaleString()} دینار (شەریک قەرزداری منە)`;
                        debtClass = 'debt-positive';
                    } else if (partner.debt < 0) {
                        // من قەرزداری شەریکم (منفی) - رەش
                        debtText = `${Math.abs(partner.debt).toLocaleString()} دینار (من قەرزداری ئەوانم)`;
                        debtClass = 'debt-negative';
                    } else {
                        // بێ قەرز - خۆڵەمێشی
                        debtText = 'بێ قەرز';
                        debtClass = 'debt-zero';
                    }
                    
                    const li = document.createElement('li');
                    li.className = 'list-item';
                    li.innerHTML = `
                        <div class="item-name">${partner.name}</div>
                        <div class="item-value ${debtClass}">${debtText}</div>
                    `;
                    partnersListItems.appendChild(li);
                });
            }
            
            // زیادکردنی مێژووی کڕین
            updatePurchaseHistoryDisplay();
            
            // نوێکردنەوەی کۆی پارە
            updateDashboardCash();
            
            // هەژمارکردنی کۆی سەرفکردن
            calculateMonthlyExpense();
            
            // نوێکردنەوەی مێژووی پارەواسڵکردن
            updatePaymentHistoryDisplay();
            
            // نوێکردنەوەی مێژووی سەرفکردن
            updateExpenseHistoryDisplay();
            updateExpenseHistoryMainDisplay();
        }

        // فانکشنی بینینی وردەکارییەکانی کەس
        window.viewCustomerDetails = function(customerId) {
            const customer = sampleData.customers.find(c => c.id === customerId);
            if (!customer) return;
            
            // نوێکردنەوەی مۆدال
            document.getElementById('modalCustomerName').textContent = customer.name;
            document.getElementById('editCustomerName').value = customer.name;
            document.getElementById('editCustomerPhone').value = customer.phone;
            document.getElementById('editCustomerAddress').value = customer.address || '';
            document.getElementById('customerTotalDebt').value = customer.debt.toLocaleString() + ' دینار';
            
            // دۆزینەوەی فاکتوورەکانی ئەم کەسە
            const customerInvoices = sampleData.sales.filter(s => s.customer === customer.name);
            document.getElementById('customerTotalPurchases').value = customerInvoices.length + ' فاکتوور';
            
            if (customerInvoices.length > 0) {
                const lastInvoice = customerInvoices[0];
                document.getElementById('customerLastPurchase').value = lastInvoice.date;
                
                // نوێکردنەوەی لیستی فاکتوورەکان
                const customerInvoicesList = document.getElementById('customerInvoicesList');
                if (customerInvoicesList) {
                    customerInvoicesList.innerHTML = '';
                    
                    customerInvoices.forEach(invoice => {
                        const li = document.createElement('li');
                        li.className = 'list-item';
                        li.setAttribute('data-invoice-id', invoice.id);
                        li.innerHTML = `
                            <div>
                                <div class="item-name">${invoice.code}</div>
                                <div style="font-size: 0.9rem; color: var(--gray);">
                                    ${invoice.date} - ${invoice.items.length} کاڵا
                                </div>
                            </div>
                            <div>
                                <div class="item-value">${invoice.total.toLocaleString()} دینار</div>
                                <div style="margin-top: 10px; display: flex; gap: 5px;">
                                    <button class="btn btn-info btn-sm" onclick="viewInvoiceDetails(${invoice.id})">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn btn-danger btn-sm" onclick="deleteInvoice(${invoice.id})">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        `;
                        customerInvoicesList.appendChild(li);
                    });
                }
            } else {
                document.getElementById('customerLastPurchase').value = 'هیچ فرۆشتنی پێشوو';
                
                const customerInvoicesList = document.getElementById('customerInvoicesList');
                if (customerInvoicesList) {
                    customerInvoicesList.innerHTML = '<li class="list-item">هیچ فاکتوورێک نییە</li>';
                }
            }
            
            // نیشاندانی مۆدال
            document.getElementById('customerModal').classList.add('active');
        };

        // فانکشنی بینینی وردەکاری فاکتوور
        window.viewInvoiceDetails = function(invoiceId) {
            const invoice = sampleData.sales.find(s => s.id === invoiceId);
            if (!invoice) return;
            
            // نوێکردنەوەی مۆدالی فاکتوور
            document.getElementById('modalInvoiceCode').textContent = invoice.code;
            
            // دروستکردنی نەخشەی فاکتوور
            const invoiceDetailContent = document.getElementById('invoiceDetailContent');
            if (invoiceDetailContent) {
                const customer = sampleData.customers.find(c => c.name === invoice.customer);
                
                invoiceDetailContent.innerHTML = `
                    <div class="invoice-header">
                        <div class="invoice-logo">الکترۆنیات</div>
                        <h2>فاکتووری فرۆشتن</h2>
                        <p>کۆدی فاکتوورە: <span id="detailInvoiceCode">${invoice.code}</span></p>
                        <p>بەروار: <span id="detailInvoiceDate">${invoice.date}</span></p>
                    </div>
                    
                    <div class="invoice-details">
                        <div>
                            <h4>زانیاری فرۆشەر:</h4>
                            <p>ناوی سیستەم: الکترۆنیات</p>
                            <p>ژمارەی موبایل: ٠٧٧٠١٢٣٤٥٦٧</p>
                            <p>ناونیشان: هەولێر، کوردستان</p>
                        </div>
                        
                        <div>
                            <h4>زانیاری کڕیار:</h4>
                            <p>ناوی کڕیار: ${invoice.customer}</p>
                            <p>ژمارەی موبایل: ${customer ? customer.phone : 'نەزانراو'}</p>
                            <p>ناونیشان: ${customer ? customer.address : 'نەزانراو'}</p>
                        </div>
                    </div>
                    
                    <table class="invoice-table">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>ناوی کاڵا</th>
                                <th>بڕ</th>
                                <th>نرخ</th>
                                <th>کۆی گشتی</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${invoice.items.map((item, index) => {
                                const product = sampleData.products.find(p => p.name === item);
                                const price = product ? product.salePrice : 0;
                                return `
                                    <tr>
                                        <td>${index + 1}</td>
                                        <td>${item}</td>
                                        <td>١</td>
                                        <td>${price.toLocaleString()} دینار</td>
                                        <td>${price.toLocaleString()} دینار</td>
                                    </tr>
                                `;
                            }).join('')}
                        </tbody>
                    </table>
                    
                    <div class="invoice-total">
                        <p><strong>کۆی گشتی:</strong> ${invoice.total.toLocaleString()} دینار</p>
                        <p><strong>شێوازی پارەدان:</strong> ${invoice.payment === 'cash' ? 'نەقدی' : 'قەرز'}</p>
                        ${invoice.payment === 'credit' ? `
                            <p><strong>قەرز:</strong> ${invoice.total.toLocaleString()} دینار</p>
                        ` : ''}
                    </div>
                `;
            }
            
            // نیشاندانی مۆدال
            document.getElementById('invoiceDetailModal').classList.add('active');
        };

        // فانکشنی سڕینەوەی فاکتوور
        window.deleteInvoice = function(invoiceId) {
            if (confirm('دڵنیای لە سڕینەوەی ئەم فاکتوورە؟')) {
                const index = sampleData.sales.findIndex(s => s.id === invoiceId);
                if (index !== -1) {
                    sampleData.sales.splice(index, 1);
                    alert('فاکتوورەکە بە سەرکەوتوویی سڕایەوە!');
                    
                    // نوێکردنەوەی نیشاندانەکان
                    if (document.getElementById('customerModal').classList.contains('active')) {
                        const customerId = parseInt(document.querySelector('#customerModal [data-customer-id]')?.getAttribute('data-customer-id') || 0);
                        if (customerId) {
                            viewCustomerDetails(customerId);
                        }
                    }
                    
                    populateSampleData();
                }
            }
        };

        // نەخشەی مێنیو
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                
                const sectionId = this.getAttribute('data-section');
                showSection(sectionId);
            });
        });

        // نەخشەی مێنیوی مۆبایل
        document.getElementById('menuToggle').addEventListener('click', function() {
            document.getElementById('sidebar').classList.toggle('active');
        });

        document.getElementById('closeSidebar').addEventListener('click', function() {
            document.getElementById('sidebar').classList.remove('active');
        });

        // نەخشەی گەڕان بۆ کاڵا لە بەشی فرۆشتن
        const productSearch = document.getElementById('productSearch');
        if (productSearch) {
            productSearch.addEventListener('input', function() {
                const query = this.value.toLowerCase();
                const suggestions = document.getElementById('productSuggestions');
                
                if (!suggestions) return;
                
                if (query.length < 2) {
                    suggestions.style.display = 'none';
                    return;
                }
                
                const filteredProducts = sampleData.products.filter(p => 
                    p.name.toLowerCase().includes(query) || 
                    p.barcode.includes(query)
                );
                
                suggestions.innerHTML = '';
                
                if (filteredProducts.length === 0) {
                    suggestions.style.display = 'none';
                    return;
                }
                
                filteredProducts.forEach(product => {
                    const div = document.createElement('div');
                    div.className = 'suggestion-item';
                    div.textContent = `${product.name} - ${product.salePrice.toLocaleString()} دینار`;
                    
                    div.addEventListener('click', function() {
                        showSaleAdjustmentModal(product);
                        document.getElementById('productSearch').value = '';
                        suggestions.style.display = 'none';
                    });
                    
                    suggestions.appendChild(div);
                });
                
                suggestions.style.display = 'block';
            });
        }

        // مۆدالی گۆڕانکاری لە فرۆشتن
        window.showSaleAdjustmentModal = function(product) {
            // چەک کردنی ئەگەر مۆدالێکی پێشوو هەبێت
            const existingModal = document.getElementById('saleAdjustmentModal');
            if (existingModal) {
                existingModal.remove();
            }
            
            const modalHTML = `
                <div class="modal active" id="saleAdjustmentModal">
                    <div class="modal-content" style="max-width: 500px;">
                        <div class="modal-header">
                            <h3>زیادکردنی کاڵا: ${product.name}</h3>
                            <button class="modal-close" onclick="document.getElementById('saleAdjustmentModal').remove()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="modal-body">
                            <div class="form-group">
                                <label>نرخی فرۆشتن (بنچینەیی)</label>
                                <input type="number" id="baseSalePrice" value="${product.salePrice}" readonly style="background-color: var(--gray-light);">
                            </div>
                            
                            <div class="form-group">
                                <label>نرخی فرۆشتن (دەستکاریکراو)</label>
                                <input type="number" id="adjustedSalePrice" value="${product.salePrice}" placeholder="نرخی فرۆشتنی دەستکاریکراو">
                            </div>
                            
                            <div class="form-group">
                                <label>بڕی فرۆشتن</label>
                                <input type="number" id="saleQuantity" value="1" min="1" max="${product.stock}" placeholder="بڕ">
                                <small style="color: var(--gray);">بڕی بەردەست: ${product.stock}</small>
                            </div>
                            
                            <div class="form-group">
                                <label>یەکە</label>
                                <select id="saleUnit">
                                    <option value="piece" ${product.unit === 'piece' ? 'selected' : ''}>پارچە</option>
                                    <option value="carton" ${product.unit === 'carton' ? 'selected' : ''}>کارتۆن</option>
                                    <option value="unit" ${product.unit === 'unit' ? 'selected' : ''}>دانە</option>
                                </select>
                            </div>
                            
                            <div class="action-buttons">
                                <button class="btn btn-danger" onclick="document.getElementById('saleAdjustmentModal').remove()">
                                    پاشگەزبوونەوە
                                </button>
                                <button class="btn btn-success" onclick="addToCartWithAdjustment(${product.id})">
                                    زیادکردن بۆ سەبەتە
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        };

        // زیادکردنی کاڵا بە نرخ و بڕی دەستکاریکراو
        window.addToCartWithAdjustment = function(productId) {
            const product = sampleData.products.find(p => p.id === productId);
            if (!product) return;
            
            const adjustedPrice = parseInt(document.getElementById('adjustedSalePrice').value) || product.salePrice;
            const quantity = parseInt(document.getElementById('saleQuantity').value) || 1;
            const unit = document.getElementById('saleUnit').value;
            
            // پشکنینی بڕی بەردەست
            if (quantity > product.stock) {
                alert(`تەنها ${product.stock} ${unit === 'piece' ? 'پارچە' : unit === 'carton' ? 'کارتۆن' : 'دانە'} بەردەستە!`);
                return;
            }
            
            const existingItem = cart.find(item => item.id === product.id && item.price === adjustedPrice);
            
            if (existingItem) {
                existingItem.quantity += quantity;
            } else {
                cart.push({
                    id: product.id,
                    name: product.name,
                    price: adjustedPrice,
                    quantity: quantity,
                    unit: unit,
                    originalPrice: product.salePrice
                });
            }
            
            updateCartDisplay();
            document.getElementById('saleAdjustmentModal').remove();
        };

        // نوێکردنەوەی نیشاندانی سەبەتە
        function updateCartDisplay() {
            const cartItems = document.getElementById('cartItems');
            if (!cartItems) return;
            
            cartItems.innerHTML = '';
            
            if (cart.length === 0) {
                cartItems.innerHTML = '<li class="empty-cart">هیچ کاڵایەک لە سەبەتەدا نییە</li>';
                return;
            }
            
            let total = 0;
            
            cart.forEach((item, index) => {
                const li = document.createElement('li');
                li.className = 'cart-item';
                
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                
                li.innerHTML = `
                    <div class="cart-item-info">
                        <div class="cart-item-image">
                            <i class="fas fa-${getProductIcon(item.name)}"></i>
                        </div>
                        <div>
                            <div class="item-name">${item.name}</div>
                            <div style="font-size: 0.9rem; color: var(--gray);">
                                ${item.quantity} ${item.unit === 'piece' ? 'پارچە' : item.unit === 'carton' ? 'کارتۆن' : 'دانە'} × ${item.price.toLocaleString()} دینار
                            </div>
                        </div>
                    </div>
                    <div>
                        <div class="item-value">${itemTotal.toLocaleString()} دینار</div>
                        <div style="margin-top: 10px;">
                            <button class="btn btn-danger" style="padding: 5px 10px; font-size: 0.8rem;" onclick="removeFromCart(${index})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
                
                cartItems.appendChild(li);
            });
        }

        // سڕینەوەی کاڵا لە سەبەتە
        window.removeFromCart = function(index) {
            cart.splice(index, 1);
            updateCartDisplay();
        };

        // دەستنیشانکردنی ئایکۆنی کاڵا
        function getProductIcon(productName) {
            if (productName.includes("مۆبایل")) return "mobile-alt";
            if (productName.includes("تەلەفزیۆن")) return "tv";
            if (productName.includes("کۆمپیوتەر")) return "desktop";
            if (productName.includes("لاپتۆپ")) return "laptop";
            if (productName.includes("سەرعەم")) return "headphones";
            if (productName.includes("ئامێری دەنگ")) return "volume-up";
            if (productName.includes("مایکرۆوەیڤ")) return "microphone";
            if (productName.includes("قاڵبی")) return "box";
            return "box";
        }

        // هەڵبژاردنی جۆری پارەدان
        document.querySelectorAll('.payment-option').forEach(option => {
            option.addEventListener('click', function() {
                const container = this.closest('.cart-container');
                if (!container) return;
                
                container.querySelectorAll('.payment-option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                
                this.classList.add('selected');
                selectedPayment = this.getAttribute('data-payment');
                
                const customerSelection = container.querySelector('#customerSelection');
                if (customerSelection) {
                    if (selectedPayment === 'credit') {
                        customerSelection.style.display = 'block';
                    } else {
                        customerSelection.style.display = 'none';
                        selectedCustomer = null;
                    }
                }
            });
        });

        // گەڕان بەدوای کەسەکان
        const customerSearch = document.getElementById('customerSearch');
        if (customerSearch) {
            customerSearch.addEventListener('input', function() {
                const query = this.value.toLowerCase();
                const suggestions = document.getElementById('customerSuggestions');
                
                if (!suggestions) return;
                
                if (query.length < 2) {
                    suggestions.style.display = 'none';
                    return;
                }
                
                const filteredCustomers = sampleData.customers.filter(c => 
                    c.name.toLowerCase().includes(query)
                );
                
                suggestions.innerHTML = '';
                
                if (filteredCustomers.length === 0) {
                    suggestions.style.display = 'none';
                    return;
                }
                
                filteredCustomers.forEach(customer => {
                    const div = document.createElement('div');
                    div.className = 'suggestion-item';
                    div.textContent = `${customer.name} - ${customer.debt > 0 ? customer.debt.toLocaleString() + ' دینار قەرز' : 'بێ قەرز'}`;
                    
                    div.addEventListener('click', function() {
                        selectedCustomer = customer;
                        document.getElementById('customerSearch').value = customer.name;
                        suggestions.style.display = 'none';
                    });
                    
                    suggestions.appendChild(div);
                });
                
                suggestions.style.display = 'block';
            });
        }

        // سڕینەوەی سەبەتە
        const clearCartBtn = document.getElementById('clearCart');
        if (clearCartBtn) {
            clearCartBtn.addEventListener('click', function() {
                cart = [];
                updateCartDisplay();
            });
        }

        // پرێنتکردنی فاکتوور
        const printInvoiceBtn = document.getElementById('printInvoice');
        if (printInvoiceBtn) {
            printInvoiceBtn.addEventListener('click', function() {
                if (cart.length === 0) {
                    alert('تکایە یەکێک لە کاڵاکان زیاد بکە بۆ سەبەتە پێش پرێنتکردن!');
                    return;
                }
                
                if (selectedPayment === 'credit' && !selectedCustomer) {
                    alert('تکایە کەسێک هەڵبژێرە بۆ فرۆشتن بە قەرز!');
                    return;
                }
                
                updateInvoice();
                
                document.getElementById('printModal').classList.add('active');
            });
        }

        // نوێکردنەوەی فاکتوورەکە
        function updateInvoice() {
            const invoiceCode = `INV-${new Date().getFullYear()}-${Math.floor(Math.random() * 1000)}`;
            const invoiceCodeElement = document.getElementById('invoiceCode');
            if (invoiceCodeElement) {
                invoiceCodeElement.textContent = invoiceCode;
            }
            
            const now = new Date();
            const dateStr = `${now.getFullYear()}/${now.getMonth() + 1}/${now.getDate()}`;
            const invoiceDateElement = document.getElementById('invoiceDate');
            if (invoiceDateElement) {
                invoiceDateElement.textContent = dateStr;
            }
            
            const customerNameElement = document.getElementById('customerName');
            const customerPhoneElement = document.getElementById('customerPhone');
            const customerAddressElement = document.getElementById('customerAddress');
            
            if (customerNameElement && customerPhoneElement && customerAddressElement) {
                if (selectedCustomer) {
                    customerNameElement.textContent = `ناوی کڕیار: ${selectedCustomer.name}`;
                    customerPhoneElement.textContent = `ژمارەی موبایل: ${selectedCustomer.phone}`;
                    customerAddressElement.textContent = `ناونیشان: ${selectedCustomer.address || 'نەزانراو'}`;
                } else {
                    customerNameElement.textContent = `ناوی کڕیار: کڕیاری نەناسراو`;
                    customerPhoneElement.textContent = `ژمارەی موبایل: نەزانراو`;
                    customerAddressElement.textContent = `ناونیشان: نەزانراو`;
                }
            }
            
            const invoiceItems = document.getElementById('invoiceItems');
            if (invoiceItems) {
                invoiceItems.innerHTML = '';
                
                let total = 0;
                cart.forEach((item, index) => {
                    const itemTotal = item.price * item.quantity;
                    total += itemTotal;
                    
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${index + 1}</td>
                        <td>${item.name}</td>
                        <td>${item.unit === 'piece' ? 'پارچە' : item.unit === 'carton' ? 'کارتۆن' : 'دانە'}</td>
                        <td>${item.quantity}</td>
                        <td>${item.price.toLocaleString()} دینار</td>
                        <td>${itemTotal.toLocaleString()} دینار</td>
                    `;
                    invoiceItems.appendChild(tr);
                });
                
                const invoiceTotalElement = document.getElementById('invoiceTotal');
                if (invoiceTotalElement) {
                    invoiceTotalElement.textContent = `${total.toLocaleString()} دینار`;
                }
                
                const previousDebt = selectedCustomer ? selectedCustomer.debt : 0;
                const currentDebt = selectedPayment === 'credit' ? total : 0;
                const totalDebt = previousDebt + currentDebt;
                
                const previousDebtElement = document.getElementById('previousDebt');
                const currentDebtElement = document.getElementById('currentDebt');
                const totalDebtElement = document.getElementById('totalDebt');
                
                if (previousDebtElement) previousDebtElement.textContent = `${previousDebt.toLocaleString()} دینار`;
                if (currentDebtElement) currentDebtElement.textContent = `${currentDebt.toLocaleString()} دینار`;
                if (totalDebtElement) totalDebtElement.textContent = `${totalDebt.toLocaleString()} دینار`;
            }
        }

        // داخستنی مۆدالی پرێنت
        const closePrintModalBtn = document.getElementById('closePrintModal');
        if (closePrintModalBtn) {
            closePrintModalBtn.addEventListener('click', function() {
                document.getElementById('printModal').classList.remove('active');
            });
        }

        const closeInvoiceBtn = document.getElementById('closeInvoice');
        if (closeInvoiceBtn) {
            closeInvoiceBtn.addEventListener('click', function() {
                document.getElementById('printModal').classList.remove('active');
            });
        }

        // تەواوکردنی فرۆشتن
        const completeSaleBtn = document.getElementById('completeSale');
        if (completeSaleBtn) {
            completeSaleBtn.addEventListener('click', function() {
                if (cart.length === 0) {
                    alert('تکایە یەکێک لە کاڵاکان زیاد بکە بۆ سەبەتە پێش تەواوکردنی فرۆشتن!');
                    return;
                }
                
                if (selectedPayment === 'credit' && !selectedCustomer) {
                    alert('تکایە کەسێک هەڵبژێرە بۆ فرۆشتن بە قەرز!');
                    return;
                }
                
                const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                const newSale = {
                    id: sampleData.sales.length + 1,
                    code: `INV-${new Date().getFullYear()}-${sampleData.sales.length + 1}`,
                    customer: selectedCustomer ? selectedCustomer.name : 'کڕیاری نەناسراو',
                    date: new Date().toISOString().split('T')[0],
                    total: total,
                    payment: selectedPayment,
                    items: cart.map(item => item.name)
                };
                
                sampleData.sales.unshift(newSale);
                
                if (selectedPayment === 'cash') {
                    // زیادکردنی پارە بۆ کۆی نەقدی
                    sampleData.cashBalance += total;
                    updateDashboardCash();
                } else if (selectedPayment === 'credit' && selectedCustomer) {
                    // کەس قەرزداری منە، قەرزی زیاد دەبێت
                    selectedCustomer.debt += total;
                }
                
                // کەمکردنەوەی کاڵا لە مخزن
                cart.forEach(item => {
                    const product = sampleData.products.find(p => p.id === item.id);
                    if (product) {
                        product.stock -= item.quantity;
                        if (product.stock < 0) product.stock = 0;
                    }
                });
                
                populateSampleData();
                
                cart = [];
                updateCartDisplay();
                selectedCustomer = null;
                selectedPayment = "cash";
                
                document.querySelectorAll('.payment-option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                const cashOption = document.querySelector('.payment-option[data-payment="cash"]');
                if (cashOption) {
                    cashOption.classList.add('selected');
                }
                const customerSelection = document.getElementById('customerSelection');
                if (customerSelection) {
                    customerSelection.style.display = 'none';
                }
                const customerSearch = document.getElementById('customerSearch');
                if (customerSearch) {
                    customerSearch.value = '';
                }
                
                alert('فرۆشتنەکە بە سەرکەوتوویی تەواو بوو!');
            });
        }

        // نەخشەی تاباتەکان لە بەشی فرۆشتن و کڕین
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const tabId = this.getAttribute('data-tab');
                
                const parent = this.closest('.tab-buttons');
                if (parent) {
                    parent.querySelectorAll('.tab-btn').forEach(b => {
                        b.classList.remove('active');
                    });
                }
                
                this.classList.add('active');
                
                const container = this.closest('.sale-purchase-container');
                if (container) {
                    container.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    const tabContent = document.getElementById(tabId);
                    if (tabContent) {
                        tabContent.classList.add('active');
                    }
                }
            });
        });

        // نەخشەی تاباتەکان لە بەشی مخزن
        document.querySelectorAll('.inventory-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const tabId = this.getAttribute('data-inventory-tab') + 'Tab';
                
                const parent = this.closest('.inventory-tabs');
                if (parent) {
                    parent.querySelectorAll('.inventory-tab').forEach(t => {
                        t.classList.remove('active');
                    });
                }
                
                this.classList.add('active');
                
                const container = this.closest('.inventory-content').parentElement;
                if (container) {
                    container.querySelectorAll('.inventory-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    const tabContent = document.getElementById(tabId);
                    if (tabContent) {
                        tabContent.classList.add('active');
                    }
                }
            });
        });

        // زیادکردنی کاڵای نوێ لە مخزن
        const addProductBtn = document.getElementById('addProductBtn');
        if (addProductBtn) {
            addProductBtn.addEventListener('click', function() {
                const productForm = document.getElementById('productForm');
                if (productForm) {
                    productForm.style.display = 'block';
                    this.style.display = 'none';
                    
                    const productName = document.getElementById('productName');
                    const productBarcode = document.getElementById('productBarcode');
                    const purchasePrice = document.getElementById('purchasePrice');
                    const salePrice = document.getElementById('salePrice');
                    const stockQuantity = document.getElementById('stockQuantity');
                    const primaryUnit = document.getElementById('primaryUnit');
                    const secondaryUnit = document.getElementById('secondaryUnit');
                    const secondaryUnitQuantity = document.getElementById('secondaryUnitQuantity');
                    
                    if (productName) productName.value = '';
                    if (productBarcode) productBarcode.value = '';
                    if (purchasePrice) purchasePrice.value = '';
                    if (salePrice) salePrice.value = '';
                    if (stockQuantity) stockQuantity.value = '';
                    if (primaryUnit) primaryUnit.value = 'piece';
                    if (secondaryUnit) secondaryUnit.value = '';
                    if (secondaryUnitQuantity) secondaryUnitQuantity.value = '';
                }
            });
        }

        // پاشگەزبوونەوە لە زیادکردنی کاڵا
        const cancelProductBtn = document.getElementById('cancelProductBtn');
        if (cancelProductBtn) {
            cancelProductBtn.addEventListener('click', function() {
                const productForm = document.getElementById('productForm');
                const addProductBtn = document.getElementById('addProductBtn');
                
                if (productForm && addProductBtn) {
                    productForm.style.display = 'none';
                    addProductBtn.style.display = 'block';
                }
            });
        }

        // هەڵگرتنی کاڵای نوێ
        const saveProductBtn = document.getElementById('saveProductBtn');
        if (saveProductBtn) {
            saveProductBtn.addEventListener('click', function() {
                const productName = document.getElementById('productName');
                const purchasePrice = document.getElementById('purchasePrice');
                const salePrice = document.getElementById('salePrice');
                const stockQuantity = document.getElementById('stockQuantity');
                
                if (!productName || !purchasePrice || !salePrice || !stockQuantity) {
                    alert('تکایە هەموو خانە پڕەکان پڕ بکەرەوە!');
                    return;
                }
                
                const name = productName.value;
                const purchasePriceValue = parseInt(purchasePrice.value) || 0;
                const salePriceValue = parseInt(salePrice.value) || 0;
                const stock = parseInt(stockQuantity.value) || 0;
                
                if (!name || salePriceValue === 0) {
                    alert('تکایە ناوی کاڵا و نرخی فرۆشتن پڕ بکەرەوە!');
                    return;
                }
                
                const newProduct = {
                    id: sampleData.products.length + 1,
                    name: name,
                    barcode: document.getElementById('productBarcode').value || `BR${sampleData.products.length + 1000}`,
                    purchasePrice: purchasePriceValue,
                    salePrice: salePriceValue,
                    stock: stock,
                    unit: document.getElementById('primaryUnit').value
                };
                
                sampleData.products.push(newProduct);
                
                populateSampleData();
                
                const productForm = document.getElementById('productForm');
                const addProductBtn = document.getElementById('addProductBtn');
                
                if (productForm && addProductBtn) {
                    productForm.style.display = 'none';
                    addProductBtn.style.display = 'block';
                }
                
                alert('کاڵای نوێ بە سەرکەوتوویی زیاد کرا!');
            });
        }

        // نوێکردنەوەی لیستی کاڵای کەم بوو
        const refreshLowStockBtn = document.getElementById('refreshLowStock');
        if (refreshLowStockBtn) {
            refreshLowStockBtn.addEventListener('click', function() {
                populateSampleData();
                alert('لیستی کاڵای کەم بووەکان نوێ کرایەوە!');
            });
        }

        // نوێکردنەوەی لیستی قەرزداران
        const refreshDebtorsBtn = document.getElementById('refreshDebtors');
        if (refreshDebtorsBtn) {
            refreshDebtorsBtn.addEventListener('click', function() {
                populateSampleData();
                alert('لیستی قەرزدارەکان نوێ کرایەوە!');
            });
        }

        // نوێکردنەوەی مێژووی فرۆشتن
        const refreshSaleHistoryBtn = document.getElementById('refreshSaleHistory');
        if (refreshSaleHistoryBtn) {
            refreshSaleHistoryBtn.addEventListener('click', function() {
                populateSampleData();
                alert('مێژووی فرۆشتن نوێ کرایەوە!');
            });
        }

        // پرێنتی بچووک
        const printSmallBtn = document.getElementById('printSmall');
        if (printSmallBtn) {
            printSmallBtn.addEventListener('click', function() {
                alert('پرێنتی بچووک ئامادەکرا (لە وەشانی راستەقینەدا پرێنت دەکرێت)');
            });
        }

        // پرێنتی A4
        const printA4Btn = document.getElementById('printA4');
        if (printA4Btn) {
            printA4Btn.addEventListener('click', function() {
                alert('پرێنتی A4 ئامادەکرا (لە وەشانی راستەقینەدا پرێنت دەکرێت)');
            });
        }

        // داخستنی مۆدالی کەس
        const closeCustomerModalBtn = document.getElementById('closeCustomerModal');
        if (closeCustomerModalBtn) {
            closeCustomerModalBtn.addEventListener('click', function() {
                document.getElementById('customerModal').classList.remove('active');
            });
        }

        // داخستنی مۆدالی فاکتوور
        const closeInvoiceModalBtn = document.getElementById('closeInvoiceModal');
        if (closeInvoiceModalBtn) {
            closeInvoiceModalBtn.addEventListener('click', function() {
                document.getElementById('invoiceDetailModal').classList.remove('active');
            });
        }

        // نەخشەی تاباتەکان لە مۆدالی کەس
        document.querySelectorAll('[data-customer-tab]').forEach(tab => {
            tab.addEventListener('click', function() {
                const tabId = this.getAttribute('data-customer-tab');
                
                const parent = this.closest('.tab-buttons');
                if (parent) {
                    parent.querySelectorAll('.tab-btn').forEach(b => {
                        b.classList.remove('active');
                    });
                }
                
                this.classList.add('active');
                
                const modal = this.closest('.modal-content');
                if (modal) {
                    modal.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    const tabContent = document.getElementById(tabId + 'Tab');
                    if (tabContent) {
                        tabContent.classList.add('active');
                    }
                }
            });
        });

        // زیادکردنی کەسی نوێ (چاکسازی)
        const saveCustomerBtn = document.getElementById('saveCustomerBtn');
        if (saveCustomerBtn) {
            saveCustomerBtn.addEventListener('click', function() {
                const name = document.getElementById('newCustomerName').value.trim();
                const phone = document.getElementById('newCustomerPhone').value.trim();
                
                if (!name || !phone) {
                    alert('تکایە ناو و ژمارەی موبایل پڕ بکەرەوە!');
                    return;
                }
                
                // پشکنین بۆ دووبارەبوونەوە
                const existingCustomer = sampleData.customers.find(c => 
                    c.name === name || c.phone === phone
                );
                
                if (existingCustomer) {
                    alert('کەسێک بەم ناوە یان ژمارەیە هەیە!');
                    return;
                }
                
                const newCustomer = {
                    id: sampleData.customers.length + 1,
                    name: name,
                    phone: phone,
                    address: document.getElementById('newCustomerAddress').value.trim() || '',
                    debt: 0
                };
                
                sampleData.customers.push(newCustomer);
                
                // پاککردنەوەی خانەکان
                document.getElementById('newCustomerName').value = '';
                document.getElementById('newCustomerPhone').value = '';
                document.getElementById('newCustomerAddress').value = '';
                
                // نوێکردنەوەی لیست
                populateSampleData();
                
                // گەڕانەوە بۆ لیست
                document.querySelector('.tab-btn[data-tab="customersList"]').click();
                
                alert('کەسی نوێ بە سەرکەوتوویی زیاد کرا!');
            });
        }

        // پاشگەزبوونەوە لە زیادکردنی کەس
        const cancelCustomerBtn = document.getElementById('cancelCustomerBtn');
        if (cancelCustomerBtn) {
            cancelCustomerBtn.addEventListener('click', function() {
                document.querySelector('.tab-btn[data-tab="customersList"]').click();
                
                document.getElementById('newCustomerName').value = '';
                document.getElementById('newCustomerPhone').value = '';
                document.getElementById('newCustomerAddress').value = '';
            });
        }

        // زیادکردنی شەریکی نوێ
        const savePartnerBtn = document.getElementById('savePartnerBtn');
        if (savePartnerBtn) {
            savePartnerBtn.addEventListener('click', function() {
                const name = document.getElementById('newPartnerName').value.trim();
                const phone = document.getElementById('newPartnerPhone').value.trim();
                
                if (!name || !phone) {
                    alert('تکایە ناو و ژمارەی موبایل پڕ بکەرەوە!');
                    return;
                }
                
                // پشکنین بۆ دووبارەبوونەوە
                const existingPartner = sampleData.partners.find(p => 
                    p.name === name || p.phone === phone
                );
                
                if (existingPartner) {
                    alert('شەریکێک بەم ناوە یان ژمارەیە هەیە!');
                    return;
                }
                
                const newPartner = {
                    id: sampleData.partners.length + 1,
                    name: name,
                    phone: phone,
                    address: document.getElementById('newPartnerAddress').value.trim() || '',
                    debt: 0
                };
                
                sampleData.partners.push(newPartner);
                
                // نوێکردنەوەی لیست
                populateSampleData();
                
                // گەڕانەوە بۆ لیست
                document.querySelector('.tab-btn[data-tab="partnersList"]').click();
                
                // پاککردنەوەی خانەکان
                document.getElementById('newPartnerName').value = '';
                document.getElementById('newPartnerPhone').value = '';
                document.getElementById('newPartnerAddress').value = '';
                
                alert('شەریکی نوێ بە سەرکەوتوویی زیاد کرا!');
            });
        }

        // پاشگەزبوونەوە لە زیادکردنی شەریک
        const cancelPartnerBtn = document.getElementById('cancelPartnerBtn');
        if (cancelPartnerBtn) {
            cancelPartnerBtn.addEventListener('click', function() {
                document.querySelector('.tab-btn[data-tab="partnersList"]').click();
                
                document.getElementById('newPartnerName').value = '';
                document.getElementById('newPartnerPhone').value = '';
                document.getElementById('newPartnerAddress').value = '';
            });
        }

        // نوێکردنەوەی کەسەکان
        const refreshCustomersBtn = document.getElementById('refreshCustomers');
        if (refreshCustomersBtn) {
            refreshCustomersBtn.addEventListener('click', function() {
                populateSampleData();
                alert('لیستی کەسەکان نوێ کرایەوە!');
            });
        }

        // نوێکردنەوەی شەریکەکان
        const refreshPartnersBtn = document.getElementById('refreshPartners');
        if (refreshPartnersBtn) {
            refreshPartnersBtn.addEventListener('click', function() {
                populateSampleData();
                alert('لیستی شەریکەکان نوێ کرایەوە!');
            });
        }

        // گەڕان لە کەسەکان (لە بەشی سەرەکی)
        const customerSearchMain = document.getElementById('customerSearchMain');
        if (customerSearchMain) {
            customerSearchMain.addEventListener('input', function() {
                const query = this.value.toLowerCase();
                const suggestions = document.getElementById('customerSearchSuggestions');
                
                if (!suggestions) return;
                
                if (query.length < 2) {
                    suggestions.style.display = 'none';
                    return;
                }
                
                const filteredCustomers = sampleData.customers.filter(c => 
                    c.name.toLowerCase().includes(query) || 
                    c.phone.includes(query)
                );
                
                suggestions.innerHTML = '';
                
                if (filteredCustomers.length === 0) {
                    suggestions.style.display = 'none';
                    return;
                }
                
                filteredCustomers.forEach(customer => {
                    const div = document.createElement('div');
                    div.className = 'suggestion-item';
                    div.textContent = `${customer.name} - ${customer.phone}`;
                    
                    div.addEventListener('click', function() {
                        viewCustomerDetails(customer.id);
                        customerSearchMain.value = '';
                        suggestions.style.display = 'none';
                    });
                    
                    suggestions.appendChild(div);
                });
                
                suggestions.style.display = 'block';
            });
        }

        // هەڵگرتنی گۆڕانکاریەکانی کەس
        const saveCustomerChangesBtn = document.getElementById('saveCustomerChanges');
        if (saveCustomerChangesBtn) {
            saveCustomerChangesBtn.addEventListener('click', function() {
                const customerName = document.getElementById('modalCustomerName').textContent;
                const customer = sampleData.customers.find(c => c.name === customerName);
                
                if (customer) {
                    customer.name = document.getElementById('editCustomerName').value;
                    customer.phone = document.getElementById('editCustomerPhone').value;
                    customer.address = document.getElementById('editCustomerAddress').value;
                    
                    // نوێکردنەوەی مێژووی فرۆشتن
                    sampleData.sales.forEach(sale => {
                        if (sale.customer === customerName) {
                            sale.customer = customer.name;
                        }
                    });
                    
                    populateSampleData();
                    alert('گۆڕانکاریەکان بە سەرکەوتوویی هەڵگیرا!');
                }
            });
        }

        // سڕینەوەی کەس
        const deleteCustomerBtn = document.getElementById('deleteCustomerBtn');
        if (deleteCustomerBtn) {
            deleteCustomerBtn.addEventListener('click', function() {
                const customerName = document.getElementById('modalCustomerName').textContent;
                
                if (confirm(`دڵنیای لە سڕینەوەی کەسی '${customerName}'؟`)) {
                    const customerIndex = sampleData.customers.findIndex(c => c.name === customerName);
                    
                    if (customerIndex !== -1) {
                        // پشکنین ئەگەر کەسەکە قەرزی هەیە
                        const customer = sampleData.customers[customerIndex];
                        if (customer.debt > 0) {
                            if (!confirm('ئەم کەسە قەرزی هەیە! دڵنیای لە سڕینەوە؟')) {
                                return;
                            }
                        }
                        
                        sampleData.customers.splice(customerIndex, 1);
                        
                        // سڕینەوەی فاکتوورەکانی کەسەکە
                        sampleData.sales = sampleData.sales.filter(s => s.customer !== customerName);
                        
                        document.getElementById('customerModal').classList.remove('active');
                        populateSampleData();
                        alert('کەسەکە بە سەرکەوتوویی سڕایەوە!');
                    }
                }
            });
        }

        // زیادکردنی کەس لە لیستەکە
        const addCustomerBtn = document.getElementById('addCustomerBtn');
        if (addCustomerBtn) {
            addCustomerBtn.addEventListener('click', function() {
                document.querySelector('.tab-btn[data-tab="addCustomer"]').click();
            });
        }

        // زیادکردنی شەریک لە لیستەکە
        const addPartnerBtn = document.getElementById('addPartnerBtn');
        if (addPartnerBtn) {
            addPartnerBtn.addEventListener('click', function() {
                document.querySelector('.tab-btn[data-tab="addPartner"]').click();
            });
        }

        // ==============================================
        // بەشی کڕین - فەنکشنە نوێیەکان
        // ==============================================

        // گەڕان بۆ کاڵا لە بەشی کڕین
        const purchaseProductSearch = document.getElementById('purchaseProductSearch');
        if (purchaseProductSearch) {
            purchaseProductSearch.addEventListener('input', function() {
                const query = this.value.toLowerCase();
                const suggestions = document.getElementById('purchaseProductSuggestions');
                
                if (!suggestions) return;
                
                if (query.length < 2) {
                    suggestions.style.display = 'none';
                    return;
                }
                
                const filteredProducts = sampleData.products.filter(p => 
                    p.name.toLowerCase().includes(query) || 
                    p.barcode.includes(query)
                );
                
                suggestions.innerHTML = '';
                
                if (filteredProducts.length === 0) {
                    suggestions.style.display = 'none';
                    return;
                }
                
                filteredProducts.forEach(product => {
                    const div = document.createElement('div');
                    div.className = 'suggestion-item';
                    div.innerHTML = `
                        <div><strong>${product.name}</strong></div>
                        <div style="font-size: 0.9rem;">بارکۆد: ${product.barcode}</div>
                        <div style="font-size: 0.9rem;">نرخی کڕین: ${product.purchasePrice.toLocaleString()} دینار</div>
                        <div style="font-size: 0.9rem;">نرخی فرۆشتن: ${product.salePrice.toLocaleString()} دینار</div>
                    `;
                    
                    div.addEventListener('click', function() {
                        showAddToPurchaseModal(product);
                        purchaseProductSearch.value = '';
                        suggestions.style.display = 'none';
                    });
                    
                    suggestions.appendChild(div);
                });
                
                suggestions.style.display = 'block';
            });
        }

        // مۆدال بۆ زیادکردنی کاڵا بۆ سەبەتەی کڕین
        window.showAddToPurchaseModal = function(product) {
            // چەک کردنی ئەگەر مۆدالێکی پێشوو هەبێت
            const existingModal = document.getElementById('addToPurchaseModal');
            if (existingModal) {
                existingModal.remove();
            }
            
            const modalHTML = `
                <div class="modal active" id="addToPurchaseModal">
                    <div class="modal-content" style="max-width: 500px;">
                        <div class="modal-header">
                            <h3>زیادکردنی کاڵا: ${product.name}</h3>
                            <button class="modal-close" onclick="document.getElementById('addToPurchaseModal').remove()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="modal-body">
                            <div class="form-group">
                                <label>نرخی کڕین (کۆن)</label>
                                <input type="number" id="oldPurchasePrice" value="${product.purchasePrice}" readonly style="background-color: var(--gray-light);">
                            </div>
                            
                            <div class="form-group">
                                <label>نرخی کڕینی نوێ</label>
                                <input type="number" id="newPurchasePrice" value="${product.purchasePrice}" placeholder="نرخی کڕینی نوێ">
                            </div>
                            
                            <div class="form-group">
                                <label>نرخی فرۆشتن (کۆن)</label>
                                <input type="number" id="oldSalePrice" value="${product.salePrice}" readonly style="background-color: var(--gray-light);">
                            </div>
                            
                            <div class="form-group">
                                <label>نرخی فرۆشتنی نوێ</label>
                                <input type="number" id="newSalePrice" value="${product.salePrice}" placeholder="نرخی فرۆشتنی نوێ">
                            </div>
                            
                            <div class="form-group">
                                <label>بڕی کڕین</label>
                                <input type="number" id="purchaseQuantity" value="1" min="1" placeholder="بڕ">
                            </div>
                            
                            <div class="form-group">
                                <label>یەکە</label>
                                <select id="purchaseUnit">
                                    <option value="piece" ${product.unit === 'piece' ? 'selected' : ''}>پارچە</option>
                                    <option value="carton" ${product.unit === 'carton' ? 'selected' : ''}>کارتۆن</option>
                                    <option value="unit" ${product.unit === 'unit' ? 'selected' : ''}>دانە</option>
                                </select>
                            </div>
                            
                            <div class="action-buttons">
                                <button class="btn btn-danger" onclick="document.getElementById('addToPurchaseModal').remove()">
                                    پاشگەزبوونەوە
                                </button>
                                <button class="btn btn-success" onclick="addToPurchaseCart(${product.id})">
                                    زیادکردن بۆ سەبەتە
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        };

        // زیادکردنی کاڵا بۆ سەبەتەی کڕین
        window.addToPurchaseCart = function(productId) {
            const product = sampleData.products.find(p => p.id === productId);
            if (!product) return;
            
            const newPurchasePrice = parseInt(document.getElementById('newPurchasePrice').value) || product.purchasePrice;
            const newSalePrice = parseInt(document.getElementById('newSalePrice').value) || product.salePrice;
            const quantity = parseInt(document.getElementById('purchaseQuantity').value) || 1;
            const unit = document.getElementById('purchaseUnit').value;
            
            const purchaseCartItem = {
                id: product.id,
                name: product.name,
                oldPurchasePrice: product.purchasePrice,
                newPurchasePrice: newPurchasePrice,
                oldSalePrice: product.salePrice,
                newSalePrice: newSalePrice,
                quantity: quantity,
                unit: unit,
                total: newPurchasePrice * quantity
            };
            
            // زیادکردنی بۆ سەبەتەی کڕین
            purchaseCart.push(purchaseCartItem);
            updatePurchaseCartDisplay();
            
            document.getElementById('addToPurchaseModal').remove();
        };

        // نوێکردنەوەی سەبەتەی کڕین
        function updatePurchaseCartDisplay() {
            const purchaseCartItems = document.getElementById('purchaseCartItems');
            if (!purchaseCartItems) return;
            
            purchaseCartItems.innerHTML = '';
            
            if (purchaseCart.length === 0) {
                purchaseCartItems.innerHTML = '<li class="empty-cart">هیچ کاڵایەک لە سەبەتەدا نییە</li>';
                return;
            }
            
            let total = 0;
            
            purchaseCart.forEach((item, index) => {
                const li = document.createElement('li');
                li.className = 'cart-item';
                
                const itemTotal = item.newPurchasePrice * item.quantity;
                total += itemTotal;
                
                li.innerHTML = `
                    <div class="cart-item-info">
                        <div class="cart-item-image">
                            <i class="fas fa-${getProductIcon(item.name)}"></i>
                        </div>
                        <div>
                            <div class="item-name">${item.name}</div>
                            <div style="font-size: 0.9rem; color: var(--gray);">
                                ${item.quantity} ${item.unit === 'piece' ? 'پارچە' : item.unit === 'carton' ? 'کارتۆن' : 'دانە'}
                            </div>
                            <div style="font-size: 0.9rem; color: var(--info);">
                                نرخ: ${item.newPurchasePrice.toLocaleString()} دینار (کۆن: ${item.oldPurchasePrice.toLocaleString()})
                            </div>
                        </div>
                    </div>
                    <div>
                        <div class="item-value">${itemTotal.toLocaleString()} دینار</div>
                        <div style="margin-top: 10px;">
                            <button class="btn btn-danger" style="padding: 5px 10px; font-size: 0.8rem;" onclick="removeFromPurchaseCart(${index})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
                
                purchaseCartItems.appendChild(li);
            });
        };

        // سڕینەوە لە سەبەتەی کڕین
        window.removeFromPurchaseCart = function(index) {
            purchaseCart.splice(index, 1);
            updatePurchaseCartDisplay();
        };

        // سڕینەوەی سەبەتەی کڕین
        const clearPurchaseCartBtn = document.getElementById('clearPurchaseCart');
        if (clearPurchaseCartBtn) {
            clearPurchaseCartBtn.addEventListener('click', function() {
                purchaseCart = [];
                updatePurchaseCartDisplay();
            });
        }

        // هەڵبژاردنی جۆری پارەدان لە کڕین
        document.querySelectorAll('#newPurchase .payment-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('#newPurchase .payment-option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                
                this.classList.add('selected');
                const paymentType = this.getAttribute('data-payment');
                
                const partnerSelection = document.getElementById('partnerSelection');
                if (partnerSelection) {
                    if (paymentType === 'credit') {
                        partnerSelection.style.display = 'block';
                    } else {
                        partnerSelection.style.display = 'none';
                    }
                }
            });
        });

        // گەڕان بەدوای شەریکەکان لە کڕین
        const partnerSearchPurchase = document.getElementById('partnerSearchPurchase');
        if (partnerSearchPurchase) {
            partnerSearchPurchase.addEventListener('input', function() {
                const query = this.value.toLowerCase();
                const suggestions = document.getElementById('partnerSuggestionsPurchase');
                
                if (!suggestions) return;
                
                if (query.length < 2) {
                    suggestions.style.display = 'none';
                    return;
                }
                
                const filteredPartners = sampleData.partners.filter(p => 
                    p.name.toLowerCase().includes(query)
                );
                
                suggestions.innerHTML = '';
                
                if (filteredPartners.length === 0) {
                    suggestions.style.display = 'none';
                    return;
                }
                
                filteredPartners.forEach(partner => {
                    // دیاریکردنی رەنگ بەپێی جۆری قەرز
                    let debtText, debtClass;
                    
                    if (partner.debt > 0) {
                        debtText = partner.debt.toLocaleString() + ' دینار (شەریک قەرزداری منە)';
                        debtClass = 'debt-positive';
                    } else if (partner.debt < 0) {
                        debtText = Math.abs(partner.debt).toLocaleString() + ' دینار (من قەرزداری ئەوانم)';
                        debtClass = 'debt-negative';
                    } else {
                        debtText = 'بێ قەرز';
                        debtClass = 'debt-zero';
                    }
                    
                    const div = document.createElement('div');
                    div.className = 'suggestion-item';
                    div.innerHTML = `
                        <div><strong>${partner.name}</strong></div>
                        <div style="font-size: 0.9rem; color: var(--gray);">
                            <span class="${debtClass}">${debtText}</span>
                        </div>
                    `;
                    
                    div.addEventListener('click', function() {
                        partnerSearchPurchase.value = partner.name;
                        suggestions.style.display = 'none';
                    });
                    
                    suggestions.appendChild(div);
                });
                
                suggestions.style.display = 'block';
            });
        }

        // تەواوکردنی کڕین (چاکسازیکراو)
        const completePurchaseBtn = document.getElementById('completePurchase');
        if (completePurchaseBtn) {
            completePurchaseBtn.addEventListener('click', function() {
                if (purchaseCart.length === 0) {
                    alert('تکایە یەکێک لە کاڵاکان زیاد بکە بۆ سەبەتە!');
                    return;
                }
                
                const paymentType = document.querySelector('#newPurchase .payment-option.selected')?.getAttribute('data-payment') || 'cash';
                
                let selectedPartner = null;
                if (paymentType === 'credit') {
                    const partnerName = document.getElementById('partnerSearchPurchase')?.value;
                    if (!partnerName) {
                        alert('تکایە شەریکێک هەڵبژێرە بۆ کڕین بە قەرز!');
                        return;
                    }
                    selectedPartner = sampleData.partners.find(p => p.name === partnerName);
                }
                
                const total = purchaseCart.reduce((sum, item) => sum + (item.newPurchasePrice * item.quantity), 0);
                
                // زیادکردنی بۆ مێژووی کڕین
                const newPurchase = {
                    id: samplePurchaseData.purchases.length + 1,
                    code: `PUR-${new Date().getFullYear()}-${samplePurchaseData.purchases.length + 1}`,
                    partner: selectedPartner ? selectedPartner.name : 'نەقدی',
                    date: new Date().toISOString().split('T')[0],
                    total: total,
                    payment: paymentType,
                    items: purchaseCart.map(item => ({name: item.name, quantity: item.quantity, price: item.newPurchasePrice}))
                };
                
                samplePurchaseData.purchases.unshift(newPurchase);
                
                // ئەگەر کڕین بە نەقدی بوو، پارە کەم بکە
                if (paymentType === 'cash') {
                    if (sampleData.cashBalance < total) {
                        alert(`کۆی پارەی واسڵ کراو بەس نییە! کۆی پارە: ${sampleData.cashBalance.toLocaleString()} دینار، کڕین: ${total.toLocaleString()} دینار`);
                        return;
                    }
                    sampleData.cashBalance -= total;
                    updateDashboardCash();
                    alert(`کڕینەکە بە نەقدی تەواو بوو! ${total.toLocaleString()} دینار لە کۆی پارەی واسڵ کراو کەم کرا.`);
                } else if (paymentType === 'credit' && selectedPartner) {
                    // ✅ **چاکسازی بەپێی حاڵەت:**
                    if (selectedPartner.debt <= 0) {
                        // ئەگەر من قەرزداری شەریکم یان بێ قەرز
                        selectedPartner.debt -= total; // -100,000 - 50,000 = -150,000 ✅
                    } else {
                        // ئەگەر شەریک قەرزداری منە
                        selectedPartner.debt += total; // 30,000 + 50,000 = 80,000 ✅
                    }
                }
                
                // زیادکردنی کاڵاکان بۆ مخزن و نوێکردنەوەی نرخەکان
                purchaseCart.forEach(item => {
                    const product = sampleData.products.find(p => p.id === item.id);
                    if (product) {
                        product.stock += item.quantity;
                        product.purchasePrice = item.newPurchasePrice;
                        product.salePrice = item.newSalePrice;
                    }
                });
                
                // پاککردنەوەی سەبەتە
                purchaseCart = [];
                updatePurchaseCartDisplay();
                
                // پاککردنەوەی خانەکان
                if (document.getElementById('partnerSearchPurchase')) {
                    document.getElementById('partnerSearchPurchase').value = '';
                }
                
                // نوێکردنەوەی داتا
                populateSampleData();
                updatePurchaseHistoryDisplay();
                
                alert('کڕینەکە بە سەرکەوتوویی تەواو بوو!');
            });
        }

        // نوێکردنەوەی مێژووی کڕین
        function updatePurchaseHistoryDisplay() {
            const purchaseHistoryList = document.getElementById('purchaseHistoryList');
            if (!purchaseHistoryList) return;
            
            purchaseHistoryList.innerHTML = '';
            
            samplePurchaseData.purchases.forEach(purchase => {
                const li = document.createElement('li');
                li.className = 'list-item';
                li.setAttribute('data-purchase-id', purchase.id);
                li.innerHTML = `
                    <div>
                        <div class="item-name">${purchase.code} - ${purchase.partner}</div>
                        <div style="font-size: 0.9rem; color: var(--gray);">
                            ${purchase.date} - ${purchase.payment === 'cash' ? 'نەقدی' : 'قەرز'}
                        </div>
                        <div style="font-size: 0.9rem; color: var(--info);">
                            ${purchase.items.length} کاڵا
                        </div>
                    </div>
                    <div>
                        <div class="item-value">${purchase.total.toLocaleString()} دینار</div>
                        <div style="margin-top: 10px; display: flex; gap: 5px;">
                            <button class="btn btn-info btn-sm" onclick="viewPurchaseDetails(${purchase.id})">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-danger btn-sm" onclick="deletePurchase(${purchase.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
                purchaseHistoryList.appendChild(li);
            });
        }

        // بینینی وردەکارییەکانی کڕین
        window.viewPurchaseDetails = function(purchaseId) {
            const purchase = samplePurchaseData.purchases.find(p => p.id === purchaseId);
            if (!purchase) return;
            
            // چەک کردنی ئەگەر مۆدالێکی پێشوو هەبێت
            const existingModal = document.getElementById('purchaseDetailModal');
            if (existingModal) {
                existingModal.remove();
            }
            
            const modalHTML = `
                <div class="modal active" id="purchaseDetailModal">
                    <div class="modal-content" style="max-width: 800px;">
                        <div class="modal-header">
                            <h3>فاکتووری کڕین: ${purchase.code}</h3>
                            <button class="modal-close" onclick="document.getElementById('purchaseDetailModal').remove()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="modal-body">
                            <div class="invoice">
                                <div class="invoice-header">
                                    <div class="invoice-logo">الکترۆنیات</div>
                                    <h2>فاکتووری کڕین</h2>
                                    <p>کۆدی فاکتوورە: ${purchase.code}</p>
                                    <p>بەروار: ${purchase.date}</p>
                                </div>
                                
                                <div class="invoice-details">
                                    <div>
                                        <h4>زانیاری فرۆشەر:</h4>
                                        <p>ناوی سیستەم: الکترۆنیات</p>
                                    </div>
                                    
                                    <div>
                                        <h4>زانیاری شەریک:</h4>
                                        <p>ناوی شەریک: ${purchase.partner}</p>
                                    </div>
                                </div>
                                
                                <table class="invoice-table">
                                    <thead>
                                        <tr>
                                            <th>#</th>
                                            <th>ناوی کاڵا</th>
                                            <th>بڕ</th>
                                            <th>نرخی کڕین</th>
                                            <th>کۆی گشتی</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${purchase.items.map((item, index) => {
                                            return `
                                                <tr>
                                                    <td>${index + 1}</td>
                                                    <td>${item.name}</td>
                                                    <td>${item.quantity}</td>
                                                    <td>${item.price.toLocaleString()} دینار</td>
                                                    <td>${(item.price * item.quantity).toLocaleString()} دینار</td>
                                                </tr>
                                            `;
                                        }).join('')}
                                    </tbody>
                                </table>
                                
                                <div class="invoice-total">
                                    <p><strong>کۆی گشتی:</strong> ${purchase.total.toLocaleString()} دینار</p>
                                    <p><strong>شێوازی پارەدان:</strong> ${purchase.payment === 'cash' ? 'نەقدی' : 'قەرز'}</p>
                                </div>
                            </div>
                            
                            <div class="print-options" style="margin-top: 30px;">
                                <button class="btn btn-warning" onclick="printPurchase(${purchase.id})">
                                    <i class="fas fa-print"></i> پرێنت کردن
                                </button>
                                <button class="btn btn-danger" onclick="document.getElementById('purchaseDetailModal').remove()">
                                    <i class="fas fa-times"></i> داخستن
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        };

        // سڕینەوەی کڕین (چاکسازیکراو)
        window.deletePurchase = function(purchaseId) {
            if (confirm('دڵنیای لە سڕینەوەی ئەم فاکتوورەی کڕین؟')) {
                const index = samplePurchaseData.purchases.findIndex(p => p.id === purchaseId);
                if (index !== -1) {
                    const purchase = samplePurchaseData.purchases[index];
                    
                    // گەڕاندنەوەی پارە ئەگەر کڕین بە نەقدی بوو
                    if (purchase.payment === 'cash') {
                        sampleData.cashBalance += purchase.total;
                        updateDashboardCash();
                    } else if (purchase.payment === 'credit') {
                        const partner = sampleData.partners.find(p => p.name === purchase.partner);
                        if (partner) {
                            // ✅ **چاکسازی: گەڕاندنەوەی قەرز بەپێی حاڵەت**
                            if (partner.debt <= 0) {
                                // من قەرزداری شەریکم، قەرزی زیاد دەبێت
                                partner.debt += purchase.total;
                            } else {
                                // شەریک قەرزداری منە، قەرزی کەم دەبێت
                                partner.debt -= purchase.total;
                            }
                        }
                    }
                    
                    samplePurchaseData.purchases.splice(index, 1);
                    updatePurchaseHistoryDisplay();
                    populateSampleData();
                    alert('فاکتووری کڕین بە سەرکەوتوویی سڕایەوە!');
                }
            }
        };

        // پرێنتکردنی کڕین
        window.printPurchase = function(purchaseId) {
            alert('پرێنتی فاکتووری کڕین ئامادەکرا (لە وەشانی راستەقینەدا پرێنت دەکرێت)');
        };

        // نوێکردنەوەی مێژووی کڕین
        const refreshPurchaseHistoryBtn = document.getElementById('refreshPurchaseHistory');
        if (refreshPurchaseHistoryBtn) {
            refreshPurchaseHistoryBtn.addEventListener('click', function() {
                updatePurchaseHistoryDisplay();
                alert('مێژووی کڕین نوێ کرایەوە!');
            });
        }

        // ==============================================
        // بەشی پارەواسڵکردن - فەنکشنە نوێیەکان
        // ==============================================

        // گەڕان بەدوای قەرزدارەکان
        const debtorSearch = document.getElementById('debtorSearch');
        if (debtorSearch) {
            debtorSearch.addEventListener('input', function() {
                const query = this.value.toLowerCase();
                const suggestions = document.getElementById('debtorSuggestions');
                
                if (!suggestions) return;
                
                if (query.length < 2) {
                    suggestions.style.display = 'none';
                    return;
                }
                
                // گەڕان لە کەسەکان و شەریکەکان
                const filteredDebtors = [
                    // کەسەکان کە قەرزداری منن (قەرز +)
                    ...sampleData.customers.filter(c => 
                        c.name.toLowerCase().includes(query) && c.debt > 0
                    ).map(c => ({
                        id: c.id,
                        name: c.name,
                        debt: c.debt,
                        type: 'customer',
                        debtClass: 'debt-positive',
                        text: `${c.name} - ${c.debt.toLocaleString()} دینار قەرز (کەس قەرزداری منە)`
                    })),
                    // شەریکەکان کە من قەرزداری ئەوانم (قەرز -)
                    ...sampleData.partners.filter(p => 
                        p.name.toLowerCase().includes(query) && p.debt < 0
                    ).map(p => ({
                        id: p.id,
                        name: p.name,
                        debt: Math.abs(p.debt),
                        type: 'partner',
                        debtClass: 'debt-negative',
                        text: `${p.name} - ${Math.abs(p.debt).toLocaleString()} دینار قەرز (من قەرزداری ئەوانم)`
                    }))
                ];
                
                suggestions.innerHTML = '';
                
                if (filteredDebtors.length === 0) {
                    suggestions.style.display = 'none';
                    document.getElementById('debtorInfo').style.display = 'none';
                    return;
                }
                
                filteredDebtors.forEach(debtor => {
                    const div = document.createElement('div');
                    div.className = 'suggestion-item';
                    div.innerHTML = `
                        <div><strong>${debtor.name}</strong></div>
                        <div style="font-size: 0.9rem; color: var(--gray);">
                            <span class="${debtor.debtClass}">${debtor.text}</span>
                        </div>
                    `;
                    
                    div.setAttribute('data-debtor-id', debtor.id);
                    div.setAttribute('data-debtor-type', debtor.type);
                    
                    div.addEventListener('click', function() {
                        const debtorId = parseInt(this.getAttribute('data-debtor-id'));
                        const debtorType = this.getAttribute('data-debtor-type');
                        loadDebtorInfo(debtorId, debtorType);
                        debtorSearch.value = debtor.name;
                        suggestions.style.display = 'none';
                    });
                    
                    suggestions.appendChild(div);
                });
                
                suggestions.style.display = 'block';
            });
        }

        // بارکردنی زانیاری قەرزدار
        function loadDebtorInfo(debtorId, debtorType) {
            let debtor;
            if (debtorType === 'customer') {
                debtor = sampleData.customers.find(c => c.id === debtorId);
            } else {
                debtor = sampleData.partners.find(p => p.id === debtorId);
            }
            
            if (!debtor) return;
            
            document.getElementById('debtorName').textContent = debtor.name;
            
            // بەپێی جۆری قەرزدار، قەرز نیشان بدە
            if (debtorType === 'customer') {
                // کەس قەرزداری منە (قەرز +)
                document.getElementById('totalDebtAmount').textContent = debtor.debt.toLocaleString() + ' دینار (کەس قەرزداری منە)';
            } else {
                // من قەرزداری شەریکم (قەرز -)
                document.getElementById('totalDebtAmount').textContent = Math.abs(debtor.debt).toLocaleString() + ' دینار (من قەرزداری ئەوانم)';
            }
            
            // دۆزینەوەی پارەی واسڵ کراو
            const totalPaid = sampleData.paymentHistory
                .filter(p => p.debtorId === debtorId && p.debtorType === debtorType)
                .reduce((sum, payment) => sum + payment.amount, 0);
            
            document.getElementById('totalPaidAmount').textContent = totalPaid.toLocaleString();
            document.getElementById('debtorInfo').style.display = 'block';
            document.getElementById('debtorInfo').setAttribute('data-debtor-id', debtorId);
            document.getElementById('debtorInfo').setAttribute('data-debtor-type', debtorType);
        }

        // تۆمارکردنی پارەواسڵکردن (چاکسازیکراو)
        const submitPaymentBtn = document.getElementById('submitPaymentBtn');
        if (submitPaymentBtn) {
            submitPaymentBtn.addEventListener('click', function() {
                const debtorId = parseInt(document.getElementById('debtorInfo').getAttribute('data-debtor-id'));
                const debtorType = document.getElementById('debtorInfo').getAttribute('data-debtor-type');
                const amount = parseInt(document.getElementById('paymentAmountInput').value);
                const date = document.getElementById('paymentDateInput').value;
                const method = document.getElementById('paymentMethodSelect').value;
                const notes = document.getElementById('paymentNotesInput').value;
                
                if (!debtorId || !amount || amount <= 0) {
                    alert('تکایە بڕی پارە پڕ بکەرەوە!');
                    return;
                }
                
                let debtor;
                if (debtorType === 'customer') {
                    debtor = sampleData.customers.find(c => c.id === debtorId);
                } else {
                    debtor = sampleData.partners.find(p => p.id === debtorId);
                }
                
                if (!debtor) {
                    alert('قەرزدار نەدۆزرایەوە!');
                    return;
                }
                
                // پشکنین بۆ بڕی قەرز بەپێی جۆری قەرزدار
                if (debtorType === 'customer') {
                    // کەس قەرزداری منە، قەرزی ئەرێنیە
                    if (amount > debtor.debt) {
                        alert(`بڕی پارەواسڵکردن نابێت لە قەرز زیاتر بێت! قەرزی ئێستا: ${debtor.debt.toLocaleString()} دینار`);
                        return;
                    }
                    // کەمکردنەوەی قەرز (داین)
                    debtor.debt -= amount;
                } else {
                    // من قەرزداری شەریکم، قەرزی نەرێنیە
                    const absDebt = Math.abs(debtor.debt);
                    if (amount > absDebt) {
                        alert(`بڕی پارەواسڵکردن نابێت لە قەرز زیاتر بێت! قەرزی ئێستا: ${absDebt.toLocaleString()} دینار`);
                        return;
                    }
                    // ✅ **چاکسازی بەپێی حاڵەت:**
                    if (debtor.debt < 0) {
                        // من قەرزداری شەریکم: قەرزم کەم دەبێت
                        debtor.debt += amount; // -100,000 + 30,000 = -70,000 ✅
                    } else if (debtor.debt === 0) {
                        // بێ قەرز: پارەواسڵکردن بۆ شەریک بێ مانایە
                        alert('شەریکەکە قەرزی نییە!');
                        return;
                    } else {
                        // شەریک قەرزداری منە: قەرزی کەم دەبێت
                        debtor.debt -= amount; // 50,000 - 30,000 = 20,000 ✅
                    }
                }
                
                // زیادکردنی پارە بۆ کۆی پارەی نەقدی
                sampleData.cashBalance += amount;
                
                // تۆمارکردنی لە مێژوو
                const newPayment = {
                    id: sampleData.paymentHistory.length + 1,
                    debtorId: debtorId,
                    debtorType: debtorType,
                    debtorName: debtor.name,
                    amount: amount,
                    date: date,
                    method: method,
                    notes: notes,
                    timestamp: new Date().toISOString()
                };
                
                sampleData.paymentHistory.unshift(newPayment);
                
                // نوێکردنەوەی داشبۆرد
                updateDashboardCash();
                
                // پاککردنەوەی خانەکان
                document.getElementById('paymentAmountInput').value = '';
                document.getElementById('paymentNotesInput').value = '';
                
                // نوێکردنەوەی زانیاری قەرزدار
                loadDebtorInfo(debtorId, debtorType);
                
                // نوێکردنەوەی داشبۆرد
                populateSampleData();
                
                // نوێکردنەوەی مێژووی پارەواسڵکردن
                updatePaymentHistoryDisplay();
                
                alert(`پارەواسڵکردنەکە بە سەرکەوتوویی تۆمارکرا! ${amount.toLocaleString()} دینار`);
            });
        }

        // نوێکردنەوەی مێژووی پارەواسڵکردن
        function updatePaymentHistoryDisplay() {
            const paymentHistoryList = document.getElementById('paymentHistoryList');
            if (!paymentHistoryList) return;
            
            paymentHistoryList.innerHTML = '';
            
            if (sampleData.paymentHistory.length === 0) {
                paymentHistoryList.innerHTML = '<li class="list-item">هیچ مێژوویەکی پارەواسڵکردن نییە</li>';
                return;
            }
            
            sampleData.paymentHistory.forEach(payment => {
                const li = document.createElement('li');
                li.className = 'list-item';
                
                // دیاریکردنی جۆری قەرزدار بۆ رەنگ
                let debtorType = 'unknown';
                let debtor = null;
                
                if (payment.debtorType === 'customer') {
                    debtor = sampleData.customers.find(c => c.id === payment.debtorId);
                    debtorType = 'customer';
                } else if (payment.debtorType === 'partner') {
                    debtor = sampleData.partners.find(p => p.id === payment.debtorId);
                    debtorType = 'partner';
                }
                
                let description = payment.debtorName;
                if (debtor) {
                    if (debtorType === 'partner') {
                        if (debtor.debt > 0) {
                            description += ' (شەریک قەرزداری منە)';
                        } else if (debtor.debt < 0) {
                            description += ' (من قەرزداری ئەوانم)';
                        }
                    }
                }
                
                li.innerHTML = `
                    <div>
                        <div class="item-name">${description}</div>
                        <div style="font-size: 0.9rem; color: var(--gray);">
                            ${payment.date} - ${payment.method === 'cash' ? 'نەقدی' : payment.method === 'transfer' ? 'گوازینەوە' : 'چەک'}
                        </div>
                        <div style="font-size: 0.9rem; color: var(--info);">
                            ${payment.notes || 'بێ تێبینی'}
                        </div>
                    </div>
                    <div>
                        <div class="item-value debt-payment">${payment.amount.toLocaleString()} دینار</div>
                        <div style="margin-top: 10px;">
                            <button class="btn btn-danger btn-sm" onclick="deletePayment(${payment.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
                paymentHistoryList.appendChild(li);
            });
        }

        // سڕینەوەی پارەواسڵکردن
        window.deletePayment = function(paymentId) {
            if (confirm('دڵنیای لە سڕینەوەی ئەم پارەواسڵکردنە؟')) {
                const paymentIndex = sampleData.paymentHistory.findIndex(p => p.id === paymentId);
                if (paymentIndex !== -1) {
                    const payment = sampleData.paymentHistory[paymentIndex];
                    
                    // گەڕاندنەوەی قەرز
                    let debtor;
                    if (payment.debtorType === 'customer') {
                        debtor = sampleData.customers.find(c => c.id === payment.debtorId);
                        if (debtor) {
                            // کەس قەرزداری منە، قەرزی زیاد دەبێت
                            debtor.debt += payment.amount;
                        }
                    } else {
                        debtor = sampleData.partners.find(p => p.id === payment.debtorId);
                        if (debtor) {
                            // گەڕاندنەوەی قەرز بەپێی حاڵەت
                            if (debtor.debt < 0) {
                                // من قەرزداری شەریکم، قەرزی زیاد دەبێت
                                debtor.debt -= payment.amount;
                            } else {
                                // شەریک قەرزداری منە، قەرزی زیاد دەبێت
                                debtor.debt += payment.amount;
                            }
                        }
                    }
                    
                    // کەمکردنەوەی پارە لە کۆی نەقدی
                    sampleData.cashBalance -= payment.amount;
                    
                    // سڕینەوە لە مێژوو
                    sampleData.paymentHistory.splice(paymentIndex, 1);
                    
                    // نوێکردنەوەی داشبۆرد
                    updateDashboardCash();
                    populateSampleData();
                    updatePaymentHistoryDisplay();
                    
                    alert('پارەواسڵکردنەکە بە سەرکەوتوویی سڕایەوە!');
                }
            }
        };

        // نوێکردنەوەی مێژووی پارەواسڵکردن
        const refreshPaymentHistoryBtn = document.getElementById('refreshPaymentHistory');
        if (refreshPaymentHistoryBtn) {
            refreshPaymentHistoryBtn.addEventListener('click', function() {
                updatePaymentHistoryDisplay();
                alert('مێژووی پارەواسڵکردن نوێ کرایەوە!');
            });
        }

        // گەڕان لە مێژووی پارەواسڵکردن
        const paymentHistorySearch = document.getElementById('paymentHistorySearch');
        if (paymentHistorySearch) {
            paymentHistorySearch.addEventListener('input', function() {
                const query = this.value.toLowerCase();
                const items = document.querySelectorAll('#paymentHistoryList .list-item');
                
                items.forEach(item => {
                    const text = item.textContent.toLowerCase();
                    if (text.includes(query)) {
                        item.style.display = 'flex';
                    } else {
                        item.style.display = 'none';
                    }
                });
            });
        }

        // ==============================================
        // بەشی سەرفکردن - فەنکشنە نوێیەکان
        // ==============================================

        // دەستنیشانکردنی جۆری سەرفکردن
        const expenseTypeSelect = document.getElementById('expenseType');
        if (expenseTypeSelect) {
            expenseTypeSelect.addEventListener('change', function() {
                const type = this.value;
                
                // هەموو بەشەکان شاردراوە بکە
                document.getElementById('expensePartnerSection').style.display = 'none';
                document.getElementById('expenseCustomerSection').style.display = 'none';
                document.getElementById('expenseOtherSection').style.display = 'none';
                
                // پاککردنەوەی هەڵبژاردنەکان
                document.getElementById('expensePartnerSearch').value = '';
                document.getElementById('expenseCustomerSearch').value = '';
                document.getElementById('selectedPartnerInfo').style.display = 'none';
                document.getElementById('selectedCustomerInfo').style.display = 'none';
                
                // نیشاندانی بەشی هەڵبژێردراو
                if (type === 'partner') {
                    document.getElementById('expensePartnerSection').style.display = 'block';
                } else if (type === 'customer') {
                    document.getElementById('expenseCustomerSection').style.display = 'block';
                } else if (type === 'other') {
                    document.getElementById('expenseOtherSection').style.display = 'block';
                }
            });
        }

        // گەڕان بەدوای شەریکەکان بۆ سەرفکردن
        const expensePartnerSearch = document.getElementById('expensePartnerSearch');
        if (expensePartnerSearch) {
            expensePartnerSearch.addEventListener('input', function() {
                const query = this.value.toLowerCase();
                const suggestions = document.getElementById('expensePartnerSuggestions');
                
                if (!suggestions) return;
                
                if (query.length < 2) {
                    suggestions.style.display = 'none';
                    document.getElementById('selectedPartnerInfo').style.display = 'none';
                    return;
                }
                
                const filteredPartners = sampleData.partners.filter(p => 
                    p.name.toLowerCase().includes(query)
                );
                
                suggestions.innerHTML = '';
                
                if (filteredPartners.length === 0) {
                    suggestions.style.display = 'none';
                    document.getElementById('selectedPartnerInfo').style.display = 'none';
                    return;
                }
                
                filteredPartners.forEach(partner => {
                    // دیاریکردنی رەنگ بەپێی جۆری قەرز
                    let debtText, debtClass;
                    
                    if (partner.debt > 0) {
                        debtText = partner.debt.toLocaleString() + ' دینار (شەریک قەرزداری منە)';
                        debtClass = 'debt-positive';
                    } else if (partner.debt < 0) {
                        debtText = Math.abs(partner.debt).toLocaleString() + ' دینار (من قەرزداری ئەوانم)';
                        debtClass = 'debt-negative';
                    } else {
                        debtText = 'بێ قەرز';
                        debtClass = 'debt-zero';
                    }
                    
                    const div = document.createElement('div');
                    div.className = 'suggestion-item';
                    div.innerHTML = `
                        <div><strong>${partner.name}</strong></div>
                        <div style="font-size: 0.9rem; color: var(--gray);">
                            ${partner.phone} | <span class="${debtClass}">${debtText}</span>
                        </div>
                    `;
                    
                    div.addEventListener('click', function() {
                        document.getElementById('expensePartnerSearch').value = partner.name;
                        document.getElementById('selectedPartnerName').textContent = partner.name;
                        document.getElementById('selectedPartnerDebt').textContent = debtText;
                        document.getElementById('selectedPartnerInfo').style.display = 'block';
                        document.getElementById('selectedPartnerInfo').setAttribute('data-partner-id', partner.id);
                        suggestions.style.display = 'none';
                    });
                    
                    suggestions.appendChild(div);
                });
                
                suggestions.style.display = 'block';
            });
        }

        // گەڕان بەدوای کەسەکان بۆ سەرفکردن
        const expenseCustomerSearch = document.getElementById('expenseCustomerSearch');
        if (expenseCustomerSearch) {
            expenseCustomerSearch.addEventListener('input', function() {
                const query = this.value.toLowerCase();
                const suggestions = document.getElementById('expenseCustomerSuggestions');
                
                if (!suggestions) return;
                
                if (query.length < 2) {
                    suggestions.style.display = 'none';
                    document.getElementById('selectedCustomerInfo').style.display = 'none';
                    return;
                }
                
                const filteredCustomers = sampleData.customers.filter(c => 
                    c.name.toLowerCase().includes(query)
                );
                
                suggestions.innerHTML = '';
                
                if (filteredCustomers.length === 0) {
                    suggestions.style.display = 'none';
                    document.getElementById('selectedCustomerInfo').style.display = 'none';
                    return;
                }
                
                filteredCustomers.forEach(customer => {
                    const div = document.createElement('div');
                    div.className = 'suggestion-item';
                    div.innerHTML = `
                        <div><strong>${customer.name}</strong></div>
                        <div style="font-size: 0.9rem; color: var(--gray);">
                            ${customer.phone} | <span class="${customer.debt > 0 ? 'debt-positive' : 'debt-zero'}">${customer.debt > 0 ? customer.debt.toLocaleString() + ' دینار قەرز' : 'بێ قەرز'}</span>
                        </div>
                    `;
                    
                    div.addEventListener('click', function() {
                        document.getElementById('expenseCustomerSearch').value = customer.name;
                        document.getElementById('selectedCustomerName').textContent = customer.name;
                        document.getElementById('selectedCustomerDebt').textContent = customer.debt > 0 ? 
                            customer.debt.toLocaleString() + ' دینار قەرز' : 'بێ قەرز';
                        document.getElementById('selectedCustomerInfo').style.display = 'block';
                        document.getElementById('selectedCustomerInfo').setAttribute('data-customer-id', customer.id);
                        suggestions.style.display = 'none';
                    });
                    
                    suggestions.appendChild(div);
                });
                
                suggestions.style.display = 'block';
            });
        }

        // تۆمارکردنی سەرفکردن (چاکسازیکراو)
        const submitExpenseBtn = document.getElementById('submitExpenseBtn');
        if (submitExpenseBtn) {
            submitExpenseBtn.addEventListener('click', function() {
                const expenseType = document.getElementById('expenseType').value;
                const amount = parseInt(document.getElementById('expenseAmount').value);
                const date = document.getElementById('expenseDate').value;
                
                if (!amount || amount <= 0) {
                    alert('تکایە بڕی سەرفکردن پڕ بکەرەوە!');
                    return;
                }
                
                if (amount > sampleData.cashBalance) {
                    alert(`بڕی سەرفکردن نابێت لە کۆی پارەی واسڵ کراو زیاتر بێت! کۆی پارەی واسڵ کراو: ${sampleData.cashBalance.toLocaleString()} دینار`);
                    return;
                }
                
                let expenseData = {
                    id: sampleData.expenseHistory.length + 1,
                    type: expenseType,
                    amount: amount,
                    date: date,
                    timestamp: new Date().toISOString()
                };
                
                // بەپێی جۆری سەرفکردن، زانیاری زیاد بکە
                if (expenseType === 'partner') {
                    const partnerId = parseInt(document.getElementById('selectedPartnerInfo').getAttribute('data-partner-id'));
                    const partnerSearch = document.getElementById('expensePartnerSearch').value;
                    
                    if (!partnerSearch) {
                        alert('تکایە شەریکێک هەڵبژێرە!');
                        return;
                    }
                    
                    const partner = sampleData.partners.find(p => p.id === partnerId);
                    if (!partner) {
                        alert('شەریکەکە نەدۆزرایەوە!');
                        return;
                    }
                    
                    expenseData.partnerId = partnerId;
                    expenseData.partnerName = partner.name;
                    expenseData.description = `سەرفکردن بۆ شەریک: ${partner.name}`;
                    
                    // ✅ **چاکسازی بەپێی حاڵەت:**
                    if (partner.debt < 0) {
                        // من قەرزداری شەریکم، قەرزی کەم دەبێت
                        partner.debt += amount; // -100,000 + 20,000 = -80,000 ✅
                    } else if (partner.debt === 0) {
                        // بێ قەرز، شەریک قەرزداری من دەبێت
                        partner.debt = amount; // 0 -> 20,000 ✅
                    } else {
                        // شەریک قەرزداری منە، قەرزی زیاد دەکات
                        partner.debt += amount; // 30,000 + 20,000 = 50,000 ✅
                    }
                    
                } else if (expenseType === 'customer') {
                    const customerId = parseInt(document.getElementById('selectedCustomerInfo').getAttribute('data-customer-id'));
                    const customerSearch = document.getElementById('expenseCustomerSearch').value;
                    
                    if (!customerSearch) {
                        alert('تکایە کەسێک هەڵبژێرە!');
                        return;
                    }
                    
                    const customer = sampleData.customers.find(c => c.id === customerId);
                    if (!customer) {
                        alert('کەسەکە نەدۆزرایەوە!');
                        return;
                    }
                    
                    expenseData.customerId = customerId;
                    expenseData.customerName = customer.name;
                    expenseData.description = `سەرفکردن بۆ کەس: ${customer.name}`;
                    
                    // کەمکردنەوەی قەرز (کەس قەرزداری منە، قەرزی کەم دەبێت)
                    customer.debt -= amount;
                    if (customer.debt < 0) customer.debt = 0;
                    
                } else if (expenseType === 'other') {
                    const category = document.getElementById('expenseCategory').value;
                    const description = document.getElementById('expenseDescription').value;
                    
                    if (!description.trim()) {
                        alert('تکایە پێناسەی سەرفکردن پڕ بکەرەوە!');
                        return;
                    }
                    
                    expenseData.category = category;
                    expenseData.description = description;
                    
                    // ناوی پۆل بە کوردی
                    const categoryNames = {
                        'rent': 'کرێ',
                        'salary': 'مووچە',
                        'utility': 'کەرەستە',
                        'transport': 'گواستنەوە',
                        'maintenance': 'چاکسازی',
                        'marketing': 'بازرگانی',
                        'office': 'ئۆفیس',
                        'other': 'هی تر'
                    };
                    
                    expenseData.categoryName = categoryNames[category] || category;
                }
                
                // کەمکردنەوەی پارە لە کۆی نەقدی
                sampleData.cashBalance -= amount;
                
                // تۆمارکردنی لە مێژوو
                sampleData.expenseHistory.unshift(expenseData);
                
                // نوێکردنەوەی داشبۆرد
                updateDashboardCash();
                
                // پاککردنەوەی هەموو خانەکان
                document.getElementById('expenseAmount').value = '';
                document.getElementById('expenseDescription').value = '';
                document.getElementById('expensePartnerSearch').value = '';
                document.getElementById('expenseCustomerSearch').value = '';
                document.getElementById('selectedPartnerInfo').style.display = 'none';
                document.getElementById('selectedCustomerInfo').style.display = 'none';
                
                // نوێکردنەوەی داشبۆرد و لیستەکان
                populateSampleData();
                updateExpenseHistoryDisplay();
                updateExpenseHistoryMainDisplay();
                
                alert(`سەرفکردنەکە بە سەرکەوتوویی تۆمارکرا! ${amount.toLocaleString()} دینار`);
            });
        }

        // نوێکردنەوەی مێژووی سەرفکردن
        function updateExpenseHistoryDisplay() {
            const expenseHistoryList = document.getElementById('expenseHistoryList');
            if (!expenseHistoryList) return;
            
            expenseHistoryList.innerHTML = '';
            
            if (sampleData.expenseHistory.length === 0) {
                expenseHistoryList.innerHTML = '<li class="list-item">هیچ مێژوویەکی سەرفکردن نییە</li>';
                return;
            }
            
            sampleData.expenseHistory.forEach(expense => {
                const li = document.createElement('li');
                li.className = 'list-item';
                
                // دروستکردنی پێناسە بەپێی جۆری سەرفکردن
                let description = expense.description;
                let icon = 'fa-money-bill-wave';
                let colorClass = 'debt-expense';
                
                if (expense.type === 'partner') {
                    icon = 'fa-handshake';
                    // بۆ سەرفکردنی شەریک، رەنگی جیاواز بەپێی جۆری قەرز
                    const partner = sampleData.partners.find(p => p.id === expense.partnerId);
                    if (partner) {
                        if (partner.debt > 0) {
                            colorClass = 'debt-positive';
                        } else if (partner.debt < 0) {
                            colorClass = 'debt-negative';
                        } else {
                            colorClass = 'debt-zero';
                        }
                    }
                } else if (expense.type === 'customer') {
                    icon = 'fa-user';
                    colorClass = 'debt-positive';
                } else if (expense.type === 'other') {
                    icon = 'fa-file-invoice-dollar';
                    colorClass = 'debt-expense';
                }
                
                li.innerHTML = `
                    <div>
                        <div class="item-name">${description}</div>
                        <div style="font-size: 0.9rem; color: var(--gray);">
                            <i class="fas ${icon}"></i> ${expense.date}
                            ${expense.categoryName ? ` | پۆل: ${expense.categoryName}` : ''}
                        </div>
                    </div>
                    <div>
                        <div class="item-value ${colorClass}">${expense.amount.toLocaleString()} دینار</div>
                        <div style="margin-top: 10px;">
                            <button class="btn btn-danger btn-sm" onclick="deleteExpense(${expense.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
                expenseHistoryList.appendChild(li);
            });
        }

        // سڕینەوەی سەرفکردن (چاکسازیکراو)
        window.deleteExpense = function(expenseId) {
            if (confirm('دڵنیای لە سڕینەوەی ئەم سەرفکردنە؟')) {
                const expenseIndex = sampleData.expenseHistory.findIndex(e => e.id === expenseId);
                if (expenseIndex !== -1) {
                    const expense = sampleData.expenseHistory[expenseIndex];
                    
                    // گەڕاندنەوەی پارە بۆ کۆی نەقدی
                    sampleData.cashBalance += expense.amount;
                    
                    // گەڕاندنەوەی قەرز (ئەگەر بۆ شەریک یان کەس بوو)
                    if (expense.type === 'partner' && expense.partnerId) {
                        const partner = sampleData.partners.find(p => p.id === expense.partnerId);
                        if (partner) {
                            // گەڕاندنەوەی قەرز بەپێی حاڵەت
                            if (partner.debt > expense.amount) {
                                // شەریک قەرزداری منە، قەرزی کەم دەبێت
                                partner.debt -= expense.amount;
                            } else {
                                // من قەرزداری شەریکم، قەرزی زیاد دەبێت
                                partner.debt += expense.amount;
                            }
                        }
                    } else if (expense.type === 'customer' && expense.customerId) {
                        const customer = sampleData.customers.find(c => c.id === expense.customerId);
                        if (customer) {
                            // گەڕاندنەوەی قەرز (کەس قەرزداری منە، قەرزی زیاد دەبێت)
                            customer.debt += expense.amount;
                        }
                    }
                    
                    // سڕینەوە لە مێژوو
                    sampleData.expenseHistory.splice(expenseIndex, 1);
                    
                    // نوێکردنەوەی داشبۆرد
                    updateDashboardCash();
                    populateSampleData();
                    updateExpenseHistoryDisplay();
                    updateExpenseHistoryMainDisplay();
                    
                    alert('سەرفکردنەکە بە سەرکەوتوویی سڕایەوە!');
                }
            }
        };

        // نوێکردنەوەی مێژووی سەرفکردن
        const refreshExpenseHistoryBtn = document.getElementById('refreshExpenseHistory');
        if (refreshExpenseHistoryBtn) {
            refreshExpenseHistoryBtn.addEventListener('click', function() {
                updateExpenseHistoryDisplay();
                updateExpenseHistoryMainDisplay();
                alert('مێژووی سەرفکردن نوێ کرایەوە!');
            });
        }

        // ==============================================
        // بەشی سەرف و حیسابی شەریکەکان - فەنکشنە نوێیەکان
        // ==============================================

        // گەڕان بەدوای شەریکەکان (بەشی سەرف بۆ شەریک)
        const expensePartnerSearchMain = document.getElementById('expensePartnerSearchMain');
        if (expensePartnerSearchMain) {
            expensePartnerSearchMain.addEventListener('input', function() {
                const query = this.value.toLowerCase();
                const suggestions = document.getElementById('expensePartnerSuggestionsMain');
                
                if (!suggestions) return;
                
                if (query.length < 2) {
                    suggestions.style.display = 'none';
                    document.getElementById('selectedPartnerInfoMain').style.display = 'none';
                    return;
                }
                
                const filteredPartners = sampleData.partners.filter(p => 
                    p.name.toLowerCase().includes(query)
                );
                
                suggestions.innerHTML = '';
                
                if (filteredPartners.length === 0) {
                    suggestions.style.display = 'none';
                    document.getElementById('selectedPartnerInfoMain').style.display = 'none';
                    return;
                }
                
                filteredPartners.forEach(partner => {
                    // دیاریکردنی رەنگ بەپێی جۆری قەرز
                    let debtText, debtClass;
                    
                    if (partner.debt > 0) {
                        debtText = partner.debt.toLocaleString() + ' دینار (شەریک قەرزداری منە)';
                        debtClass = 'debt-positive';
                    } else if (partner.debt < 0) {
                        debtText = Math.abs(partner.debt).toLocaleString() + ' دینار (من قەرزداری ئەوانم)';
                        debtClass = 'debt-negative';
                    } else {
                        debtText = 'بێ قەرز';
                        debtClass = 'debt-zero';
                    }
                    
                    const div = document.createElement('div');
                    div.className = 'suggestion-item';
                    div.innerHTML = `
                        <div><strong>${partner.name}</strong></div>
                        <div style="font-size: 0.9rem; color: var(--gray);">
                            ${partner.phone} | <span class="${debtClass}">${debtText}</span>
                        </div>
                    `;
                    
                    div.addEventListener('click', function() {
                        document.getElementById('expensePartnerSearchMain').value = partner.name;
                        
                        // نیشاندانی زانیاری شەریک
                        document.getElementById('selectedPartnerNameMain').textContent = partner.name;
                        document.getElementById('selectedPartnerPhoneMain').textContent = partner.phone;
                        document.getElementById('selectedPartnerDebtMain').textContent = debtText;
                        
                        // دۆزینەوەی پارەی واسڵ کراو
                        const totalPaid = sampleData.paymentHistory
                            .filter(p => p.debtorId === partner.id && p.debtorType === 'partner')
                            .reduce((sum, payment) => sum + payment.amount, 0);
                        
                        document.getElementById('selectedPartnerPaidMain').textContent = totalPaid.toLocaleString();
                        document.getElementById('selectedPartnerInfoMain').style.display = 'block';
                        document.getElementById('selectedPartnerInfoMain').setAttribute('data-partner-id', partner.id);
                        
                        suggestions.style.display = 'none';
                    });
                    
                    suggestions.appendChild(div);
                });
                
                suggestions.style.display = 'block';
            });
        }

        // گەڕان بەدوای کەسەکان (بەشی سەرف بۆ کەس)
        const expenseCustomerSearchMain = document.getElementById('expenseCustomerSearchMain');
        if (expenseCustomerSearchMain) {
            expenseCustomerSearchMain.addEventListener('input', function() {
                const query = this.value.toLowerCase();
                const suggestions = document.getElementById('expenseCustomerSuggestionsMain');
                
                if (!suggestions) return;
                
                if (query.length < 2) {
                    suggestions.style.display = 'none';
                    document.getElementById('selectedCustomerInfoMain').style.display = 'none';
                    return;
                }
                
                const filteredCustomers = sampleData.customers.filter(c => 
                    c.name.toLowerCase().includes(query)
                );
                
                suggestions.innerHTML = '';
                
                if (filteredCustomers.length === 0) {
                    suggestions.style.display = 'none';
                    document.getElementById('selectedCustomerInfoMain').style.display = 'none';
                    return;
                }
                
                filteredCustomers.forEach(customer => {
                    const div = document.createElement('div');
                    div.className = 'suggestion-item';
                    div.innerHTML = `
                        <div><strong>${customer.name}</strong></div>
                        <div style="font-size: 0.9rem; color: var(--gray);">
                            ${customer.phone} | <span class="${customer.debt > 0 ? 'debt-positive' : 'debt-zero'}">${customer.debt > 0 ? customer.debt.toLocaleString() + ' دینار قەرز' : 'بێ قەرز'}</span>
                        </div>
                    `;
                    
                    div.addEventListener('click', function() {
                        document.getElementById('expenseCustomerSearchMain').value = customer.name;
                        
                        // نیشاندانی زانیاری کەس
                        document.getElementById('selectedCustomerNameMain').textContent = customer.name;
                        document.getElementById('selectedCustomerPhoneMain').textContent = customer.phone;
                        document.getElementById('selectedCustomerDebtMain').textContent = customer.debt > 0 ? 
                            customer.debt.toLocaleString() + ' دینار قەرز' : 'بێ قەرز';
                        
                        // دۆزینەوەی پارەی واسڵ کراو
                        const totalPaid = sampleData.paymentHistory
                            .filter(p => p.debtorId === customer.id && p.debtorType === 'customer')
                            .reduce((sum, payment) => sum + payment.amount, 0);
                        
                        document.getElementById('selectedCustomerPaidMain').textContent = totalPaid.toLocaleString();
                        document.getElementById('selectedCustomerInfoMain').style.display = 'block';
                        document.getElementById('selectedCustomerInfoMain').setAttribute('data-customer-id', customer.id);
                        
                        suggestions.style.display = 'none';
                    });
                    
                    suggestions.appendChild(div);
                });
                
                suggestions.style.display = 'block';
            });
        }

        // تۆمارکردنی سەرفکردن بۆ شەریک (چاکسازیکراو)
        const submitExpenseToPartnerBtn = document.getElementById('submitExpenseToPartnerBtn');
        if (submitExpenseToPartnerBtn) {
            submitExpenseToPartnerBtn.addEventListener('click', function() {
                const partnerId = parseInt(document.getElementById('selectedPartnerInfoMain').getAttribute('data-partner-id'));
                const amount = parseInt(document.getElementById('expenseToPartnerAmount').value);
                const date = document.getElementById('expenseToPartnerDate').value;
                const reason = document.getElementById('expenseToPartnerReason').value;
                
                if (!partnerId) {
                    alert('تکایە شەریکێک هەڵبژێرە!');
                    return;
                }
                
                if (!amount || amount <= 0) {
                    alert('تکایە بڕی پارەی سەرفکردن پڕ بکەرەوە!');
                    return;
                }
                
                if (amount > sampleData.cashBalance) {
                    alert(`بڕی سەرفکردن نابێت لە کۆی پارەی واسڵ کراو زیاتر بێت! کۆی پارەی واسڵ کراو: ${sampleData.cashBalance.toLocaleString()} دینار`);
                    return;
                }
                
                const partner = sampleData.partners.find(p => p.id === partnerId);
                if (!partner) {
                    alert('شەریکەکە نەدۆزرایەوە!');
                    return;
                }
                
                // ✅ **چاکسازی بەپێی حاڵەت:**
                if (partner.debt < 0) {
                    // حاڵەت ١: من قەرزداری شەریکم (قەرز منفی)
                    // سەرفکردن واتە: من پارە دەدەم، قەرزم کەم دەبێت
                    partner.debt += amount; // -100,000 + 20,000 = -80,000 ✅
                } else if (partner.debt === 0) {
                    // حاڵەت ٢: بێ قەرز (سفر)
                    // سەرفکردن واتە: شەریک قەرزداری من دەبێت
                    partner.debt = amount; // 0 -> 20,000 ✅
                } else {
                    // حاڵەت ٣: شەریک قەرزداری منە (قەرز مثبت)
                    // سەرفکردن واتە: قەرزی زیاد دەکات
                    partner.debt += amount; // 30,000 + 20,000 = 50,000 ✅
                }
                
                // کەمکردنەوەی پارە لە کۆی نەقدی
                sampleData.cashBalance -= amount;
                
                // دروستکردنی تۆمارەکە بۆ مێژووی سەرفکردن
                const expenseRecord = {
                    id: sampleData.expenseHistory.length + 1,
                    type: 'partner',
                    partnerId: partnerId,
                    partnerName: partner.name,
                    amount: amount,
                    date: date,
                    reason: reason || `سەرفکردن بۆ شەریک: ${partner.name}`,
                    description: reason || `سەرفکردن بۆ شەریک: ${partner.name}`,
                    timestamp: new Date().toISOString(),
                    isExpense: true
                };
                
                // تۆمارکردنی لە مێژوو
                sampleData.expenseHistory.unshift(expenseRecord);
                
                // نوێکردنەوەی داشبۆرد
                updateDashboardCash();
                
                // نوێکردنەوەی زانیاری شەریک
                const totalPaid = sampleData.paymentHistory
                    .filter(p => p.debtorId === partner.id && p.debtorType === 'partner')
                    .reduce((sum, payment) => sum + payment.amount, 0);
                
                // نوێکردنەوەی قەرز بەپێی جۆری
                let debtText;
                if (partner.debt > 0) {
                    debtText = partner.debt.toLocaleString() + ' دینار (شەریک قەرزداری منە)';
                } else if (partner.debt < 0) {
                    debtText = Math.abs(partner.debt).toLocaleString() + ' دینار (من قەرزداری ئەوانم)';
                } else {
                    debtText = 'بێ قەرز';
                }
                
                document.getElementById('selectedPartnerDebtMain').textContent = debtText;
                document.getElementById('selectedPartnerPaidMain').textContent = totalPaid.toLocaleString();
                
                // پاککردنەوەی خانەکان
                document.getElementById('expenseToPartnerAmount').value = '';
                document.getElementById('expenseToPartnerReason').value = '';
                
                // نوێکردنەوەی داشبۆرد و لیستەکان
                populateSampleData();
                updateExpenseHistoryDisplay();
                updateExpenseHistoryMainDisplay();
                
                alert(`سەرفکردن بۆ شەریک بە سەرکەوتوویی تۆمارکرا! ${amount.toLocaleString()} دینار`);
            });
        }

        // تۆمارکردنی سەرفکردن بۆ کەس
        const submitExpenseToCustomerBtn = document.getElementById('submitExpenseToCustomerBtn');
        if (submitExpenseToCustomerBtn) {
            submitExpenseToCustomerBtn.addEventListener('click', function() {
                const customerId = parseInt(document.getElementById('selectedCustomerInfoMain').getAttribute('data-customer-id'));
                const amount = parseInt(document.getElementById('expenseToCustomerAmount').value);
                const date = document.getElementById('expenseToCustomerDate').value;
                const reason = document.getElementById('expenseToCustomerReason').value;
                
                if (!customerId) {
                    alert('تکایە کەسێک هەڵبژێرە!');
                    return;
                }
                
                if (!amount || amount <= 0) {
                    alert('تکایە بڕی پارەی سەرفکردن پڕ بکەرەوە!');
                    return;
                }
                
                if (amount > sampleData.cashBalance) {
                    alert(`بڕی سەرفکردن نابێت لە کۆی پارەی واسڵ کراو زیاتر بێت! کۆی پارەی واسڵ کراو: ${sampleData.cashBalance.toLocaleString()} دینار`);
                    return;
                }
                
                const customer = sampleData.customers.find(c => c.id === customerId);
                if (!customer) {
                    alert('کەسەکە نەدۆزرایەوە!');
                    return;
                }
                
                // کەمکردنەوەی قەرز (کەس قەرزداری منە، قەرزی کەم دەبێت)
                customer.debt -= amount;
                if (customer.debt < 0) customer.debt = 0;
                
                // کەمکردنەوەی پارە لە کۆی نەقدی
                sampleData.cashBalance -= amount;
                
                // دروستکردنی تۆمارەکە بۆ مێژووی سەرفکردن
                const expenseRecord = {
                    id: sampleData.expenseHistory.length + 1,
                    type: 'customer',
                    customerId: customerId,
                    customerName: customer.name,
                    amount: amount,
                    date: date,
                    reason: reason || `سەرفکردن بۆ کەس: ${customer.name}`,
                    description: reason || `سەرفکردن بۆ کەس: ${customer.name}`,
                    timestamp: new Date().toISOString(),
                    isExpense: true
                };
                
                // تۆمارکردنی لە مێژوو
                sampleData.expenseHistory.unshift(expenseRecord);
                
                // نوێکردنەوەی داشبۆرد
                updateDashboardCash();
                
                // نوێکردنەوەی زانیاری کەس
                const totalPaid = sampleData.paymentHistory
                    .filter(p => p.debtorId === customer.id && p.debtorType === 'customer')
                    .reduce((sum, payment) => sum + payment.amount, 0);
                
                document.getElementById('selectedCustomerDebtMain').textContent = customer.debt > 0 ? 
                    customer.debt.toLocaleString() + ' دینار قەرز' : 'بێ قەرز';
                document.getElementById('selectedCustomerPaidMain').textContent = totalPaid.toLocaleString();
                
                // پاککردنەوەی خانەکان
                document.getElementById('expenseToCustomerAmount').value = '';
                document.getElementById('expenseToCustomerReason').value = '';
                
                // نوێکردنەوەی داشبۆرد و لیستەکان
                populateSampleData();
                updateExpenseHistoryDisplay();
                updateExpenseHistoryMainDisplay();
                
                alert(`سەرفکردن بۆ کەس بە سەرکەوتوویی تۆمارکرا! ${amount.toLocaleString()} دینار`);
            });
        }

        // تۆمارکردنی سەرفکردن بۆ هۆکی تر
        const submitOtherExpenseBtn = document.getElementById('submitOtherExpenseBtn');
        if (submitOtherExpenseBtn) {
            submitOtherExpenseBtn.addEventListener('click', function() {
                const amount = parseInt(document.getElementById('otherExpenseAmount').value);
                const date = document.getElementById('otherExpenseDate').value;
                const category = document.getElementById('otherExpenseCategory').value;
                const description = document.getElementById('otherExpenseDescription').value;
                
                if (!amount || amount <= 0) {
                    alert('تکایە بڕی پارەی سەرفکردن پڕ بکەرەوە!');
                    return;
                }
                
                if (amount > sampleData.cashBalance) {
                    alert(`بڕی سەرفکردن نابێت لە کۆی پارەی واسڵ کراو زیاتر بێت! کۆی پارەی واسڵ کراو: ${sampleData.cashBalance.toLocaleString()} دینار`);
                    return;
                }
                
                if (!description.trim()) {
                    alert('تکایە پێناسەی سەرفکردن پڕ بکەرەوە!');
                    return;
                }
                
                // دروستکردنی تۆمارەکە بۆ مێژووی سەرفکردن
                const expenseRecord = {
                    id: sampleData.expenseHistory.length + 1,
                    type: 'other',
                    amount: amount,
                    date: date,
                    category: category,
                    description: description,
                    reason: description,
                    timestamp: new Date().toISOString()
                };
                
                // کەمکردنەوەی پارە لە کۆی نەقدی
                sampleData.cashBalance -= amount;
                
                // تۆمارکردنی لە مێژوو
                sampleData.expenseHistory.unshift(expenseRecord);
                
                // نوێکردنەوەی داشبۆرد
                updateDashboardCash();
                
                // پاککردنەوەی خانەکان
                document.getElementById('otherExpenseAmount').value = '';
                document.getElementById('otherExpenseDescription').value = '';
                
                // نوێکردنەوەی داشبۆرد و لیستەکان
                populateSampleData();
                updateExpenseHistoryDisplay();
                updateExpenseHistoryMainDisplay();
                
                alert(`سەرفکردن بە سەرکەوتوویی تۆمارکرا! ${amount.toLocaleString()} دینار`);
            });
        }

        // نوێکردنەوەی لیستی مێژووی سەرفکردن (لە بەشی سەرف و حیسابی شەریکەکان)
        function updateExpenseHistoryMainDisplay() {
            const expenseHistoryMainList = document.getElementById('expenseHistoryMainList');
            if (!expenseHistoryMainList) return;
            
            expenseHistoryMainList.innerHTML = '';
            
            if (sampleData.expenseHistory.length === 0) {
                expenseHistoryMainList.innerHTML = '<li class="list-item">هیچ مێژوویەکی سەرفکردن نییە</li>';
                return;
            }
            
            sampleData.expenseHistory.forEach(expense => {
                const li = document.createElement('li');
                li.className = 'list-item';
                
                // دروستکردنی پێناسە بەپێی جۆری سەرفکردن
                let description = expense.description;
                let icon = 'fa-money-bill-wave';
                let typeText = '';
                let colorClass = 'debt-expense';
                
                if (expense.type === 'partner') {
                    icon = 'fa-handshake';
                    typeText = `بۆ شەریک: ${expense.partnerName}`;
                    
                    // بۆ سەرفکردنی شەریک، رەنگی جیاواز بەپێی جۆری قەرز
                    const partner = sampleData.partners.find(p => p.id === expense.partnerId);
                    if (partner) {
                        if (partner.debt > 0) {
                            colorClass = 'debt-positive';
                        } else if (partner.debt < 0) {
                            colorClass = 'debt-negative';
                        } else {
                            colorClass = 'debt-zero';
                        }
                    }
                } else if (expense.type === 'customer') {
                    icon = 'fa-user';
                    typeText = `بۆ کەس: ${expense.customerName}`;
                    colorClass = 'debt-positive';
                } else if (expense.type === 'other') {
                    icon = 'fa-file-invoice-dollar';
                    typeText = `بۆ هۆکی تر`;
                    colorClass = 'debt-expense';
                }
                
                li.innerHTML = `
                    <div>
                        <div class="item-name">${description}</div>
                        <div style="font-size: 0.9rem; color: var(--gray);">
                            <i class="fas ${icon}"></i> ${expense.date} | ${typeText}
                        </div>
                    </div>
                    <div>
                        <div class="item-value ${colorClass}">${expense.amount.toLocaleString()} دینار</div>
                        <div style="margin-top: 10px;">
                            <button class="btn btn-danger btn-sm" onclick="deleteExpense(${expense.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
                expenseHistoryMainList.appendChild(li);
            });
        }

        // نوێکردنەوەی لیستی سەرفکردن
        const refreshExpenseHistoryMainBtn = document.getElementById('refreshExpenseHistoryMain');
        if (refreshExpenseHistoryMainBtn) {
            refreshExpenseHistoryMainBtn.addEventListener('click', function() {
                updateExpenseHistoryMainDisplay();
                alert('مێژووی سەرفکردن نوێ کرایەوە!');
            });
        }

        // دەستپێکردنی سیستم
        window.addEventListener('load', function() {
            const firstNavLink = document.querySelector('.nav-link[data-section="dashboard"]');
            if (firstNavLink) {
                firstNavLink.classList.add('active');
            }
            
            const firstTabBtn = document.querySelector('.tab-btn[data-tab="newSale"]');
            if (firstTabBtn) {
                firstTabBtn.classList.add('active');
            }
            
            const firstPurchaseTab = document.querySelector('#purchaseSection .tab-btn[data-tab="newPurchase"]');
            if (firstPurchaseTab) {
                firstPurchaseTab.classList.add('active');
            }
            
            const firstPaymentTab = document.querySelector('.tab-btn[data-tab="debtPayment"]');
            if (firstPaymentTab) {
                firstPaymentTab.classList.add('active');
            }
            
            const partnerExpenseTab = document.querySelector('.tab-btn[data-tab="expenseToPartner"]');
            if (partnerExpenseTab) {
                partnerExpenseTab.classList.add('active');
            }
            
            const firstInventoryTab = document.querySelector('.inventory-tab[data-inventory-tab="products"]');
            if (firstInventoryTab) {
                firstInventoryTab.classList.add('active');
            }
            
            const firstPaymentOption = document.querySelector('.payment-option[data-payment="cash"]');
            if (firstPaymentOption) {
                firstPaymentOption.classList.add('selected');
            }
            
            const firstCustomerTab = document.querySelector('.tab-btn[data-tab="customersList"]');
            if (firstCustomerTab) {
                firstCustomerTab.classList.add('active');
            }
            
            const firstPartnerTab = document.querySelector('.tab-btn[data-tab="partnersList"]');
            if (firstPartnerTab) {
                firstPartnerTab.classList.add('active');
            }
            
            // دەستپێکردنی جۆری سەرفکردن
            if (document.getElementById('expenseType')) {
                document.getElementById('expenseType').value = 'other';
                document.getElementById('expenseOtherSection').style.display = 'block';
            }
            
            // دەستپێکردنی بەرواری ئەمرۆ
            const today = new Date().toISOString().split('T')[0];
            if (document.getElementById('paymentDateInput')) {
                document.getElementById('paymentDateInput').value = today;
            }
            if (document.getElementById('expenseDate')) {
                document.getElementById('expenseDate').value = today;
            }
            
            updateCartDisplay();
            updatePurchaseCartDisplay();
            updateDashboardCash();
            updatePaymentHistoryDisplay();
            updateExpenseHistoryDisplay();
            updateExpenseHistoryMainDisplay();
            calculateMonthlyExpense();
        });
    </script>
</body>
</html>