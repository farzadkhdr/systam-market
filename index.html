<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>سیستەمی فرۆشتی ئەلکترۆنیات</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* هەموو CSS لێرە */
        :root {
            --primary: #4361ee;
            --primary-dark: #3a56d4;
            --secondary: #7209b7;
            --success: #4cc9f0;
            --danger: #f72585;
            --warning: #f8961e;
            --info: #4895ef;
            --dark: #212529;
            --light: #f8f9fa;
            --gray: #6c757d;
            --gray-light: #e9ecef;
            --border-radius: 10px;
            --box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--dark);
            min-height: 100vh;
            direction: rtl;
            overflow-x: hidden;
            height: 100vh;
        }
        
        /* شێوازی پەڕەی چوونەژوورەوە */
        #loginPage {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            padding: 20px;
            animation: gradientBG 10s ease infinite;
            background-size: 400% 400%;
        }
        
        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .login-container {
            width: 100%;
            max-width: 450px;
            margin: 0 auto;
        }
        
        .login-box {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 40px 30px;
            position: relative;
            overflow: hidden;
            animation: fadeIn 0.8s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .login-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .login-header .logo {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        
        .login-header h2 {
            color: var(--dark);
            margin-bottom: 10px;
            font-size: 1.8rem;
        }
        
        .login-header p {
            color: var(--gray);
            font-size: 0.9rem;
        }
        
        .login-form {
            margin-top: 20px;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--dark);
            font-weight: 500;
        }
        
        .input-group input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
        }
        
        .input-group input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }
        
        .input-group.remember {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .input-group.remember input {
            width: auto;
            margin-left: 10px;
        }
        
        .login-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            border: none;
            border-radius: var(--border-radius);
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .login-btn:hover {
            background: linear-gradient(to right, var(--primary-dark), #6310a3);
            transform: translateY(-3px);
            box-shadow: 0 7px 20px rgba(0,0,0,0.15);
        }
        
        .login-btn i {
            margin-left: 10px;
        }
        
        .login-footer {
            margin-top: 20px;
            text-align: center;
            color: var(--gray);
            font-size: 0.9rem;
        }
        
        .login-footer a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
        }
        
        .login-footer a:hover {
            text-decoration: underline;
        }
        
        .login-animation {
            display: flex;
            justify-content: center;
            margin-top: 30px;
            gap: 15px;
        }
        
        .circle {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background-color: var(--primary);
            animation: bounce 1.5s infinite;
        }
        
        .circle:nth-child(2) {
            animation-delay: 0.2s;
            background-color: var(--secondary);
        }
        
        .circle:nth-child(3) {
            animation-delay: 0.4s;
            background-color: var(--success);
        }
        
        @keyframes bounce {
            0%, 60%, 100% {
                transform: translateY(0);
            }
            30% {
                transform: translateY(-15px);
            }
        }
        
        /* شێوازی پەڕەی سەرەکی */
        .container {
            display: flex;
            min-height: 100vh;
            display: none; /* شاردراوە بۆ دەستپێک */
        }
        
        /* بارەگەی لای چەپ - مێنیو */
        .sidebar {
            width: 250px;
            background: linear-gradient(180deg, var(--dark) 0%, #343a40 100%);
            color: white;
            padding: 20px 0;
            transition: var(--transition);
            position: fixed;
            height: 100vh;
            z-index: 100;
            box-shadow: 3px 0 15px rgba(0,0,0,0.1);
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--primary) rgba(255,255,255,0.1);
        }
        
        .sidebar::-webkit-scrollbar {
            width: 6px;
        }
        
        .sidebar::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
        }
        
        .sidebar::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 10px;
        }
        
        .sidebar::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }
        
        .sidebar.collapsed {
            transform: translateX(-250px);
        }
        
        .sidebar.active {
            transform: translateX(0);
        }
        
        .sidebar-header {
            padding: 0 20px 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .sidebar-header h3 {
            font-size: 1.5rem;
            font-weight: 600;
        }
        
        .close-sidebar {
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            display: none;
        }
        
        .nav-menu {
            list-style: none;
        }
        
        .nav-item {
            margin-bottom: 5px;
        }
        
        .nav-link {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            transition: var(--transition);
            border-right: 3px solid transparent;
        }
        
        .nav-link:hover, .nav-link.active {
            background-color: rgba(255,255,255,0.1);
            color: white;
            border-right-color: var(--primary);
        }
        
        .nav-link i {
            margin-left: 10px;
            font-size: 1.2rem;
            width: 25px;
        }
        
        /* بەشی سەرەوە */
        .header {
            height: 70px;
            background-color: white;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
            display: flex;
            align-items: center;
            padding: 0 30px;
            position: fixed;
            top: 0;
            right: 0;
            left: 250px;
            z-index: 99;
            transition: var(--transition);
        }
        
        .header.collapsed {
            left: 0;
        }
        
        .header-left {
            display: flex;
            align-items: center;
        }
        
        .menu-toggle {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--dark);
            cursor: pointer;
            margin-left: 20px;
        }
        
        .logo {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--primary);
            text-shadow: 1px 1px 3px rgba(0,0,0,0.1);
        }
        
        .header-center {
            flex: 1;
            text-align: center;
        }
        
        .header-center h1 {
            font-size: 1.5rem;
            color: var(--dark);
        }
        
        .header-right {
            display: flex;
            align-items: center;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            background-color: var(--gray-light);
            padding: 8px 15px;
            border-radius: 30px;
            margin-left: 15px;
        }
        
        .user-info i {
            margin-left: 8px;
            color: var(--primary);
            font-size: 1.3rem;
        }
        
        .logout-btn {
            background-color: var(--danger);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
        }
        
        .logout-btn:hover {
            background-color: #e11575;
        }
        
        /* بەشی ناوەڕاست */
        .main-content {
            flex: 1;
            padding: 100px 30px 30px;
            margin-right: 250px;
            transition: var(--transition);
            background-color: #f5f7fa;
            min-height: 100vh;
            overflow-y: auto;
            height: calc(100vh - 70px);
            margin-top: 70px;
        }
        
        .main-content::-webkit-scrollbar {
            width: 8px;
        }
        
        .main-content::-webkit-scrollbar-track {
            background: var(--gray-light);
            border-radius: 10px;
        }
        
        .main-content::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 10px;
        }
        
        .main-content::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }
        
        .main-content.collapsed {
            margin-right: 0;
        }
        
        /* بەشەکانی ناوەڕاست */
        .content-section {
            display: none;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease, transform 0.5s ease;
        }
        
        .content-section.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }
        
        /* کارتەکانی داشبۆرد */
        .section-title {
            font-size: 1.8rem;
            margin-bottom: 25px;
            color: var(--dark);
            position: relative;
            padding-bottom: 10px;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: 0;
            width: 80px;
            height: 3px;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            border-radius: 3px;
        }
        
        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .card {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 25px;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.12);
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(to right, var(--primary), var(--secondary));
        }
        
        .card-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            margin-bottom: 20px;
            color: white;
        }
        
        .card-1 .card-icon { background-color: var(--primary); }
        .card-2 .card-icon { background-color: var(--success); }
        .card-3 .card-icon { background-color: var(--warning); }
        .card-4 .card-icon { background-color: var(--danger); }
        .card-5 .card-icon { background-color: var(--secondary); }
        .card-6 .card-icon { background-color: var(--info); }
        .card-7 .card-icon { background-color: #9d4edd; }
        
        .card h3 {
            font-size: 1.1rem;
            color: var(--gray);
            margin-bottom: 10px;
        }
        
        .card-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 15px;
        }
        
        .card-change {
            font-size: 0.9rem;
            display: flex;
            align-items: center;
        }
        
        .card-change.positive {
            color: #28a745;
        }
        
        .card-change.negative {
            color: var(--danger);
        }
        
        /* رەنگەکانی بڕی پارە بەپێی جۆری قەرز */
        .item-value.debt-positive {
            color: #f72585; /* سۆر - کاتێ کەس قەرزداری منە */
            font-weight: 600;
        }
        
        .item-value.debt-negative {
            color: #212529; /* رەش - کاتێ من قەرزداری شەریکم */
            font-weight: 600;
        }
        
        .item-value.debt-zero {
            color: #6c757d; /* خۆڵەمێشی - بێ قەرز */
            font-weight: 600;
        }
        
        .item-value.debt-payment {
            color: #28a745; /* سەوز - پارەواسڵکردن */
            font-weight: 600;
        }
        
        .item-value.debt-expense {
            color: #f8961e; /* پرتەقاڵی - سەرفکردن */
            font-weight: 600;
        }
        
        /* لیستەکان */
        .lists-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .list-box {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 25px;
        }
        
        .list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--gray-light);
        }
        
        .list-header h3 {
            font-size: 1.3rem;
            color: var(--dark);
        }
        
        .list-actions button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            margin-left: 10px;
        }
        
        .list-actions button:hover {
            background-color: var(--primary-dark);
        }
        
        .list-items {
            list-style: none;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .list-item {
            padding: 15px;
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: var(--transition);
        }
        
        .list-item:hover {
            background-color: var(--gray-light);
        }
        
        .item-name {
            font-weight: 500;
            color: var(--dark);
        }
        
        .item-value {
            font-weight: 600;
            color: var(--primary);
        }
        
        /* بەشی فرۆشتن (نوێکراوە) */
        .sale-container {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 30px;
            margin-bottom: 40px;
        }
        
        .tab-buttons {
            display: flex;
            margin-bottom: 30px;
            border-bottom: 1px solid var(--gray-light);
        }
        
        .tab-btn {
            background: none;
            border: none;
            padding: 15px 25px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: var(--transition);
            color: var(--gray);
            font-weight: 500;
            position: relative;
        }
        
        .tab-btn.active {
            color: var(--primary);
        }
        
        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            right: 0;
            width: 100%;
            height: 3px;
            background-color: var(--primary);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .search-container {
            margin-bottom: 25px;
        }
        
        .search-box {
            position: relative;
            max-width: 500px;
        }
        
        .search-box input {
            width: 100%;
            padding: 15px 50px 15px 15px;
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
        }
        
        .search-box input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }
        
        .search-box i {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }
        
        .suggestions {
            position: absolute;
            top: 100%;
            right: 0;
            left: 0;
            background-color: white;
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            z-index: 10;
            max-height: 300px;
            overflow-y: auto;
            display: none;
        }
        
        .suggestion-item {
            padding: 12px 15px;
            cursor: pointer;
            transition: var(--transition);
            border-bottom: 1px solid var(--gray-light);
        }
        
        .suggestion-item:hover {
            background-color: var(--gray-light);
        }
        
        .suggestion-item:last-child {
            border-bottom: none;
        }
        
        .cart-container {
            background-color: var(--gray-light);
            border-radius: var(--border-radius);
            padding: 25px;
            margin-top: 30px;
        }
        
        .cart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .cart-items {
            list-style: none;
            max-height: 350px;
            overflow-y: auto;
            margin-bottom: 20px;
        }
        
        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background-color: white;
            border-radius: var(--border-radius);
            margin-bottom: 15px;
            border: 1px solid var(--gray-light);
        }
        
        .cart-item-info {
            display: flex;
            align-items: center;
            flex: 1;
        }
        
        .cart-item-image {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            background-color: var(--primary);
            margin-left: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            flex-shrink: 0;
        }
        
        .cart-item-details {
            flex: 1;
        }
        
        .cart-item-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        
        .cart-item-controls input,
        .cart-item-controls select {
            padding: 8px 12px;
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            font-size: 0.9rem;
            width: auto;
        }
        
        .cart-item-controls input {
            width: 80px;
        }
        
        .cart-item-controls select {
            width: 120px;
        }
        
        .cart-item-price {
            text-align: left;
            min-width: 150px;
        }
        
        .cart-item-total {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--primary);
        }
        
        .payment-options {
            display: flex;
            margin-top: 20px;
            gap: 15px;
        }
        
        .payment-option {
            flex: 1;
            padding: 15px;
            border: 2px solid var(--gray-light);
            border-radius: var(--border-radius);
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .payment-option.selected {
            border-color: var(--primary);
            background-color: rgba(67, 97, 238, 0.05);
        }
        
        .customer-search-container {
            margin-top: 20px;
            display: none;
        }
        
        .customer-search-container.active {
            display: block;
        }
        
        .action-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 30px;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn i {
            margin-left: 8px;
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--primary-dark);
        }
        
        .btn-success {
            background-color: var(--success);
            color: white;
        }
        
        .btn-success:hover {
            background-color: #3ab8e0;
        }
        
        .btn-danger {
            background-color: var(--danger);
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #e11575;
        }
        
        .btn-warning {
            background-color: var(--warning);
            color: white;
        }
        
        .btn-warning:hover {
            background-color: #e68905;
        }
        
        /* بەشی مخزن */
        .inventory-tabs {
            display: flex;
            margin-bottom: 30px;
        }
        
        .inventory-tab {
            background: none;
            border: none;
            padding: 15px 25px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: var(--transition);
            color: var(--gray);
            font-weight: 500;
            position: relative;
        }
        
        .inventory-tab.active {
            color: var(--primary);
        }
        
        .inventory-tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            right: 0;
            width: 100%;
            height: 3px;
            background-color: var(--primary);
        }
        
        .inventory-content {
            display: none;
        }
        
        .inventory-content.active {
            display: block;
        }
        
        .item-form {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 30px;
            margin-bottom: 40px;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--dark);
            font-weight: 500;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
        }
        
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }
        
        /* مۆدالی پرێنت */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            background-color: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background-color: white;
            border-radius: var(--border-radius);
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            animation: modalFadeIn 0.3s ease;
        }
        
        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(-30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 30px;
            border-bottom: 1px solid var(--gray-light);
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
        }
        
        .modal-body {
            padding: 30px;
        }
        
        .invoice {
            font-family: Arial, sans-serif;
            line-height: 1.6;
        }
        
        .invoice-header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--primary);
            padding-bottom: 20px;
        }
        
        .invoice-logo {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .invoice-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .invoice-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
        }
        
        .invoice-table th, .invoice-table td {
            padding: 12px 15px;
            text-align: right;
            border-bottom: 1px solid var(--gray-light);
        }
        
        .invoice-table th {
            background-color: var(--gray-light);
            font-weight: 600;
        }
        
        .invoice-total {
            text-align: left;
            margin-top: 30px;
            font-size: 1.2rem;
        }
        
        .print-options {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 40px;
        }
        
        /* وەڵامی مۆبایل */
        @media (max-width: 992px) {
            .sidebar {
                transform: translateX(-250px);
                box-shadow: none;
            }
            
            .sidebar.active {
                transform: translateX(0);
                box-shadow: 3px 0 15px rgba(0,0,0,0.1);
            }
            
            .header {
                left: 0;
            }
            
            .main-content {
                margin-right: 0;
            }
            
            .close-sidebar {
                display: block;
            }
        }
        
        @media (max-width: 768px) {
            .dashboard-cards {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }
            
            .lists-container {
                grid-template-columns: 1fr;
            }
            
            .payment-options {
                flex-direction: column;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
            
            .cart-item {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .cart-item-price {
                margin-top: 15px;
                width: 100%;
                text-align: right;
            }
        }
        
        /* بۆستەی بچووک بۆ بەکارهێنان لە لیستەکان */
        .btn-sm {
            padding: 5px 10px;
            font-size: 0.8rem;
        }
        
        /* ستایل بۆ وێنە پیشبینین */
        .image-preview-container {
            width: 150px;
            height: 150px;
            border: 2px dashed var(--gray-light);
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            margin-top: 10px;
            background-color: var(--light);
        }
        
        .image-preview-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        /* ستایل بۆ وێنەی کاڵا لە لیست */
        .product-image-small {
            width: 50px;
            height: 50px;
            border-radius: 5px;
            object-fit: cover;
            margin-left: 10px;
        }
        
        /* ستایل بۆ وێنەی کاڵا لە سەبەتە */
        .cart-item-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 8px;
        }
        
        /* ستایل بۆ بارکۆد */
        .barcode-input {
            font-family: 'Courier New', monospace;
            letter-spacing: 2px;
        }
        
        /* بەشی مێژووی فرۆشتن */
        .sale-history-search {
            margin-bottom: 20px;
        }
        
        .history-item-actions {
            display: flex;
            gap: 5px;
            margin-top: 10px;
        }
        
        /* ستایل بۆ دەستکاری فاکتوور */
        .edit-invoice-container {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 30px;
            margin-bottom: 40px;
        }
        
        .edit-invoice-items {
            margin: 20px 0;
        }
        
        .edit-item-row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            padding: 10px;
            background-color: var(--gray-light);
            border-radius: var(--border-radius);
        }
        
        /* بەشی کڕین */
        .purchase-container {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 30px;
            margin-bottom: 40px;
        }
        
        .partner-search-container {
            margin-top: 20px;
            display: none;
        }
        
        .partner-search-container.active {
            display: block;
        }
    </style>
</head>
<body>
    <!-- پەڕەی چوونەژوورەوە -->
    <div id="loginPage" class="login-container">
        <div class="login-box">
            <div class="login-header">
                <div class="logo">الکترۆنیات</div>
                <h2>سیستەمی فرۆشتی ئەلکترۆنیات</h2>
                <p>تکایە ناوی بەکارهێنەر و وشەی نهێنی داخڵ بکە</p>
            </div>
            
            <form id="loginForm" class="login-form">
                <div class="input-group">
                    <label for="username"><i class="fas fa-user"></i> ناوی بەکارهێنەر</label>
                    <input type="text" id="username" placeholder="ناوی بەکارهێنەر" value="farzad">
                </div>
                
                <div class="input-group">
                    <label for="password"><i class="fas fa-lock"></i> وشەی نهێنی</label>
                    <input type="password" id="password" placeholder="وشەی نهێنی" value="farzad1234">
                </div>
                
                <div class="input-group remember">
                    <input type="checkbox" id="remember" checked>
                    <label for="remember">لەبیرم مەکە</label>
                </div>
                
                <button type="submit" class="login-btn">
                    <i class="fas fa-sign-in-alt"></i> چوونەژوورەوە
                </button>
                
                <div class="login-footer">
                    <p>وشەی نهێنیت لەبیرچووە؟ <a href="#">کلیک لێرە بکە</a></p>
                </div>
            </form>
            
            <div class="login-animation">
                <div class="circle"></div>
                <div class="circle"></div>
                <div class="circle"></div>
            </div>
        </div>
    </div>

    <!-- پەڕەی سەرەکی سیستم -->
    <div id="mainPage" class="container">
        <!-- بارەگەی لای چەپ -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h3>مێنیو</h3>
                <button class="close-sidebar" id="closeSidebar">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="#" class="nav-link active" data-section="dashboard">
                        <i class="fas fa-tachometer-alt"></i>
                        داشبۆرد
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="sales">
                        <i class="fas fa-shopping-cart"></i>
                        فرۆشتن
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="purchases">
                        <i class="fas fa-truck-loading"></i>
                        کڕین
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="cashSettlement">
                        <i class="fas fa-hand-holding-usd"></i>
                        واسڵکردنی پارە
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="inventory">
                        <i class="fas fa-warehouse"></i>
                        مخزن
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="customers">
                        <i class="fas fa-users"></i>
                        کەسەکان
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="partners">
                        <i class="fas fa-handshake"></i>
                        شەریکەکان
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="history">
                        <i class="fas fa-history"></i>
                        مێژوو
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="settings">
                        <i class="fas fa-cogs"></i>
                        رێکخستن
                    </a>
                </li>
            </ul>
        </aside>

        <!-- بەشی سەرەوە -->
        <header class="header" id="header">
            <div class="header-left">
                <button class="menu-toggle" id="menuToggle">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="logo">الکترۆنیات</div>
            </div>
            
            <div class="header-center">
                <h1>سیستەمی فرۆشتی ئەلکترۆنیات</h1>
            </div>
            
            <div class="header-right">
                <div class="user-info">
                    <i class="fas fa-user-circle"></i>
                    <span id="currentUser">فەرزاد</span>
                </div>
                <button class="logout-btn" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i> چوونەدەرەوە
                </button>
            </div>
        </header>

        <!-- بەشی ناوەڕاست -->
        <main class="main-content" id="mainContent">
            <!-- داشبۆرد -->
            <section id="dashboardSection" class="content-section active">
                <h2 class="section-title">داشبۆرد</h2>
                
                <div class="dashboard-cards">
                    <div class="card card-1">
                        <div class="card-icon">
                            <i class="fas fa-wallet"></i>
                        </div>
                        <h3>کۆی پارەی واسڵ کراو</h3>
                        <div class="card-value" id="cashBalanceDisplay">٠ <span>دینار</span></div>
                        <div class="card-change positive">
                            <i class="fas fa-arrow-up"></i> ٠٪ زیاتر لە هەفتەی ڕابردوو
                        </div>
                    </div>
                    
                    <div class="card card-2">
                        <div class="card-icon">
                            <i class="fas fa-shopping-cart"></i>
                        </div>
                        <h3>کۆی کڕین</h3>
                        <div class="card-value" id="totalPurchaseDisplay">٠ <span>دینار</span></div>
                        <div class="card-change negative">
                            <i class="fas fa-arrow-down"></i> ٠٪ کەمتر لە هەفتەی ڕابردوو
                        </div>
                    </div>
                    
                    <div class="card card-3">
                        <div class="card-icon">
                            <i class="fas fa-exchange-alt"></i>
                        </div>
                        <h3>جیاوازی کڕین و واسڵ کراو</h3>
                        <div class="card-value" id="differenceDisplay">٠ <span>دینار</span></div>
                        <div class="card-change positive">
                            <i class="fas fa-arrow-up"></i> ٠٪ زیاتر لە هەفتەی ڕابردوو
                        </div>
                    </div>
                    
                    <div class="card card-4">
                        <div class="card-icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <h3>کۆی کاڵای کەم بوو</h3>
                        <div class="card-value" id="lowStockCount">٠ <span>جۆر</span></div>
                        <div class="card-change positive">
                            <i class="fas fa-arrow-down"></i> ٠ جۆر کەمتر لە هەفتەی ڕابردوو
                        </div>
                    </div>
                    
                    <div class="card card-5">
                        <div class="card-icon">
                            <i class="fas fa-user-ow"></i>
                        </div>
                        <h3>کۆی پارەی قەرزداران</h3>
                        <div class="card-value" id="totalDebtDisplay">٠ <span>دینار</span></div>
                        <div class="card-change negative">
                            <i class="fas fa-arrow-up"></i> ٠٪ زیاتر لە هەفتەی ڕابردوو
                        </div>
                    </div>
                    
                    <div class="card card-6">
                        <div class="card-icon">
                            <i class="fas fa-handshake"></i>
                        </div>
                        <h3>قەرزدارم بە شەریکەکان</h3>
                        <div class="card-value" id="partnerDebtDisplay">٠ <span>دینار</span></div>
                        <div class="card-change positive">
                            <i class="fas fa-arrow-down"></i> ٠٪ کەمتر لە هەفتەی ڕابردوو
                        </div>
                    </div>
                    
                    <div class="card card-7">
                        <div class="card-icon">
                            <i class="fas fa-file-invoice-dollar"></i>
                        </div>
                        <h3>کۆی سەرفکردن (ئەم مانگە)</h3>
                        <div class="card-value" id="monthlyExpenseTotal">٠ <span>دینار</span></div>
                        <div class="card-change" id="expenseChange">
                            <i class="fas fa-minus"></i> ٠٪ جیاوازی لە مانگی ڕابردوو
                        </div>
                    </div>
                </div>
                
                <div class="lists-container">
                    <div class="list-box">
                        <div class="list-header">
                            <h3>کاڵای کەم بووەکان</h3>
                            <div class="list-actions">
                                <button id="refreshLowStock">نوێکردنەوە</button>
                            </div>
                        </div>
                        <ul class="list-items" id="lowStockList">
                            <!-- داتاکان لە JavaScript دا زیاد دەکرێن -->
                        </ul>
                    </div>
                    
                    <div class="list-box">
                        <div class="list-header">
                            <h3>قەرزدارانی ئەم هەفتەیە</h3>
                            <div class="list-actions">
                                <button id="refreshDebtors">نوێکردنەوە</button>
                            </div>
                        </div>
                        <ul class="list-items" id="debtorsList">
                            <!-- داتاکان لە JavaScript دا زیاد دەکرێن -->
                        </ul>
                    </div>
                </div>
            </section>

            <!-- بەشی فرۆشتن (نوێکراوە) -->
            <section id="salesSection" class="content-section">
                <h2 class="section-title">فرۆشتن</h2>
                
                <div class="sale-container">
                    <div class="tab-buttons">
                        <button class="tab-btn active" data-tab="newSale">فرۆشتی نوێ</button>
                        <button class="tab-btn" data-tab="saleHistory">مێژووی فرۆشتن</button>
                        <button class="tab-btn" data-tab="returnSale">گەڕانەوەی فرۆشتن</button>
                    </div>
                    
                    <!-- فرۆشتی نوێ -->
                    <div class="tab-content active" id="newSale">
                        <div class="search-container">
                            <div class="search-box">
                                <input type="text" id="productSearch" placeholder="گەڕان بەدوای ناوی کاڵا یان بارکۆد...">
                                <i class="fas fa-search"></i>
                                <div class="suggestions" id="productSuggestions"></div>
                            </div>
                        </div>
                        
                        <div class="cart-container">
                            <div class="cart-header">
                                <h3>سەبەتە</h3>
                                <button class="btn btn-danger btn-sm" id="clearCart">
                                    <i class="fas fa-trash"></i> پاککردنەوەی سەبەتە
                                </button>
                            </div>
                            
                            <ul class="cart-items" id="cartItems">
                                <!-- کاڵاکانی سەبەتە لێرە زیاد دەکرێن -->
                                <li class="empty-cart">هیچ کاڵایەک لە سەبەتەدا نییە</li>
                            </ul>
                            
                            <div class="cart-total" style="text-align: left; margin-bottom: 20px;">
                                <h3>کۆی گشتی: <span id="cartTotalAmount">٠</span> دینار</h3>
                            </div>
                            
                            <div class="payment-options">
                                <div class="payment-option selected" data-payment="cash">
                                    <i class="fas fa-money-bill-wave fa-2x"></i>
                                    <h4>نەقدی</h4>
                                    <p>پارەدان لە کاتی فرۆشتن</p>
                                </div>
                                <div class="payment-option" data-payment="credit">
                                    <i class="fas fa-file-invoice-dollar fa-2x"></i>
                                    <h4>قەرز</h4>
                                    <p>پارەدان لە داهاتوودا</p>
                                </div>
                            </div>
                            
                            <div class="customer-search-container" id="customerSelection">
                                <div class="search-box">
                                    <input type="text" id="customerSearch" placeholder="گەڕان بەدوای ناوی کەس...">
                                    <i class="fas fa-search"></i>
                                    <div class="suggestions" id="customerSuggestions"></div>
                                </div>
                            </div>
                            
                            <div class="action-buttons">
                                <button class="btn btn-warning" id="printInvoiceSmall">
                                    <i class="fas fa-print"></i> پرێنتی بچووک
                                </button>
                                <button class="btn btn-primary" id="printInvoiceA4">
                                    <i class="fas fa-print"></i> پرێنتی A4
                                </button>
                                <button class="btn btn-success" id="completeSale">
                                    <i class="fas fa-check-circle"></i> تەواوکردنی فرۆشتن
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- مێژووی فرۆشتن -->
                    <div class="tab-content" id="saleHistory">
                        <div class="search-container sale-history-search">
                            <div class="search-box">
                                <input type="text" id="saleHistorySearch" placeholder="گەڕان بە کۆدی فاکتوورە یان ناوی کەس...">
                                <i class="fas fa-search"></i>
                            </div>
                        </div>
                        
                        <div class="list-box">
                            <div class="list-header">
                                <h3>مێژووی فرۆشتن</h3>
                                <div class="list-actions">
                                    <button id="refreshSaleHistory">نوێکردنەوە</button>
                                </div>
                            </div>
                            <ul class="list-items" id="saleHistoryList">
                                <!-- مێژووی فرۆشتن لێرە زیاد دەکرێن -->
                            </ul>
                        </div>
                    </div>
                    
                    <!-- گەڕانەوەی فرۆشتن -->
                    <div class="tab-content" id="returnSale">
                        <div style="text-align: center; padding: 50px; color: var(--gray); background-color: white; border-radius: var(--border-radius); box-shadow: var(--box-shadow);">
                            <i class="fas fa-undo fa-4x" style="color: var(--primary); margin-bottom: 20px;"></i>
                            <h3 style="margin-bottom: 15px;">بەشی گەڕانەوەی فرۆشتن</h3>
                            <p style="margin-bottom: 20px;">ئەم بەشە لە وەشانی داهاتوودا بەردەست دەبێت.</p>
                            <p>لێرەدا گەڕانەوەی فرۆشتنەکان بەڕێوەدەبرێت.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- بەشی کڕین -->
            <section id="purchasesSection" class="content-section">
                <h2 class="section-title">کڕین</h2>
                
                <div class="purchase-container">
                    <div class="tab-buttons">
                        <button class="tab-btn active" data-tab="newPurchase">کڕینی نوێ</button>
                        <button class="tab-btn" data-tab="purchaseHistory">مێژووی کڕین</button>
                        <button class="tab-btn" data-tab="returnPurchase">گەڕانەوەی کڕین</button>
                    </div>
                    
                    <!-- کڕینی نوێ -->
                    <div class="tab-content active" id="newPurchase">
                        <div class="search-container">
                            <div class="search-box">
                                <input type="text" id="purchaseProductSearch" placeholder="گەڕان بەدوای ناوی کاڵا یان بارکۆد...">
                                <i class="fas fa-search"></i>
                                <div class="suggestions" id="purchaseProductSuggestions"></div>
                            </div>
                        </div>
                        
                        <div class="cart-container">
                            <div class="cart-header">
                                <h3>سەبەتە</h3>
                                <button class="btn btn-danger btn-sm" id="clearPurchaseCart">
                                    <i class="fas fa-trash"></i> پاککردنەوەی سەبەتە
                                </button>
                            </div>
                            
                            <ul class="cart-items" id="purchaseCartItems">
                                <!-- کاڵاکانی سەبەتەی کڕین لێرە زیاد دەکرێن -->
                                <li class="empty-cart">هیچ کاڵایەک لە سەبەتەدا نییە</li>
                            </ul>
                            
                            <div class="cart-total" style="text-align: left; margin-bottom: 20px;">
                                <h3>کۆی گشتی: <span id="purchaseCartTotalAmount">٠</span> دینار</h3>
                            </div>
                            
                            <div class="payment-options">
                                <div class="payment-option selected" data-payment="cash">
                                    <i class="fas fa-money-bill-wave fa-2x"></i>
                                    <h4>نەقدی</h4>
                                    <p>پارەدان لە کاتی کڕین</p>
                                </div>
                                <div class="payment-option" data-payment="credit">
                                    <i class="fas fa-file-invoice-dollar fa-2x"></i>
                                    <h4>قەرز</h4>
                                    <p>پارەدان لە داهاتوودا</p>
                                </div>
                            </div>
                            
                            <div class="partner-search-container" id="partnerSelection">
                                <div class="search-box">
                                    <input type="text" id="partnerSearchPurchase" placeholder="گەڕان بەدوای ناوی شەریک...">
                                    <i class="fas fa-search"></i>
                                    <div class="suggestions" id="partnerSuggestionsPurchase"></div>
                                </div>
                            </div>
                            
                            <div class="action-buttons">
                                <button class="btn btn-success" id="completePurchase">
                                    <i class="fas fa-check-circle"></i> تەواوکردنی کڕین
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- مێژووی کڕین -->
                    <div class="tab-content" id="purchaseHistory">
                        <div class="search-container sale-history-search">
                            <div class="search-box">
                                <input type="text" id="purchaseHistorySearch" placeholder="گەڕان بە کۆدی فاکتوورە یان ناوی شەریک...">
                                <i class="fas fa-search"></i>
                            </div>
                        </div>
                        
                        <div class="list-box">
                            <div class="list-header">
                                <h3>مێژووی کڕین</h3>
                                <div class="list-actions">
                                    <button id="refreshPurchaseHistory">نوێکردنەوە</button>
                                </div>
                            </div>
                            <ul class="list-items" id="purchaseHistoryList">
                                <!-- مێژووی کڕین لێرە زیاد دەکرێن -->
                            </ul>
                        </div>
                    </div>
                    
                    <!-- گەڕانەوەی کڕین -->
                    <div class="tab-content" id="returnPurchase">
                        <div style="text-align: center; padding: 50px; color: var(--gray); background-color: white; border-radius: var(--border-radius); box-shadow: var(--box-shadow);">
                            <i class="fas fa-exchange-alt fa-4x" style="color: var(--primary); margin-bottom: 20px;"></i>
                            <h3 style="margin-bottom: 15px;">بەشی گەڕانەوەی کڕین</h3>
                            <p style="margin-bottom: 20px;">ئەم بەشە لە وەشانی داهاتوودا بەردەست دەبێت.</p>
                            <p>لێرەدا گەڕانەوەی کڕینەکان بەڕێوەدەبرێت.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- بەشی واسڵکردنی پارە -->
            <section id="cashSettlementSection" class="content-section">
                <h2 class="section-title">واسڵکردنی پارە</h2>
                
                <div class="sale-container">
                    <div class="tab-buttons">
                        <button class="tab-btn active" data-tab="settlement">پارەواسڵکردن</button>
                        <button class="tab-btn" data-tab="expense">سەرفکردن</button>
                        <button class="tab-btn" data-tab="paymentHistory">مێژووی واسڵکردن</button>
                    </div>
                    
                    <!-- پارەواسڵکردن -->
                    <div class="tab-content active" id="settlement">
                        <div class="search-container">
                            <div class="search-box">
                                <input type="text" id="debtorSearch" placeholder="گەڕان بەدوای ناوی قەرزدار...">
                                <i class="fas fa-search"></i>
                                <div class="suggestions" id="debtorSuggestions"></div>
                            </div>
                        </div>
                        
                        <div id="debtorInfo" class="list-box" style="display: none; margin-top: 20px;">
                            <div class="list-header">
                                <h3>زانیاری قەرزدار</h3>
                            </div>
                            <div style="padding: 20px;">
                                <p><strong>ناوی قەرزدار:</strong> <span id="debtorName"></span></p>
                                <p><strong>کۆی قەرز:</strong> <span id="totalDebtAmount"></span></p>
                                <p><strong>کۆی پارەی واسڵکراو:</strong> <span id="totalPaidAmount">٠</span> دینار</p>
                            </div>
                        </div>
                        
                        <div class="item-form" style="margin-top: 30px;">
                            <h3 style="margin-bottom: 20px;">پارەواسڵکردن</h3>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="paymentAmountInput">بڕی پارە</label>
                                    <input type="number" id="paymentAmountInput" placeholder="بڕی پارە بە دینار" min="1">
                                </div>
                                
                                <div class="form-group">
                                    <label for="paymentDateInput">بەروار</label>
                                    <input type="date" id="paymentDateInput" value="${new Date().toISOString().split('T')[0]}">
                                </div>
                                
                                <div class="form-group">
                                    <label for="paymentMethodSelect">شێوازی پارەدان</label>
                                    <select id="paymentMethodSelect">
                                        <option value="cash">نەقدی</option>
                                        <option value="transfer">گوازینەوە</option>
                                        <option value="check">چەک</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="paymentNotesInput">تێبینی (ئارەزوومەندانە)</label>
                                <input type="text" id="paymentNotesInput" placeholder="تێبینی">
                            </div>
                            
                            <div class="action-buttons">
                                <button class="btn btn-success" id="submitPaymentBtn">
                                    <i class="fas fa-check-circle"></i> تۆمارکردنی پارەواسڵکردن
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- سەرفکردن -->
                    <div class="tab-content" id="expense">
                        <div class="item-form">
                            <h3 style="margin-bottom: 20px;">سەرفکردنی پارە</h3>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="expenseType">جۆری سەرفکردن</label>
                                    <select id="expenseType">
                                        <option value="partner">بۆ شەریک</option>
                                        <option value="customer">بۆ کەس</option>
                                        <option value="other">بۆ هۆکی تر</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label for="expenseAmount">بڕی سەرفکردن</label>
                                    <input type="number" id="expenseAmount" placeholder="بڕی پارە بە دینار" min="1">
                                </div>
                                
                                <div class="form-group">
                                    <label for="expenseDate">بەروار</label>
                                    <input type="date" id="expenseDate" value="${new Date().toISOString().split('T')[0]}">
                                </div>
                            </div>
                            
                            <!-- بەشی سەرف بۆ شەریک -->
                            <div id="expensePartnerSection" style="display: block;">
                                <div class="search-container">
                                    <div class="search-box">
                                        <input type="text" id="expensePartnerSearch" placeholder="گەڕان بەدوای ناوی شەریک...">
                                        <i class="fas fa-search"></i>
                                        <div class="suggestions" id="expensePartnerSuggestions"></div>
                                    </div>
                                </div>
                                
                                <div id="selectedPartnerInfo" style="display: none; margin-top: 20px;">
                                    <div class="list-box">
                                        <div class="list-header">
                                            <h3>زانیاری شەریک</h3>
                                        </div>
                                        <div style="padding: 15px;">
                                            <p><strong>ناوی شەریک:</strong> <span id="selectedPartnerName"></span></p>
                                            <p><strong>کۆی قەرز:</strong> <span id="selectedPartnerDebt"></span></p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- بەشی سەرف بۆ کەس -->
                            <div id="expenseCustomerSection" style="display: none;">
                                <div class="search-container">
                                    <div class="search-box">
                                        <input type="text" id="expenseCustomerSearch" placeholder="گەڕان بەدوای ناوی کەس...">
                                        <i class="fas fa-search"></i>
                                        <div class="suggestions" id="expenseCustomerSuggestions"></div>
                                    </div>
                                </div>
                                
                                <div id="selectedCustomerInfo" style="display: none; margin-top: 20px;">
                                    <div class="list-box">
                                        <div class="list-header">
                                            <h3>زانیاری کەس</h3>
                                        </div>
                                        <div style="padding: 15px;">
                                            <p><strong>ناوی کەس:</strong> <span id="selectedCustomerName"></span></p>
                                            <p><strong>کۆی قەرز:</strong> <span id="selectedCustomerDebt"></span></p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- بەشی سەرف بۆ هۆکی تر -->
                            <div id="expenseOtherSection" style="display: none;">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="expenseCategory">پۆلی سەرفکردن</label>
                                        <select id="expenseCategory">
                                            <option value="rent">کرێ</option>
                                            <option value="salary">مووچە</option>
                                            <option value="utility">کەرەستە</option>
                                            <option value="transport">گواستنەوە</option>
                                            <option value="maintenance">چاکسازی</option>
                                            <option value="marketing">بازرگانی</option>
                                            <option value="office">ئۆفیس</option>
                                            <option value="other">هی تر</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="expenseDescription">پێناسە (هۆکاری سەرفکردن)</label>
                                        <input type="text" id="expenseDescription" placeholder="پێناسەی سەرفکردن">
                                    </div>
                                </div>
                            </div>
                            
                            <div class="action-buttons">
                                <button class="btn btn-success" id="submitExpenseBtn">
                                    <i class="fas fa-check-circle"></i> تۆمارکردنی سەرفکردن
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- مێژووی واسڵکردن -->
                    <div class="tab-content" id="paymentHistory">
                        <div class="search-container sale-history-search">
                            <div class="search-box">
                                <input type="text" id="paymentHistorySearch" placeholder="گەڕان بەدوای ناوی قەرزدار...">
                                <i class="fas fa-search"></i>
                            </div>
                        </div>
                        
                        <div class="list-box">
                            <div class="list-header">
                                <h3>مێژووی پارەواسڵکردن</h3>
                                <div class="list-actions">
                                    <button id="refreshPaymentHistory">نوێکردنەوە</button>
                                </div>
                            </div>
                            <ul class="list-items" id="paymentHistoryList">
                                <!-- مێژووی پارەواسڵکردن لێرە زیاد دەکرێن -->
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- بەشی مخزن -->
            <section id="inventorySection" class="content-section">
                <h2 class="section-title">مخزن</h2>
                
                <div class="inventory-tabs">
                    <button class="inventory-tab active" data-inventory-tab="products">کاڵاکان</button>
                    <button class="inventory-tab" data-inventory-tab="categories">پۆلەکان</button>
                </div>
                
                <div class="inventory-content active" id="productsTab">
                    <div class="search-container">
                        <div class="search-box">
                            <input type="text" id="inventorySearch" placeholder="گەڕان بەدوای ناوی کاڵا...">
                            <i class="fas fa-search"></i>
                        </div>
                    </div>
                    
                    <div class="list-box" style="margin-bottom: 30px;">
                        <div class="list-header">
                            <h3>لیستی کاڵاکان</h3>
                            <div class="list-actions">
                                <button id="addProductBtn">زیادکردنی کاڵا</button>
                            </div>
                        </div>
                        <ul class="list-items" id="productList">
                            <!-- لیستی کاڵاکان لێرە زیاد دەکرێن -->
                        </ul>
                    </div>
                    
                    <div class="item-form" id="productForm" style="display: none;">
                        <h3 style="margin-bottom: 20px;">زیادکردن/گۆڕانکاری کاڵا</h3>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="productName">ناوی کاڵا</label>
                                <input type="text" id="productName" placeholder="ناوی کاڵا">
                            </div>
                            
                            <div class="form-group">
                                <label for="productBarcode">بارکۆد</label>
                                <input type="text" id="productBarcode" class="barcode-input" placeholder="بارکۆد" style="font-family: 'Courier New', monospace;">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="purchasePrice">نرخی کڕین</label>
                                <input type="number" id="purchasePrice" placeholder="نرخی کڕین">
                            </div>
                            
                            <div class="form-group">
                                <label for="salePrice">نرخی فرۆشتن</label>
                                <input type="number" id="salePrice" placeholder="نرخی فرۆشتن">
                            </div>
                            
                            <div class="form-group">
                                <label for="stockQuantity">بڕی کاڵا</label>
                                <input type="number" id="stockQuantity" placeholder="بڕی کاڵا">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="primaryUnit">یەکەی سەرەکی</label>
                                <select id="primaryUnit">
                                    <option value="piece">پارچە</option>
                                    <option value="carton">کارتۆن</option>
                                    <option value="unit">دانە</option>
                                    <option value="meter">مەتر</option>
                                    <option value="kg">کیلۆ</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="secondaryUnit">یەکەی دووەم (ئارەزوومەندانە)</label>
                                <select id="secondaryUnit">
                                    <option value="">هیچ</option>
                                    <option value="piece">پارچە</option>
                                    <option value="carton">کارتۆن</option>
                                    <option value="unit">دانە</option>
                                    <option value="meter">مەتر</option>
                                    <option value="kg">کیلۆ</option>
                                    <option value="box">بۆکس</option>
                                    <option value="pack">پاکەت</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="secondaryUnitQuantity">بڕ لە یەکەی دووەم (ئەگەر هەیە)</label>
                                <input type="number" id="secondaryUnitQuantity" placeholder="بڕ لە یەکەی دووەم">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="productImage">وێنەی کاڵا (ئارەزوومەندانە)</label>
                                <input type="file" id="productImage" accept="image/*" style="padding: 8px;">
                                <small style="color: var(--gray);">رێگەپێدراو: JPG, PNG, GIF</small>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>پێشبینینی وێنە</label>
                            <div id="imagePreview" class="image-preview-container">
                                <p style="color: var(--gray); font-size: 0.9rem;">هیچ وێنەیەک نییە</p>
                            </div>
                        </div>
                        
                        <div class="action-buttons">
                            <button class="btn btn-danger" id="cancelProductBtn">پاشگەزبوونەوە</button>
                            <button class="btn btn-success" id="saveProductBtn">هەڵگرتن</button>
                        </div>
                    </div>
                </div>
                
                <div class="inventory-content" id="categoriesTab">
                    <div style="text-align: center; padding: 50px; color: var(--gray); background-color: white; border-radius: var(--border-radius); box-shadow: var(--box-shadow);">
                        <i class="fas fa-tags fa-4x" style="color: var(--primary); margin-bottom: 20px;"></i>
                        <h3 style="margin-bottom: 15px;">پۆلەکانی کاڵاکان</h3>
                        <p style="margin-bottom: 20px;">ئەم بەشە لە وەشانی داهاتوودا بەردەست دەبێت.</p>
                        <p>لێرەدا پۆلەکانی کاڵاکان بەڕێوەدەبرێن.</p>
                    </div>
                </div>
            </section>
            
            <!-- بەشی کەسەکان -->
            <section id="customersSection" class="content-section">
                <h2 class="section-title">کەسەکان</h2>
                
                <div class="sale-container">
                    <div class="tab-buttons">
                        <button class="tab-btn active" data-tab="customersList">لیستی کەسەکان</button>
                        <button class="tab-btn" data-tab="addCustomer">زیادکردنی کەس</button>
                    </div>
                    
                    <div class="tab-content active" id="customersList">
                        <div class="search-container">
                            <div class="search-box">
                                <input type="text" id="customerSearchMain" placeholder="گەڕان بەدوای ناوی کەس...">
                                <i class="fas fa-search"></i>
                                <div class="suggestions" id="customerSearchSuggestions"></div>
                            </div>
                        </div>
                        
                        <div class="list-box" style="margin-top: 20px;">
                            <div class="list-header">
                                <h3>لیستی کەسەکان</h3>
                                <div class="list-actions">
                                    <button id="refreshCustomers">نوێکردنەوە</button>
                                    <button id="addCustomerBtn">زیادکردنی کەس</button>
                                </div>
                            </div>
                            <ul class="list-items" id="customersMainList">
                                <!-- لیستی کەسەکان لێرە زیاد دەکرێن -->
                            </ul>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="addCustomer">
                        <div class="item-form">
                            <h3 style="margin-bottom: 20px;">زیادکردنی کەسی نوێ</h3>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="newCustomerName">ناوی کەس</label>
                                    <input type="text" id="newCustomerName" placeholder="ناوی کەس">
                                </div>
                                
                                <div class="form-group">
                                    <label for="newCustomerPhone">ژمارەی موبایل</label>
                                    <input type="text" id="newCustomerPhone" placeholder="٠٧٧٠١٢٣٤٥٦٧">
                                </div>
                                
                                <div class="form-group">
                                    <label for="newCustomerAddress">ناونیشان (ئارەزوومەندانە)</label>
                                    <input type="text" id="newCustomerAddress" placeholder="ناونیشان">
                                </div>
                            </div>
                            
                            <div class="action-buttons">
                                <button class="btn btn-danger" id="cancelCustomerBtn">پاشگەزبوونەوە</button>
                                <button class="btn btn-success" id="saveCustomerBtn">هەڵگرتن</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- بەشی شەریکەکان -->
            <section id="partnersSection" class="content-section">
                <h2 class="section-title">شەریکەکان</h2>
                
                <div class="sale-container">
                    <div class="tab-buttons">
                        <button class="tab-btn active" data-tab="partnersList">لیستی شەریکەکان</button>
                        <button class="tab-btn" data-tab="addPartner">زیادکردنی شەریک</button>
                    </div>
                    
                    <div class="tab-content active" id="partnersList">
                        <div class="search-container">
                            <div class="search-box">
                                <input type="text" id="partnerSearch" placeholder="گەڕان بەدوای ناوی شەریک...">
                                <i class="fas fa-search"></i>
                            </div>
                        </div>
                        
                        <div class="list-box" style="margin-top: 20px;">
                            <div class="list-header">
                                <h3>لیستی شەریکەکان</h3>
                                <div class="list-actions">
                                    <button id="refreshPartners">نوێکردنەوە</button>
                                    <button id="addPartnerBtn">زیادکردنی شەریک</button>
                                </div>
                            </div>
                            <ul class="list-items" id="partnersListItems">
                                <!-- لیستی شەریکەکان لێرە زیاد دەکرێن -->
                            </ul>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="addPartner">
                        <div class="item-form">
                            <h3 style="margin-bottom: 20px;">زیادکردنی شەریکی نوێ</h3>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="newPartnerName">ناوی شەریک</label>
                                    <input type="text" id="newPartnerName" placeholder="ناوی شەریک">
                                </div>
                                
                                <div class="form-group">
                                    <label for="newPartnerPhone">ژمارەی موبایل</label>
                                    <input type="text" id="newPartnerPhone" placeholder="٠٧٧٠١٢٣٤٥٦٧">
                                </div>
                                
                                <div class="form-group">
                                    <label for="newPartnerAddress">ناونیشان (ئارەزوومەندانە)</label>
                                    <input type="text" id="newPartnerAddress" placeholder="ناونیشان">
                                </div>
                            </div>
                            
                            <div class="action-buttons">
                                <button class="btn btn-danger" id="cancelPartnerBtn">پاشگەزبوونەوە</button>
                                <button class="btn btn-success" id="savePartnerBtn">هەڵگرتن</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- بەشی مێژوو -->
            <section id="historySection" class="content-section">
                <h2 class="section-title">مێژوو</h2>
                <p style="text-align: center; padding: 40px; color: var(--gray);">
                    بەشی مێژوو لێرە دەبێت کە مێژووی هەموو فرۆشتن و کڕین و پارەواسڵکردنەکان تێدا بێت.
                </p>
            </section>

            <!-- بەشی رێکخستن -->
            <section id="settingsSection" class="content-section">
                <h2 class="section-title">رێکخستن</h2>
                <div style="text-align: center; padding: 50px; color: var(--gray); background-color: white; border-radius: var(--border-radius); box-shadow: var(--box-shadow);">
                    <i class="fas fa-cogs fa-4x" style="color: var(--primary); margin-bottom: 20px;"></i>
                    <h3 style="margin-bottom: 15px;">بەشی رێکخستن</h3>
                    <p style="margin-bottom: 20px;">ئەم بەشە لە وەشانی داهاتوودا بەردەست دەبێت.</p>
                    <p>لێرەدا هەموو رێکخستنەکانی سیستم بەڕێوەدەبرێن.</p>
                </div>
            </section>
        </main>
    </div>

    <!-- مۆدالی پرێنت -->
    <div class="modal" id="printModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>پرێنتکردنی فاکتوور</h3>
                <button class="modal-close" id="closePrintModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="invoice">
                    <div class="invoice-header">
                        <div class="invoice-logo">الکترۆنیات</div>
                        <h2>فاکتووری فرۆشتن</h2>
                        <p>کۆدی فاکتوورە: <span id="invoiceCode">INV-2023-001</span></p>
                        <p>بەروار: <span id="invoiceDate">٢٠٢٣/١٢/١٥</span></p>
                    </div>
                    
                    <div class="invoice-details">
                        <div>
                            <h4>زانیاری فرۆشەر:</h4>
                            <p>ناوی سیستەم: الکترۆنیات</p>
                            <p>ژمارەی موبایل: ٠٧٧٠١٢٣٤٥٦٧</p>
                            <p>ناونیشان: هەولێر، کوردستان</p>
                        </div>
                        
                        <div>
                            <h4>زانیاری کڕیار:</h4>
                            <p id="customerName">ناوی کڕیار: عەلی محەممەد</p>
                            <p id="customerPhone">ژمارەی موبایل: ٠٧٧٠٧٦٥٤٣٢١</p>
                            <p id="customerAddress">ناونیشان: نەزانراو</p>
                        </div>
                    </div>
                    
                    <table class="invoice-table">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>ناوی کاڵا</th>
                                <th>یەکە</th>
                                <th>بڕ</th>
                                <th>نرخ</th>
                                <th>کۆی گشتی</th>
                            </tr>
                        </thead>
                        <tbody id="invoiceItems">
                            <!-- کاڵاکانی فاکتوور لێرە زیاد دەکرێن -->
                        </tbody>
                    </table>
                    
                    <div class="invoice-total">
                        <p><strong>کۆی گشتی:</strong> <span id="invoiceTotal">٠ دینار</span></p>
                        <p><strong>قەرزی پێشوو:</strong> <span id="previousDebt">٠ دینار</span></p>
                        <p><strong>قەرزی ئێستا:</strong> <span id="currentDebt">٠ دینار</span></p>
                        <p><strong>کۆی قەرزی دوای فرۆشتن:</strong> <span id="totalDebt">٠ دینار</span></p>
                    </div>
                    
                    <div class="print-options">
                        <button class="btn btn-warning" id="printSmall">
                            <i class="fas fa-print"></i> پرێنتی بچووک
                        </button>
                        <button class="btn btn-primary" id="printA4">
                            <i class="fas fa-print"></i> پرێنتی A4
                        </button>
                        <button class="btn btn-danger" id="closeInvoice">
                            <i class="fas fa-times"></i> داخستن
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- مۆدالی بینینی و بەڕێوەبردنی کەس -->
    <div class="modal" id="customerModal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h3>زانیاری کەس: <span id="modalCustomerName">عەلی محەممەد</span></h3>
                <button class="modal-close" id="closeCustomerModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="tab-buttons">
                    <button class="tab-btn active" data-customer-tab="info">زانیاری کەس</button>
                    <button class="tab-btn" data-customer-tab="debt">پارەواسڵکردن</button>
                    <button class="tab-btn" data-customer-tab="invoices">فاکتوورەکان</button>
                </div>
                
                <div class="tab-content active" id="customerInfoTab">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="editCustomerName">ناوی کەس</label>
                            <input type="text" id="editCustomerName" placeholder="ناوی کەس">
                        </div>
                        
                        <div class="form-group">
                            <label for="editCustomerPhone">ژمارەی موبایل</label>
                            <input type="text" id="editCustomerPhone" placeholder="٠٧٧٠١٢٣٤٥٦٧">
                        </div>
                        
                        <div class="form-group">
                            <label for="editCustomerAddress">ناونیشان</label>
                            <input type="text" id="editCustomerAddress" placeholder="ناونیشان">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="customerTotalDebt">کۆی قەرز</label>
                            <input type="text" id="customerTotalDebt" readonly style="background-color: var(--gray-light);">
                        </div>
                        
                        <div class="form-group">
                            <label for="customerLastPurchase">کۆتا فرۆشتن</label>
                            <input type="text" id="customerLastPurchase" readonly style="background-color: var(--gray-light);">
                        </div>
                        
                        <div class="form-group">
                            <label for="customerTotalPurchases">کۆی فرۆشتن</label>
                            <input type="text" id="customerTotalPurchases" readonly style="background-color: var(--gray-light);">
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn btn-danger" id="deleteCustomerBtn">
                            <i class="fas fa-trash"></i> سڕینەوەی کەس
                        </button>
                        <button class="btn btn-warning" id="printCustomerInfo">
                            <i class="fas fa-print"></i> پرێنتکردنی زانیاری
                        </button>
                        <button class="btn btn-success" id="saveCustomerChanges">
                            <i class="fas fa-save"></i> هەڵگرتنی گۆڕانکاریەکان
                        </button>
                    </div>
                </div>
                
                <div class="tab-content" id="customerDebtTab">
                    <div class="payment-container">
                        <h4 style="margin-bottom: 20px;">پارەواسڵکردن بۆ کەسەکە</h4>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="paymentAmount">بڕی پارە</label>
                                <input type="number" id="paymentAmount" placeholder="بڕی پارە بە دینار">
                            </div>
                            
                            <div class="form-group">
                                <label for="paymentDate">بەروار</label>
                                <input type="date" id="paymentDate">
                            </div>
                            
                            <div class="form-group">
                                <label for="paymentMethod">شێوازی پارەدان</label>
                                <select id="paymentMethod">
                                    <option value="cash">نەقدی</option>
                                    <option value="transfer">گوازینەوە</option>
                                    <option value="check">چەک</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="paymentNotes">تێبینی (ئارەزوومەندانە)</label>
                            <input type="text" id="paymentNotes" placeholder="تێبینی">
                        </div>
                        
                        <div class="action-buttons">
                            <button class="btn btn-success" id="submitPaymentBtnModal">
                                <i class="fas fa-check-circle"></i> تۆمارکردنی پارەواسڵکردن
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="tab-content" id="customerInvoicesTab">
                    <div class="search-container">
                        <div class="search-box">
                            <input type="text" id="customerInvoiceSearch" placeholder="گەڕان بە کۆدی فاکتوورە...">
                            <i class="fas fa-search"></i>
                        </div>
                    </div>
                    
                    <div class="list-box" style="margin-top: 20px;">
                        <div class="list-header">
                            <h3>فاکتوورەکانی کەسەکە</h3>
                            <div class="list-actions">
                                <button id="refreshCustomerInvoices">نوێکردنەوە</button>
                            </div>
                        </div>
                        <ul class="list-items" id="customerInvoicesList">
                            <!-- فاکتوورەکانی کەس لێرە زیاد دەکرێن -->
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- مۆدالی بینینی فاکتوور -->
    <div class="modal" id="invoiceDetailModal">
        <div class="modal-content" style="max-width: 1000px;">
            <div class="modal-header">
                <h3>فاکتوور: <span id="modalInvoiceCode">INV-2023-001</span></h3>
                <button class="modal-close" id="closeInvoiceModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="invoice" id="invoiceDetailContent">
                    <!-- نەخشەی فاکتوور لێرە کۆپی دەکرێت -->
                </div>
                
                <div class="print-options" style="margin-top: 30px;">
                    <button class="btn btn-warning" id="printInvoiceSmallDetail">
                        <i class="fas fa-print"></i> پرێنتی بچووک
                    </button>
                    <button class="btn btn-primary" id="printInvoiceA4Detail">
                        <i class="fas fa-print"></i> پرێنتی A4
                    </button>
                    <button class="btn btn-danger" id="deleteInvoiceBtn">
                        <i class="fas fa-trash"></i> سڕینەوەی فاکتوور
                    </button>
                    <button class="btn btn-info" id="editInvoiceBtn">
                        <i class="fas fa-edit"></i> گۆڕانکاری فاکتوور
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- مۆدالی دەستکاری فاکتوور -->
    <div class="modal" id="editInvoiceModal">
        <div class="modal-content" style="max-width: 1000px;">
            <div class="modal-header">
                <h3>گۆڕانکاری فاکتوور: <span id="editInvoiceCode">INV-2023-001</span></h3>
                <button class="modal-close" id="closeEditInvoiceModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="edit-invoice-container">
                    <div class="search-container">
                        <div class="search-box">
                            <input type="text" id="editProductSearch" placeholder="گەڕان بەدوای کاڵا بۆ زیادکردن...">
                            <i class="fas fa-search"></i>
                            <div class="suggestions" id="editProductSuggestions"></div>
                        </div>
                    </div>
                    
                    <div class="cart-container">
                        <div class="cart-header">
                            <h3>کاڵاکانی فاکتوور</h3>
                        </div>
                        
                        <ul class="cart-items" id="editCartItems">
                            <!-- کاڵاکانی فاکتوور لێرە زیاد دەکرێن -->
                        </ul>
                        
                        <div class="cart-total" style="text-align: left; margin-bottom: 20px;">
                            <h3>کۆی گشتی: <span id="editCartTotalAmount">٠</span> دینار</h3>
                        </div>
                        
                        <div class="search-container" style="margin-top: 20px;">
                            <div class="search-box">
                                <input type="text" id="editCustomerSearch" placeholder="گەڕان بەدوای کەسی تر...">
                                <i class="fas fa-search"></i>
                                <div class="suggestions" id="editCustomerSuggestions"></div>
                            </div>
                        </div>
                        
                        <div class="action-buttons" style="margin-top: 30px;">
                            <button class="btn btn-danger" id="cancelEditInvoice">
                                پاشگەزبوونەوە
                            </button>
                            <button class="btn btn-success" id="saveEditInvoice">
                                <i class="fas fa-save"></i> هەڵگرتنی گۆڕانکاریەکان
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- هەموو JavaScript لێرە -->
    <script>
        // داتای نموونەیی بۆ سیستمەکە
        const sampleData = {
            products: [],
            customers: [],
            partners: [],
            sales: [],
            purchases: [],
            cashBalance: 0,
            expenseHistory: [],
            paymentHistory: []
        };

        // داتای نموونەیی بۆ مێژووی کڕین
        const samplePurchaseData = {
            purchases: []
        };

        // دۆمینەکان
        let currentUser = null;
        let cart = [];
        let purchaseCart = [];
        let selectedPayment = "cash";
        let selectedCustomer = null;
        let selectedPartner = null;
        let editingProductId = null;
        let editingInvoiceId = null;

        // کۆدی چوونەژوورەوە
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            // چێکی کردنی ناوی بەکارهێنەر و وشەی نهێنی
            if (username && password) {
                // فەرزاد یان admin دەتوانن بچنە ژوورەوە
                if ((username === 'farzad' && password === 'farzad1234') || 
                    (username === 'admin' && password === 'admin123') ||
                    (username === 'user' && password === 'user123')) {
                    currentUser = username;
                    
                    // نیشاندانی پەڕەی سەرەکی و شاردنەوەی پەڕەی چوونەژوورەوە
                    document.getElementById('loginPage').style.display = 'none';
                    document.getElementById('mainPage').style.display = 'flex';
                    
                    // زیادکردنی ناوی بەکارهێنەر
                    const userNames = {
                        'farzad': 'فەرزاد',
                        'admin': 'ئەدمین',
                        'user': 'بەکارهێنەر'
                    };
                    document.getElementById('currentUser').textContent = userNames[username] || username;
                    
                    // زیادکردنی داتای نموونەیی سادە بۆ ئەزموونکردن
                    addSampleDataForTesting();
                    
                    // چالاککردنی داشبۆرد وەک یەکەم بەش
                    showSection('dashboard');
                    
                    // چالاککردنی پیشبینینی وێنە
                    setupImagePreview();
                } else {
                    alert('ناوی بەکارهێنەر یان وشەی نهێنی هەڵەە! تکایە دووبارە هەوڵ بدەرەوە.\n\nتێبینی:\nناوی بەکارهێنەر: farzad، وشەی نهێنی: farzad1234\nیان\nناوی بەکارهێنەر: admin، وشەی نهێنی: admin123\nیان\nناوی بەکارهێنەر: user، وشەی نهێنی: user123');
                }
            } else {
                alert('تکایە هەردوو خانە پڕ بکەرەوە!');
            }
        });

        // فەنکشنی زیادکردنی داتای نموونەیی سادە بۆ ئەزموونکردن
        function addSampleDataForTesting() {
            // زیادکردنی کۆی پارەی سەرەتا
            sampleData.cashBalance = 10000000; // 10 ملیۆن دینار
            
            // زیادکردنی کەس و شەریکی نموونەیی
            sampleData.customers = [
                { id: 1, name: "عەلی محەممەد", phone: "07701234567", address: "هەولێر", debt: 50000 },
                { id: 2, name: "حوسێن عەلی", phone: "07707654321", address: "سلێمانی", debt: 25000 },
                { id: 3, name: "کەریم عەبدوڵا", phone: "07709876543", address: "دهۆک", debt: 0 }
            ];
            
            sampleData.partners = [
                { id: 1, name: "کۆمپانیای ئەلکترۆنی", phone: "07701112233", address: "بەغدا", debt: -150000 },
                { id: 2, name: "کۆمپانیای کاڵا", phone: "07702223344", address: "هەولێر", debt: 75000 },
                { id: 3, name: "کۆمپانیای تەکنۆلۆژیا", phone: "07703334455", address: "سلێمانی", debt: 0 }
            ];
            
            // زیادکردنی کاڵای نموونەیی
            sampleData.products = [
                { 
                    id: 1, 
                    name: "مۆبایل سامسۆنگ A14", 
                    barcode: "BR1001", 
                    purchasePrice: 500000, 
                    salePrice: 600000, 
                    stock: 10, 
                    unit: "piece",
                    secondaryUnit: "",
                    secondaryUnitQuantity: 0,
                    image: null
                },
                { 
                    id: 2, 
                    name: "تەلەفزیۆن ئێڵ جی 55 ئینج", 
                    barcode: "BR1002", 
                    purchasePrice: 800000, 
                    salePrice: 950000, 
                    stock: 5, 
                    unit: "piece",
                    secondaryUnit: "",
                    secondaryUnitQuantity: 0,
                    image: null
                },
                { 
                    id: 3, 
                    name: "سەرعەی بێلایین", 
                    barcode: "BR1003", 
                    purchasePrice: 75000, 
                    salePrice: 90000, 
                    stock: 20, 
                    unit: "piece",
                    secondaryUnit: "",
                    secondaryUnitQuantity: 0,
                    image: null
                },
                { 
                    id: 4, 
                    name: "لاپتۆپ دێل", 
                    barcode: "BR1004", 
                    purchasePrice: 1200000, 
                    salePrice: 1500000, 
                    stock: 3, 
                    unit: "piece",
                    secondaryUnit: "",
                    secondaryUnitQuantity: 0,
                    image: null
                },
                { 
                    id: 5, 
                    name: "مایکرۆوەیڤ", 
                    barcode: "BR1005", 
                    purchasePrice: 300000, 
                    salePrice: 350000, 
                    stock: 8, 
                    unit: "piece",
                    secondaryUnit: "",
                    secondaryUnitQuantity: 0,
                    image: null
                }
            ];
            
            // زیادکردنی فرۆشتنەکانی نموونەیی
            sampleData.sales = [
                {
                    id: 1,
                    code: "INV-2023-001",
                    customer: "عەلی محەممەد",
                    date: "2023-12-15",
                    total: 600000,
                    payment: "cash",
                    items: ["مۆبایل سامسۆنگ A14"],
                    originalItems: [
                        { id: 1, name: "مۆبایل سامسۆنگ A14", quantity: 1, price: 600000, unit: "piece" }
                    ]
                },
                {
                    id: 2,
                    code: "INV-2023-002",
                    customer: "حوسێن عەلی",
                    date: "2023-12-14",
                    total: 950000,
                    payment: "credit",
                    items: ["تەلەفزیۆن ئێڵ جی 55 ئینج"],
                    originalItems: [
                        { id: 2, name: "تەلەفزیۆن ئێڵ جی 55 ئینج", quantity: 1, price: 950000, unit: "piece" }
                    ]
                }
            ];
            
            // زیادکردنی کڕینەکانی نموونەیی
            samplePurchaseData.purchases = [
                {
                    id: 1,
                    code: "PUR-2023-001",
                    partner: "کۆمپانیای ئەلکترۆنی",
                    date: "2023-12-10",
                    total: 2500000,
                    payment: "credit",
                    items: [
                        { id: 1, name: "مۆبایل سامسۆنگ A14", quantity: 5, price: 500000, unit: "piece" },
                        { id: 3, name: "سەرعەی بێلایین", quantity: 10, price: 75000, unit: "piece" }
                    ]
                }
            ];
            
            // نوێکردنەوەی داشبۆرد
            populateSampleData();
            
            alert('داتای نموونەیی بۆ تاقیکردنەوە زیاد کرا!');
        }

        // فەنکشنی نیشاندانی بەش
        function showSection(sectionId) {
            // لابردنی چالاکی لە هەموو بەشەکان
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // لابردنی چالاکی لە هەموو بەستەرەکانی مێنیو
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            // زیادکردنی چالاکی بۆ بەشەکە
            const sectionElement = document.getElementById(sectionId + 'Section');
            if (sectionElement) {
                sectionElement.classList.add('active');
            }
            
            // زیادکردنی چالاکی بۆ بەستەری مێنیو
            const navLink = document.querySelector(`.nav-link[data-section="${sectionId}"]`);
            if (navLink) {
                navLink.classList.add('active');
            }
            
            // داخستنی مێنیو لەسەر مۆبایل
            if (window.innerWidth <= 992) {
                document.getElementById('sidebar').classList.remove('active');
            }
            
            // نوێکردنەوەی داشبۆرد کاتێ بەشی داشبۆرد پیشان دەدرێ
            if (sectionId === 'dashboard') {
                populateSampleData();
            }
            
            // نوێکردنەوەی مێژووی فرۆشتن کاتێ بەشی فرۆشتن پیشان دەدرێ
            if (sectionId === 'sales') {
                populateSaleHistory();
            }
            
            // نوێکردنەوەی مێژووی کڕین کاتێ بەشی کڕین پیشان دەدرێ
            if (sectionId === 'purchases') {
                populatePurchaseHistory();
            }
        }

        // چوونەدەرەوە
        document.getElementById('logoutBtn').addEventListener('click', function() {
            currentUser = null;
            cart = [];
            purchaseCart = [];
            selectedCustomer = null;
            selectedPartner = null;
            selectedPayment = "cash";
            editingProductId = null;
            editingInvoiceId = null;
            
            document.getElementById('mainPage').style.display = 'none';
            document.getElementById('loginPage').style.display = 'flex';
            
            // پاککردنەوەی خانەکانی چوونەژوورەوە
            document.getElementById('username').value = 'farzad';
            document.getElementById('password').value = 'farzad1234';
            
            // پاککردنەوەی سەبەتە
            updateCartDisplay();
            updatePurchaseCartDisplay();
            
            // پاککردنەوەی هەڵبژاردنەکانی پارەدان
            document.querySelectorAll('.payment-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            document.querySelector('.payment-option[data-payment="cash"]').classList.add('selected');
            document.getElementById('customerSelection').style.display = 'none';
            document.getElementById('partnerSelection').style.display = 'none';
            if (document.getElementById('customerSearch')) {
                document.getElementById('customerSearch').value = '';
            }
            if (document.getElementById('partnerSearchPurchase')) {
                document.getElementById('partnerSearchPurchase').value = '';
            }
        });

        // نوێکردنەوەی کۆی پارە لە داشبۆرد
        function updateDashboardCash() {
            const cashCard = document.getElementById('cashBalanceDisplay');
            if (cashCard) {
                cashCard.innerHTML = `${sampleData.cashBalance.toLocaleString()} <span>دینار</span>`;
            }
        }

        // فەنکشنی هەژمارکردنی کۆی سەرفکردنی مانگی ئێستا
        function calculateMonthlyExpense() {
            const now = new Date();
            const currentMonth = now.getMonth();
            const currentYear = now.getFullYear();
            
            const monthlyExpenses = sampleData.expenseHistory.filter(expense => {
                const expenseDate = new Date(expense.date);
                return expenseDate.getMonth() === currentMonth && 
                       expenseDate.getFullYear() === currentYear;
            });
            
            const total = monthlyExpenses.reduce((sum, expense) => sum + expense.amount, 0);
            
            // نیشاندانی لە داشبۆرد
            const monthlyExpenseElement = document.getElementById('monthlyExpenseTotal');
            const expenseChangeElement = document.getElementById('expenseChange');
            
            if (monthlyExpenseElement) {
                monthlyExpenseElement.innerHTML = `${total.toLocaleString()} <span>دینار</span>`;
            }
        }

        // فەنکشنی پێشبینینی وێنە
        function setupImagePreview() {
            const imageInput = document.getElementById('productImage');
            const imagePreview = document.getElementById('imagePreview');
            
            if (imageInput && imagePreview) {
                imageInput.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        // پشکنینی جۆری فایل
                        const validTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif'];
                        if (!validTypes.includes(file.type)) {
                            alert('تەنها فایلی وێنە (JPG, PNG, GIF) قبوڵکراوە!');
                            this.value = '';
                            return;
                        }
                        
                        // پشکنینی قەبارەی فایل (زیاتر لە 5MB نەبێت)
                        if (file.size > 5 * 1024 * 1024) {
                            alert('قەبارەی وێنە نابێت لە 5MB زیاتر بێت!');
                            this.value = '';
                            return;
                        }
                        
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            imagePreview.innerHTML = `<img src="${e.target.result}" alt="پێشبینینی وێنە">`;
                        };
                        reader.readAsDataURL(file);
                    } else {
                        imagePreview.innerHTML = '<p style="color: var(--gray); font-size: 0.9rem;">هیچ وێنەیەک نییە</p>';
                    }
                });
            }
        }

        // زیادکردنی داتای نموونەیی
        function populateSampleData() {
            // زیادکردنی کاڵای کەم بووەکان
            const lowStockList = document.getElementById('lowStockList');
            if (lowStockList) {
                lowStockList.innerHTML = '';
                
                const lowStockProducts = sampleData.products.filter(p => p.stock <= 5);
                
                if (lowStockProducts.length === 0) {
                    lowStockList.innerHTML = '<li class="list-item">هیچ کاڵایەک کەم نییە</li>';
                } else {
                    lowStockProducts.forEach(product => {
                        const li = document.createElement('li');
                        li.className = 'list-item';
                        li.innerHTML = `
                            <div class="item-name">${product.name}</div>
                            <div class="item-value">${product.stock} ${getUnitName(product.unit)}</div>
                        `;
                        lowStockList.appendChild(li);
                    });
                }
                
                // نوێکردنەوەی ژمارەی کاڵای کەم بوو
                const lowStockCount = document.getElementById('lowStockCount');
                if (lowStockCount) {
                    lowStockCount.innerHTML = `${lowStockProducts.length} <span>جۆر</span>`;
                }
            }
            
            // زیادکردنی قەرزدارەکان
            const debtorsList = document.getElementById('debtorsList');
            if (debtorsList) {
                debtorsList.innerHTML = '';
                
                // قەرزدارەکان بریتین لە: کەسەکان کە قەرزداری منن (قەرز +) و شەریکەکان کە من قەرزداری ئەوانم (قەرز -)
                const allDebtors = [
                    ...sampleData.customers.filter(c => c.debt > 0).map(c => ({
                        name: c.name,
                        debt: c.debt,
                        type: 'کەس',
                        debtClass: 'debt-positive'
                    })),
                    ...sampleData.partners.filter(p => p.debt < 0).map(p => ({
                        name: p.name,
                        debt: Math.abs(p.debt),
                        type: 'شەریک',
                        debtClass: 'debt-negative'
                    }))
                ];
                
                if (allDebtors.length === 0) {
                    debtorsList.innerHTML = '<li class="list-item">هیچ قەرزدارێک نییە</li>';
                } else {
                    allDebtors.forEach(debtor => {
                        const li = document.createElement('li');
                        li.className = 'list-item';
                        li.innerHTML = `
                            <div class="item-name">${debtor.name} (${debtor.type})</div>
                            <div class="item-value ${debtor.debtClass}">${debtor.debt.toLocaleString()} دینار</div>
                        `;
                        debtorsList.appendChild(li);
                    });
                }
            }
            
            // زیادکردنی لیستی کاڵاکان بۆ مخزن
            const productList = document.getElementById('productList');
            if (productList) {
                productList.innerHTML = '';
                
                if (sampleData.products.length === 0) {
                    productList.innerHTML = '<li class="list-item">هیچ کاڵایەک نییە. دەتوانی یەکەم کاڵا زیاد بکەی!</li>';
                } else {
                    sampleData.products.forEach(product => {
                        const li = document.createElement('li');
                        li.className = 'list-item';
                        
                        // دروستکردنی وێنەی کاڵا
                        const imageHTML = product.image 
                            ? `<img src="${product.image}" class="product-image-small">`
                            : `<div style="width: 50px; height: 50px; background-color: var(--gray-light); border-radius: 5px; display: flex; align-items: center; justify-content: center; margin-left: 10px; color: var(--gray);"><i class="fas fa-image"></i></div>`;
                        
                        li.innerHTML = `
                            <div style="display: flex; align-items: center;">
                                ${imageHTML}
                                <div>
                                    <div class="item-name">${product.name}</div>
                                    <div style="font-size: 0.9rem; color: var(--gray);">
                                        بارکۆد: ${product.barcode}
                                    </div>
                                </div>
                            </div>
                            <div class="item-value">
                                <span style="margin-left: 15px;">${product.stock} ${getUnitName(product.unit)}</span>
                                <span>${product.salePrice.toLocaleString()} دینار</span>
                                <div style="margin-top: 10px; display: flex; gap: 5px;">
                                    <button class="btn btn-info btn-sm" onclick="editProduct(${product.id})">
                                        <i class="fas fa-edit"></i> گۆڕانکاری
                                    </button>
                                    <button class="btn btn-danger btn-sm" onclick="deleteProduct(${product.id})">
                                        <i class="fas fa-trash"></i> سڕینەوە
                                    </button>
                                </div>
                            </div>
                        `;
                        productList.appendChild(li);
                    });
                }
            }
            
            // زیادکردنی لیستی کەسەکان بۆ بەشی سەرەکی
            const customersMainList = document.getElementById('customersMainList');
            if (customersMainList) {
                customersMainList.innerHTML = '';
                
                if (sampleData.customers.length === 0) {
                    customersMainList.innerHTML = '<li class="list-item">هیچ کەسێک تۆمارنەکراوە</li>';
                } else {
                    sampleData.customers.forEach(customer => {
                        // دیاریکردنی رەنگ بەپێی قەرز
                        let debtClass = customer.debt > 0 ? 'debt-positive' : 'debt-zero';
                        
                        const li = document.createElement('li');
                        li.className = 'list-item';
                        li.setAttribute('data-customer-id', customer.id);
                        li.innerHTML = `
                            <div>
                                <div class="item-name">${customer.name}</div>
                                <div style="font-size: 0.9rem; color: var(--gray);">${customer.phone}</div>
                            </div>
                            <div>
                                <div class="item-value ${debtClass}">${customer.debt.toLocaleString()} دینار قەرز</div>
                                <div style="margin-top: 10px;">
                                    <button class="btn btn-info btn-sm" onclick="viewCustomerDetails(${customer.id})">
                                        <i class="fas fa-eye"></i> بینین
                                    </button>
                                </div>
                            </div>
                        `;
                        customersMainList.appendChild(li);
                    });
                }
            }
            
            // زیادکردنی لیستی شەریکەکان
            const partnersListItems = document.getElementById('partnersListItems');
            if (partnersListItems) {
                partnersListItems.innerHTML = '';
                
                if (sampleData.partners.length === 0) {
                    partnersListItems.innerHTML = '<li class="list-item">هیچ شەریکێک تۆمارنەکراوە</li>';
                } else {
                    sampleData.partners.forEach(partner => {
                        // دیاریکردنی رەنگ بەپێی جۆری قەرز
                        let debtText, debtClass;
                        
                        if (partner.debt > 0) {
                            // شەریک قەرزداری منە (مثبت) - سۆر
                            debtText = `${partner.debt.toLocaleString()} دینار (شەریک قەرزداری منە)`;
                            debtClass = 'debt-positive';
                        } else if (partner.debt < 0) {
                            // من قەرزداری شەریکم (منفی) - رەش
                            debtText = `${Math.abs(partner.debt).toLocaleString()} دینار (من قەرزداری ئەوانم)`;
                            debtClass = 'debt-negative';
                        } else {
                            // بێ قەرز - خۆڵەمێشی
                            debtText = 'بێ قەرز';
                            debtClass = 'debt-zero';
                        }
                        
                        const li = document.createElement('li');
                        li.className = 'list-item';
                        li.innerHTML = `
                            <div class="item-name">${partner.name}</div>
                            <div class="item-value ${debtClass}">${debtText}</div>
                        `;
                        partnersListItems.appendChild(li);
                    });
                }
            }
            
            // نوێکردنەوەی کۆی پارە
            updateDashboardCash();
            
            // هەژمارکردنی کۆی سەرفکردن
            calculateMonthlyExpense();
            
            // نوێکردنەوەی هەموو کارتەکانی داشبۆرد
            updateAllDashboardCards();
        }

        // نوێکردنەوەی هەموو کارتەکانی داشبۆرد
        function updateAllDashboardCards() {
            // کۆی کڕین
            const totalPurchaseDisplay = document.getElementById('totalPurchaseDisplay');
            if (totalPurchaseDisplay) {
                const totalPurchases = samplePurchaseData.purchases.reduce((sum, purchase) => sum + purchase.total, 0);
                totalPurchaseDisplay.innerHTML = `${totalPurchases.toLocaleString()} <span>دینار</span>`;
            }
            
            // جیاوازی
            updateDifferenceCard();
            
            // کۆی قەرزداران
            const totalDebtDisplay = document.getElementById('totalDebtDisplay');
            if (totalDebtDisplay) {
                const totalCustomerDebt = sampleData.customers.reduce((sum, customer) => sum + customer.debt, 0);
                totalDebtDisplay.innerHTML = `${totalCustomerDebt.toLocaleString()} <span>دینار</span>`;
            }
            
            // قەرزدارم بە شەریکەکان
            const partnerDebtDisplay = document.getElementById('partnerDebtDisplay');
            if (partnerDebtDisplay) {
                const totalPartnerDebt = sampleData.partners
                    .filter(p => p.debt < 0)
                    .reduce((sum, partner) => sum + Math.abs(partner.debt), 0);
                partnerDebtDisplay.innerHTML = `${totalPartnerDebt.toLocaleString()} <span>دینار</span>`;
            }
        }

        // نوێکردنەوەی کارتی جیاوازی
        function updateDifferenceCard() {
            const differenceCard = document.getElementById('differenceDisplay');
            if (differenceCard) {
                // کۆی هەموو کڕینەکان
                const totalPurchases = samplePurchaseData.purchases.reduce((sum, purchase) => sum + purchase.total, 0);
                
                // کۆی هەموو سەرفەکان
                const totalExpenses = sampleData.expenseHistory.reduce((sum, expense) => sum + expense.amount, 0);
                
                // جیاوازی = پارەی واسڵ - (کڕین + سەرف)
                const difference = sampleData.cashBalance - (totalPurchases + totalExpenses);
                
                differenceCard.innerHTML = `${difference.toLocaleString()} <span>دینار</span>`;
                
                // نوێکردنەوەی تێبینی گۆڕانکاری
                const changeElement = document.querySelector('.card-3 .card-change');
                if (changeElement) {
                    if (difference > 0) {
                        changeElement.innerHTML = `<i class="fas fa-arrow-up"></i> سود`;
                        changeElement.className = 'card-change positive';
                    } else if (difference < 0) {
                        changeElement.innerHTML = `<i class="fas fa-arrow-down"></i> زەرەر`;
                        changeElement.className = 'card-change negative';
                    } else {
                        changeElement.innerHTML = `<i class="fas fa-minus"></i> بێ گۆڕانکاری`;
                        changeElement.className = 'card-change';
                    }
                }
            }
        }

        // فەنکشنی وەرگرتنی ناوی یەکە
        function getUnitName(unit) {
            const unitNames = {
                'piece': 'پارچە',
                'carton': 'کارتۆن',
                'unit': 'دانە',
                'meter': 'مەتر',
                'kg': 'کیلۆ',
                'box': 'بۆکس',
                'pack': 'پاکەت'
            };
            return unitNames[unit] || unit;
        }

        // فەنکشنی سڕینەوەی کاڵا
        window.deleteProduct = function(productId) {
            if (confirm('دڵنیای لە سڕینەوەی ئەم کاڵایە؟')) {
                const productIndex = sampleData.products.findIndex(p => p.id === productId);
                
                if (productIndex !== -1) {
                    // پشکنین ئەگەر کاڵاکە لە فرۆشتن یان کڕینێکدا بەکارهاتووە
                    const product = sampleData.products[productIndex];
                    const usedInSales = sampleData.sales.some(sale => 
                        sale.items.some(item => item === product.name)
                    );
                    
                    const usedInPurchases = samplePurchaseData.purchases.some(purchase => 
                        purchase.items.some(item => item.name === product.name)
                    );
                    
                    if (usedInSales || usedInPurchases) {
                        alert('ناتوانرێت ئەم کاڵایە بسڕیتەوە چونکە لە فرۆشتن یان کڕینێکدا بەکارهاتووە!');
                        return;
                    }
                    
                    sampleData.products.splice(productIndex, 1);
                    populateSampleData();
                    alert('کاڵاکە بە سەرکەوتوویی سڕایەوە!');
                }
            }
        };

        // فەنکشنی گۆڕانکاری کاڵا
        window.editProduct = function(productId) {
            const product = sampleData.products.find(p => p.id === productId);
            if (!product) return;
            
            editingProductId = productId;
            
            // پڕکردنەوەی خانەکانی فۆرم
            document.getElementById('productName').value = product.name;
            document.getElementById('productBarcode').value = product.barcode;
            document.getElementById('purchasePrice').value = product.purchasePrice;
            document.getElementById('salePrice').value = product.salePrice;
            document.getElementById('stockQuantity').value = product.stock;
            document.getElementById('primaryUnit').value = product.unit;
            document.getElementById('secondaryUnit').value = product.secondaryUnit || '';
            document.getElementById('secondaryUnitQuantity').value = product.secondaryUnitQuantity || 0;
            
            // نیشاندانی وێنە
            const imagePreview = document.getElementById('imagePreview');
            if (product.image) {
                imagePreview.innerHTML = `<img src="${product.image}" alt="پێشبینینی وێنە">`;
            } else {
                imagePreview.innerHTML = '<p style="color: var(--gray); font-size: 0.9rem;">هیچ وێنەیەک نییە</p>';
            }
            
            // نیشاندانی فۆرم
            const productForm = document.getElementById('productForm');
            const addProductBtn = document.getElementById('addProductBtn');
            const saveBtn = document.getElementById('saveProductBtn');
            
            if (productForm && addProductBtn && saveBtn) {
                productForm.style.display = 'block';
                addProductBtn.style.display = 'none';
                saveBtn.innerHTML = '<i class="fas fa-save"></i> نوێکردنەوەی کاڵا';
            }
        };

        // فەنکشنی پاککردنەوەی خانەکانی فۆرم
        function resetProductForm() {
            document.getElementById('productName').value = '';
            document.getElementById('productBarcode').value = '';
            document.getElementById('purchasePrice').value = '';
            document.getElementById('salePrice').value = '';
            document.getElementById('stockQuantity').value = '';
            document.getElementById('primaryUnit').value = 'piece';
            document.getElementById('secondaryUnit').value = '';
            document.getElementById('secondaryUnitQuantity').value = '';
            document.getElementById('productImage').value = '';
            document.getElementById('imagePreview').innerHTML = '<p style="color: var(--gray); font-size: 0.9rem;">هیچ وێنەیەک نییە</p>';
            editingProductId = null;
            
            const saveBtn = document.getElementById('saveProductBtn');
            if (saveBtn) {
                saveBtn.innerHTML = '<i class="fas fa-save"></i> هەڵگرتن';
            }
        }

        // فەنکشنی هەڵگرتنی کاڵا
        const saveProductBtn = document.getElementById('saveProductBtn');
        if (saveProductBtn) {
            saveProductBtn.addEventListener('click', function() {
                if (editingProductId) {
                    // نوێکردنەوەی کاڵا
                    updateProduct(editingProductId);
                } else {
                    // زیادکردنی کاڵای نوێ
                    addNewProduct();
                }
            });
        }

        // فەنکشنی زیادکردنی کاڵای نوێ
        function addNewProduct() {
            const productName = document.getElementById('productName');
            const purchasePrice = document.getElementById('purchasePrice');
            const salePrice = document.getElementById('salePrice');
            const stockQuantity = document.getElementById('stockQuantity');
            
            if (!productName || !purchasePrice || !salePrice || !stockQuantity) {
                alert('تکایە هەموو خانە پڕەکان پڕ بکەرەوە!');
                return;
            }
            
            const name = productName.value.trim();
            const purchasePriceValue = parseInt(purchasePrice.value) || 0;
            const salePriceValue = parseInt(salePrice.value) || 0;
            const stock = parseInt(stockQuantity.value) || 0;
            
            if (!name || salePriceValue === 0) {
                alert('تکایە ناوی کاڵا و نرخی فرۆشتن پڕ بکەرەوە!');
                return;
            }
            
            // دروستکردنی کاڵای نوێ
            const newProduct = {
                id: sampleData.products.length + 1,
                name: name,
                barcode: document.getElementById('productBarcode').value.trim() || `BR${sampleData.products.length + 1000}`,
                purchasePrice: purchasePriceValue,
                salePrice: salePriceValue,
                stock: stock,
                unit: document.getElementById('primaryUnit').value,
                secondaryUnit: document.getElementById('secondaryUnit').value || '',
                secondaryUnitQuantity: parseInt(document.getElementById('secondaryUnitQuantity').value) || 0,
                description: ''
            };
            
            // هەڵگرتنی وێنە
            const productImage = document.getElementById('productImage');
            if (productImage.files.length > 0) {
                const file = productImage.files[0];
                const reader = new FileReader();
                reader.onload = function(e) {
                    newProduct.image = e.target.result;
                    saveProduct(newProduct);
                };
                reader.readAsDataURL(file);
            } else {
                saveProduct(newProduct);
            }
        }

        // فەنکشنی هەڵگرتنی کاڵا
        function saveProduct(product) {
            sampleData.products.push(product);
            
            populateSampleData();
            
            const productForm = document.getElementById('productForm');
            const addProductBtn = document.getElementById('addProductBtn');
            
            if (productForm && addProductBtn) {
                productForm.style.display = 'none';
                addProductBtn.style.display = 'block';
            }
            
            resetProductForm();
            alert('کاڵای نوێ بە سەرکەوتوویی زیاد کرا!');
        }

        // فەنکشنی نوێکردنەوەی کاڵا
        function updateProduct(productId) {
            const product = sampleData.products.find(p => p.id === productId);
            if (!product) return;
            
            const productName = document.getElementById('productName');
            const purchasePrice = document.getElementById('purchasePrice');
            const salePrice = document.getElementById('salePrice');
            const stockQuantity = document.getElementById('stockQuantity');
            const productImage = document.getElementById('productImage');
            
            product.name = productName.value.trim();
            product.barcode = document.getElementById('productBarcode').value.trim() || product.barcode;
            product.purchasePrice = parseInt(purchasePrice.value) || product.purchasePrice;
            product.salePrice = parseInt(salePrice.value) || product.salePrice;
            product.stock = parseInt(stockQuantity.value) || product.stock;
            product.unit = document.getElementById('primaryUnit').value;
            product.secondaryUnit = document.getElementById('secondaryUnit').value || '';
            product.secondaryUnitQuantity = parseInt(document.getElementById('secondaryUnitQuantity').value) || 0;
            
            // هەڵگرتنی وێنە
            if (productImage.files.length > 0) {
                const file = productImage.files[0];
                const reader = new FileReader();
                reader.onload = function(e) {
                    product.image = e.target.result;
                    finishUpdate();
                };
                reader.readAsDataURL(file);
            } else {
                finishUpdate();
            }
        }

        // تەواوکردنی نوێکردنەوە
        function finishUpdate() {
            populateSampleData();
            
            const productForm = document.getElementById('productForm');
            const addProductBtn = document.getElementById('addProductBtn');
            
            if (productForm && addProductBtn) {
                productForm.style.display = 'none';
                addProductBtn.style.display = 'block';
            }
            
            // پاککردنەوەی خانەکان
            resetProductForm();
            
            alert('کاڵاکە بە سەرکەوتوویی نوێ کرایەوە!');
        }

        // پاشگەزبوونەوە لە زیادکردنی/گۆڕانکاری کاڵا
        const cancelProductBtn = document.getElementById('cancelProductBtn');
        if (cancelProductBtn) {
            cancelProductBtn.addEventListener('click', function() {
                const productForm = document.getElementById('productForm');
                const addProductBtn = document.getElementById('addProductBtn');
                
                if (productForm && addProductBtn) {
                    productForm.style.display = 'none';
                    addProductBtn.style.display = 'block';
                    resetProductForm();
                }
            });
        }

        // زیادکردنی کاڵای نوێ لە مخزن
        const addProductBtn = document.getElementById('addProductBtn');
        if (addProductBtn) {
            addProductBtn.addEventListener('click', function() {
                const productForm = document.getElementById('productForm');
                if (productForm) {
                    productForm.style.display = 'block';
                    this.style.display = 'none';
                    resetProductForm();
                }
            });
        }

        // فەنکشنی بینینی وردەکارییەکانی کەس
        window.viewCustomerDetails = function(customerId) {
            const customer = sampleData.customers.find(c => c.id === customerId);
            if (!customer) return;
            
            // نوێکردنەوەی مۆدال
            document.getElementById('modalCustomerName').textContent = customer.name;
            document.getElementById('editCustomerName').value = customer.name;
            document.getElementById('editCustomerPhone').value = customer.phone;
            document.getElementById('editCustomerAddress').value = customer.address || '';
            document.getElementById('customerTotalDebt').value = customer.debt.toLocaleString() + ' دینار';
            
            // دۆزینەوەی فاکتوورەکانی ئەم کەسە
            const customerInvoices = sampleData.sales.filter(s => s.customer === customer.name);
            document.getElementById('customerTotalPurchases').value = customerInvoices.length + ' فاکتوور';
            
            if (customerInvoices.length > 0) {
                const lastInvoice = customerInvoices[0];
                document.getElementById('customerLastPurchase').value = lastInvoice.date;
                
                // نوێکردنەوەی لیستی فاکتوورەکان
                const customerInvoicesList = document.getElementById('customerInvoicesList');
                if (customerInvoicesList) {
                    customerInvoicesList.innerHTML = '';
                    
                    customerInvoices.forEach(invoice => {
                        const li = document.createElement('li');
                        li.className = 'list-item';
                        li.setAttribute('data-invoice-id', invoice.id);
                        li.innerHTML = `
                            <div>
                                <div class="item-name">${invoice.code}</div>
                                <div style="font-size: 0.9rem; color: var(--gray);">
                                    ${invoice.date} - ${invoice.items.length} کاڵا
                                </div>
                            </div>
                            <div>
                                <div class="item-value">${invoice.total.toLocaleString()} دینار</div>
                                <div style="margin-top: 10px; display: flex; gap: 5px;">
                                    <button class="btn btn-info btn-sm" onclick="viewInvoiceDetails(${invoice.id})">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn btn-danger btn-sm" onclick="deleteSaleInvoice(${invoice.id})">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        `;
                        customerInvoicesList.appendChild(li);
                    });
                }
            } else {
                document.getElementById('customerLastPurchase').value = 'هیچ فرۆشتنی پێشوو';
                
                const customerInvoicesList = document.getElementById('customerInvoicesList');
                if (customerInvoicesList) {
                    customerInvoicesList.innerHTML = '<li class="list-item">هیچ فاکتوورێک نییە</li>';
                }
            }
            
            // نیشاندانی مۆدال
            document.getElementById('customerModal').classList.add('active');
        };

        // فەنکشنی سڕینەوەی فاکتووری فرۆشتن
        window.deleteSaleInvoice = function(saleId) {
            if (confirm('دڵنیای لە سڕینەوەی ئەم فاکتوورەی فرۆشتن؟')) {
                const index = sampleData.sales.findIndex(s => s.id === saleId);
                if (index !== -1) {
                    const sale = sampleData.sales[index];
                    
                    // گەڕاندنەوەی پارە ئەگەر فرۆشتن بە نەقدی بوو
                    if (sale.payment === 'cash') {
                        sampleData.cashBalance -= sale.total;
                        updateDashboardCash();
                    } else if (sale.payment === 'credit') {
                        // گەڕاندنەوەی قەرز
                        const customer = sampleData.customers.find(c => c.name === sale.customer);
                        if (customer) {
                            customer.debt -= sale.total;
                            if (customer.debt < 0) customer.debt = 0;
                        }
                    }
                    
                    // گەڕاندنەوەی کاڵاکان بۆ مخزن
                    sale.items.forEach(itemName => {
                        const product = sampleData.products.find(p => p.name === itemName);
                        if (product) {
                            product.stock += 1; // هەر کاڵایەک یەک دانە زیاد دەبێت
                        }
                    });
                    
                    sampleData.sales.splice(index, 1);
                    populateSampleData();
                    populateSaleHistory();
                    alert('فاکتووری فرۆشتن بە سەرکەوتوویی سڕایەوە!');
                }
            }
        };

        // فەنکشنی بینینی وردەکاری فاکتوور
        window.viewInvoiceDetails = function(invoiceId) {
            const invoice = sampleData.sales.find(s => s.id === invoiceId);
            if (!invoice) return;
            
            // نوێکردنەوەی مۆدالی فاکتوور
            document.getElementById('modalInvoiceCode').textContent = invoice.code;
            
            // دروستکردنی نەخشەی فاکتوور
            const invoiceDetailContent = document.getElementById('invoiceDetailContent');
            if (invoiceDetailContent) {
                const customer = sampleData.customers.find(c => c.name === invoice.customer);
                
                invoiceDetailContent.innerHTML = `
                    <div class="invoice-header">
                        <div class="invoice-logo">الکترۆنیات</div>
                        <h2>فاکتووری فرۆشتن</h2>
                        <p>کۆدی فاکتوورە: <span id="detailInvoiceCode">${invoice.code}</span></p>
                        <p>بەروار: <span id="detailInvoiceDate">${invoice.date}</span></p>
                    </div>
                    
                    <div class="invoice-details">
                        <div>
                            <h4>زانیاری فرۆشەر:</h4>
                            <p>ناوی سیستەم: الکترۆنیات</p>
                            <p>ژمارەی موبایل: ٠٧٧٠١٢٣٤٥٦٧</p>
                            <p>ناونیشان: هەولێر، کوردستان</p>
                        </div>
                        
                        <div>
                            <h4>زانیاری کڕیار:</h4>
                            <p>ناوی کڕیار: ${invoice.customer}</p>
                            <p>ژمارەی موبایل: ${customer ? customer.phone : 'نەزانراو'}</p>
                            <p>ناونیشان: ${customer ? customer.address : 'نەزانراو'}</p>
                        </div>
                    </div>
                    
                    <table class="invoice-table">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>ناوی کاڵا</th>
                                <th>یەکە</th>
                                <th>بڕ</th>
                                <th>نرخ</th>
                                <th>کۆی گشتی</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${invoice.originalItems.map((item, index) => `
                                <tr>
                                    <td>${index + 1}</td>
                                    <td>${item.name}</td>
                                    <td>${getUnitName(item.unit)}</td>
                                    <td>${item.quantity}</td>
                                    <td>${item.price.toLocaleString()} دینار</td>
                                    <td>${(item.price * item.quantity).toLocaleString()} دینار</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                    
                    <div class="invoice-total">
                        <p><strong>کۆی گشتی:</strong> ${invoice.total.toLocaleString()} دینار</p>
                        <p><strong>شێوازی پارەدان:</strong> ${invoice.payment === 'cash' ? 'نەقدی' : 'قەرز'}</p>
                        ${invoice.payment === 'credit' ? `
                            <p><strong>قەرز:</strong> ${invoice.total.toLocaleString()} دینار</p>
                        ` : ''}
                    </div>
                `;
            }
            
            // نیشاندانی مۆدال
            document.getElementById('invoiceDetailModal').classList.add('active');
        };

        // فەنکشنی سڕینەوەی فاکتوور
        window.deleteInvoice = function(invoiceId) {
            if (confirm('دڵنیای لە سڕینەوەی ئەم فاکتوورە؟')) {
                const index = sampleData.sales.findIndex(s => s.id === invoiceId);
                if (index !== -1) {
                    sampleData.sales.splice(index, 1);
                    alert('فاکتوورەکە بە سەرکەوتوویی سڕایەوە!');
                    
                    // نوێکردنەوەی نیشاندانەکان
                    if (document.getElementById('customerModal').classList.contains('active')) {
                        const customerId = parseInt(document.querySelector('#customerModal [data-customer-id]')?.getAttribute('data-customer-id') || 0);
                        if (customerId) {
                            viewCustomerDetails(customerId);
                        }
                    }
                    
                    populateSampleData();
                    populateSaleHistory();
                }
            }
        };

        // نەخشەی مێنیو
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                
                const sectionId = this.getAttribute('data-section');
                showSection(sectionId);
            });
        });

        // نەخشەی مێنیوی مۆبایل
        document.getElementById('menuToggle').addEventListener('click', function() {
            document.getElementById('sidebar').classList.toggle('active');
        });

        document.getElementById('closeSidebar').addEventListener('click', function() {
            document.getElementById('sidebar').classList.remove('active');
        });

        // نەخشەی گەڕان بۆ کاڵا لە بەشی فرۆشتن
        const productSearch = document.getElementById('productSearch');
        if (productSearch) {
            productSearch.addEventListener('input', function() {
                const query = this.value.toLowerCase();
                const suggestions = document.getElementById('productSuggestions');
                
                if (!suggestions) return;
                
                if (query.length < 1) {
                    suggestions.style.display = 'none';
                    return;
                }
                
                const filteredProducts = sampleData.products.filter(p => 
                    p.name.toLowerCase().includes(query) || 
                    p.barcode.includes(query)
                );
                
                suggestions.innerHTML = '';
                
                if (filteredProducts.length === 0) {
                    suggestions.style.display = 'none';
                    return;
                }
                
                filteredProducts.forEach(product => {
                    const div = document.createElement('div');
                    div.className = 'suggestion-item';
                    
                    // دروستکردنی وێنەی کاڵا
                    const imageHTML = product.image 
                        ? `<img src="${product.image}" style="width: 40px; height: 40px; border-radius: 5px; object-fit: cover; margin-left: 10px; float: right;">`
                        : '';
                    
                    div.innerHTML = `
                        <div style="display: flex; align-items: center;">
                            ${imageHTML}
                            <div style="flex: 1;">
                                <div><strong>${product.name}</strong></div>
                                <div style="font-size: 0.9rem; color: var(--gray);">
                                    ${product.salePrice.toLocaleString()} دینار | بەردەست: ${product.stock} ${getUnitName(product.unit)}
                                </div>
                                <div style="font-size: 0.8rem; color: var(--info);">
                                    بارکۆد: ${product.barcode}
                                </div>
                            </div>
                        </div>
                    `;
                    
                    div.addEventListener('click', function() {
                        addToCartDirectly(product);
                        productSearch.value = '';
                        suggestions.style.display = 'none';
                    });
                    
                    suggestions.appendChild(div);
                });
                
                suggestions.style.display = 'block';
            });
            
            // چالاککردنی بارکۆد
            productSearch.addEventListener('keydown', function(e) {
                // ئەگەر Enter کرتە کرابێت
                if (e.key === 'Enter') {
                    e.preventDefault();
                    const query = this.value.trim();
                    
                    if (query) {
                        // گەڕان بەبارکۆد
                        const product = sampleData.products.find(p => p.barcode === query);
                        if (product) {
                            addToCartDirectly(product);
                            this.value = '';
                        } else {
                            // گەڕان بەناو
                            const productByName = sampleData.products.find(p => 
                                p.name.toLowerCase().includes(query.toLowerCase())
                            );
                            if (productByName) {
                                addToCartDirectly(productByName);
                                this.value = '';
                            } else {
                                alert('کاڵایەک بەم بارکۆد یان ناوە نەدۆزرایەوە!');
                            }
                        }
                    }
                }
            });
        }

        // زیادکردنی کاڵا ڕاستەوخۆ بۆ سەبەتە
        function addToCartDirectly(product) {
            const existingItem = cart.find(item => item.id === product.id);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                const cartItem = {
                    id: product.id,
                    name: product.name,
                    price: product.salePrice,
                    quantity: 1,
                    unit: product.unit,
                    image: product.image,
                    originalPrice: product.salePrice
                };
                
                cart.push(cartItem);
            }
            
            updateCartDisplay();
        }

        // نوێکردنەوەی نیشاندانی سەبەتە
        function updateCartDisplay() {
            const cartItems = document.getElementById('cartItems');
            if (!cartItems) return;
            
            cartItems.innerHTML = '';
            
            if (cart.length === 0) {
                cartItems.innerHTML = '<li class="empty-cart">هیچ کاڵایەک لە سەبەتەدا نییە</li>';
                updateCartTotal();
                return;
            }
            
            let total = 0;
            
            cart.forEach((item, index) => {
                const li = document.createElement('li');
                li.className = 'cart-item';
                
                const product = sampleData.products.find(p => p.id === item.id);
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                
                // دروستکردنی وێنەی کاڵا
                const imageHTML = item.image 
                    ? `<img src="${item.image}" alt="${item.name}">`
                    : `<div class="cart-item-image"><i class="fas fa-${getProductIcon(item.name)}"></i></div>`;
                
                li.innerHTML = `
                    <div class="cart-item-info">
                        ${imageHTML}
                        <div class="cart-item-details">
                            <div class="item-name">${item.name}</div>
                            <div class="cart-item-controls">
                                <div>
                                    <label>بڕ:</label>
                                    <input type="number" value="${item.quantity}" min="1" max="${product ? product.stock : 999}" 
                                           onchange="updateCartItemQuantity(${index}, this.value)">
                                </div>
                                <div>
                                    <label>یەکە:</label>
                                    <select onchange="updateCartItemUnit(${index}, this.value)">
                                        <option value="${item.unit}" selected>${getUnitName(item.unit)}</option>
                                    </select>
                                </div>
                                <div>
                                    <label>نرخ:</label>
                                    <input type="number" value="${item.price}" min="1" 
                                           onchange="updateCartItemPrice(${index}, this.value)">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="cart-item-price">
                        <div class="cart-item-total">${itemTotal.toLocaleString()} دینار</div>
                        <div style="margin-top: 10px;">
                            <button class="btn btn-danger btn-sm" onclick="removeFromCart(${index})">
                                <i class="fas fa-trash"></i> سڕینەوە
                            </button>
                        </div>
                    </div>
                `;
                
                cartItems.appendChild(li);
            });
            
            updateCartTotal();
        }

        // نوێکردنەوەی کۆی گشتی سەبەتە
        function updateCartTotal() {
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const cartTotalElement = document.getElementById('cartTotalAmount');
            if (cartTotalElement) {
                cartTotalElement.textContent = total.toLocaleString();
            }
        }

        // گۆڕانکاری لە بڕی کاڵا لە سەبەتە
        window.updateCartItemQuantity = function(index, newQuantity) {
            const quantity = parseInt(newQuantity) || 1;
            const product = sampleData.products.find(p => p.id === cart[index].id);
            
            if (product && quantity > product.stock) {
                alert(`تەنها ${product.stock} ${getUnitName(cart[index].unit)} بەردەستە!`);
                cart[index].quantity = product.stock;
                updateCartDisplay();
                return;
            }
            
            cart[index].quantity = quantity;
            updateCartDisplay();
        };

        // گۆڕانکاری لە یەکەی کاڵا لە سەبەتە
        window.updateCartItemUnit = function(index, newUnit) {
            cart[index].unit = newUnit;
            updateCartDisplay();
        };

        // گۆڕانکاری لە نرخی کاڵا لە سەبەتە
        window.updateCartItemPrice = function(index, newPrice) {
            const price = parseInt(newPrice) || cart[index].originalPrice;
            cart[index].price = price;
            updateCartDisplay();
        };

        // سڕینەوەی کاڵا لە سەبەتە
        window.removeFromCart = function(index) {
            cart.splice(index, 1);
            updateCartDisplay();
        };

        // دەستنیشانکردنی ئایکۆنی کاڵا
        function getProductIcon(productName) {
            if (productName.includes("مۆبایل")) return "mobile-alt";
            if (productName.includes("تەلەفزیۆن")) return "tv";
            if (productName.includes("کۆمپیوتەر")) return "desktop";
            if (productName.includes("لاپتۆپ")) return "laptop";
            if (productName.includes("سەرعەم")) return "headphones";
            if (productName.includes("ئامێری دەنگ")) return "volume-up";
            if (productName.includes("مایکرۆوەیڤ")) return "microphone";
            if (productName.includes("قاڵبی")) return "box";
            return "box";
        }

        // هەڵبژاردنی جۆری پارەدان
        document.querySelectorAll('.payment-option').forEach(option => {
            option.addEventListener('click', function() {
                const container = this.closest('.cart-container');
                if (!container) return;
                
                container.querySelectorAll('.payment-option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                
                this.classList.add('selected');
                selectedPayment = this.getAttribute('data-payment');
                
                const customerSelection = container.querySelector('#customerSelection');
                if (customerSelection) {
                    if (selectedPayment === 'credit') {
                        customerSelection.style.display = 'block';
                        customerSelection.classList.add('active');
                    } else {
                        customerSelection.style.display = 'none';
                        customerSelection.classList.remove('active');
                        selectedCustomer = null;
                    }
                }
            });
        });

        // گەڕان بەدوای کەسەکان
        const customerSearch = document.getElementById('customerSearch');
        if (customerSearch) {
            customerSearch.addEventListener('input', function() {
                const query = this.value.toLowerCase();
                const suggestions = document.getElementById('customerSuggestions');
                
                if (!suggestions) return;
                
                if (query.length < 2) {
                    suggestions.style.display = 'none';
                    return;
                }
                
                const filteredCustomers = sampleData.customers.filter(c => 
                    c.name.toLowerCase().includes(query)
                );
                
                suggestions.innerHTML = '';
                
                if (filteredCustomers.length === 0) {
                    suggestions.style.display = 'none';
                    return;
                }
                
                filteredCustomers.forEach(customer => {
                    const div = document.createElement('div');
                    div.className = 'suggestion-item';
                    div.textContent = `${customer.name} - ${customer.debt > 0 ? customer.debt.toLocaleString() + ' دینار قەرز' : 'بێ قەرز'}`;
                    
                    div.addEventListener('click', function() {
                        selectedCustomer = customer;
                        document.getElementById('customerSearch').value = customer.name;
                        suggestions.style.display = 'none';
                    });
                    
                    suggestions.appendChild(div);
                });
                
                suggestions.style.display = 'block';
            });
        }

        // سڕینەوەی سەبەتە
        const clearCartBtn = document.getElementById('clearCart');
        if (clearCartBtn) {
            clearCartBtn.addEventListener('click', function() {
                if (cart.length === 0) return;
                
                if (confirm('دڵنیای لە پاککردنەوەی هەموو کاڵاکانی سەبەتە؟')) {
                    cart = [];
                    updateCartDisplay();
                }
            });
        }

        // پرێنتکردنی فاکتوور
        const printInvoiceSmallBtn = document.getElementById('printInvoiceSmall');
        if (printInvoiceSmallBtn) {
            printInvoiceSmallBtn.addEventListener('click', function() {
                if (cart.length === 0) {
                    alert('تکایە یەکێک لە کاڵاکان زیاد بکە بۆ سەبەتە پێش پرێنتکردن!');
                    return;
                }
                
                if (selectedPayment === 'credit' && !selectedCustomer) {
                    alert('تکایە کەسێک هەڵبژێرە بۆ فرۆشتن بە قەرز!');
                    return;
                }
                
                updateInvoice();
                document.getElementById('printModal').classList.add('active');
            });
        }

        const printInvoiceA4Btn = document.getElementById('printInvoiceA4');
        if (printInvoiceA4Btn) {
            printInvoiceA4Btn.addEventListener('click', function() {
                if (cart.length === 0) {
                    alert('تکایە یەکێک لە کاڵاکان زیاد بکە بۆ سەبەتە پێش پرێنتکردن!');
                    return;
                }
                
                if (selectedPayment === 'credit' && !selectedCustomer) {
                    alert('تکایە کەسێک هەڵبژێرە بۆ فرۆشتن بە قەرز!');
                    return;
                }
                
                updateInvoice();
                document.getElementById('printModal').classList.add('active');
            });
        }

        // نوێکردنەوەی فاکتوورەکە
        function updateInvoice() {
            const invoiceCode = `INV-${new Date().getFullYear()}-${sampleData.sales.length + 1}`;
            const invoiceCodeElement = document.getElementById('invoiceCode');
            if (invoiceCodeElement) {
                invoiceCodeElement.textContent = invoiceCode;
            }
            
            const now = new Date();
            const dateStr = `${now.getFullYear()}/${now.getMonth() + 1}/${now.getDate()}`;
            const invoiceDateElement = document.getElementById('invoiceDate');
            if (invoiceDateElement) {
                invoiceDateElement.textContent = dateStr;
            }
            
            const customerNameElement = document.getElementById('customerName');
            const customerPhoneElement = document.getElementById('customerPhone');
            const customerAddressElement = document.getElementById('customerAddress');
            
            if (customerNameElement && customerPhoneElement && customerAddressElement) {
                if (selectedCustomer) {
                    customerNameElement.textContent = `ناوی کڕیار: ${selectedCustomer.name}`;
                    customerPhoneElement.textContent = `ژمارەی موبایل: ${selectedCustomer.phone}`;
                    customerAddressElement.textContent = `ناونیشان: ${selectedCustomer.address || 'نەزانراو'}`;
                } else {
                    customerNameElement.textContent = `ناوی کڕیار: کڕیاری نەناسراو`;
                    customerPhoneElement.textContent = `ژمارەی موبایل: نەزانراو`;
                    customerAddressElement.textContent = `ناونیشان: نەزانراو`;
                }
            }
            
            const invoiceItems = document.getElementById('invoiceItems');
            if (invoiceItems) {
                invoiceItems.innerHTML = '';
                
                let total = 0;
                cart.forEach((item, index) => {
                    const itemTotal = item.price * item.quantity;
                    total += itemTotal;
                    
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${index + 1}</td>
                        <td>${item.name}</td>
                        <td>${getUnitName(item.unit)}</td>
                        <td>${item.quantity}</td>
                        <td>${item.price.toLocaleString()} دینار</td>
                        <td>${itemTotal.toLocaleString()} دینار</td>
                    `;
                    invoiceItems.appendChild(tr);
                });
                
                const invoiceTotalElement = document.getElementById('invoiceTotal');
                if (invoiceTotalElement) {
                    invoiceTotalElement.textContent = `${total.toLocaleString()} دینار`;
                }
                
                const previousDebt = selectedCustomer ? selectedCustomer.debt : 0;
                const currentDebt = selectedPayment === 'credit' ? total : 0;
                const totalDebt = previousDebt + currentDebt;
                
                const previousDebtElement = document.getElementById('previousDebt');
                const currentDebtElement = document.getElementById('currentDebt');
                const totalDebtElement = document.getElementById('totalDebt');
                
                if (previousDebtElement) previousDebtElement.textContent = `${previousDebt.toLocaleString()} دینار`;
                if (currentDebtElement) currentDebtElement.textContent = `${currentDebt.toLocaleString()} دینار`;
                if (totalDebtElement) totalDebtElement.textContent = `${totalDebt.toLocaleString()} دینار`;
            }
        }

        // داخستنی مۆدالی پرێنت
        const closePrintModalBtn = document.getElementById('closePrintModal');
        if (closePrintModalBtn) {
            closePrintModalBtn.addEventListener('click', function() {
                document.getElementById('printModal').classList.remove('active');
            });
        }

        const closeInvoiceBtn = document.getElementById('closeInvoice');
        if (closeInvoiceBtn) {
            closeInvoiceBtn.addEventListener('click', function() {
                document.getElementById('printModal').classList.remove('active');
            });
        }

        // تەواوکردنی فرۆشتن
        const completeSaleBtn = document.getElementById('completeSale');
        if (completeSaleBtn) {
            completeSaleBtn.addEventListener('click', function() {
                if (cart.length === 0) {
                    alert('تکایە یەکێک لە کاڵاکان زیاد بکە بۆ سەبەتە پێش تەواوکردنی فرۆشتن!');
                    return;
                }
                
                if (selectedPayment === 'credit' && !selectedCustomer) {
                    alert('تکایە کەسێک هەڵبژێرە بۆ فرۆشتن بە قەرز!');
                    return;
                }
                
                const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                const newSale = {
                    id: sampleData.sales.length + 1,
                    code: `INV-${new Date().getFullYear()}-${sampleData.sales.length + 1}`,
                    customer: selectedCustomer ? selectedCustomer.name : 'کڕیاری نەناسراو',
                    date: new Date().toISOString().split('T')[0],
                    total: total,
                    payment: selectedPayment,
                    items: cart.map(item => item.name),
                    originalItems: cart.map(item => ({
                        id: item.id,
                        name: item.name,
                        quantity: item.quantity,
                        price: item.price,
                        unit: item.unit
                    }))
                };
                
                sampleData.sales.unshift(newSale);
                
                if (selectedPayment === 'cash') {
                    // زیادکردنی پارە بۆ کۆی نەقدی
                    sampleData.cashBalance += total;
                    updateDashboardCash();
                } else if (selectedPayment === 'credit' && selectedCustomer) {
                    // کەس قەرزداری منە، قەرزی زیاد دەبێت
                    selectedCustomer.debt += total;
                }
                
                // کەمکردنەوەی کاڵا لە مخزن
                cart.forEach(item => {
                    const product = sampleData.products.find(p => p.id === item.id);
                    if (product) {
                        product.stock -= item.quantity;
                        if (product.stock < 0) product.stock = 0;
                    }
                });
                
                populateSampleData();
                populateSaleHistory();
                
                cart = [];
                updateCartDisplay();
                selectedCustomer = null;
                selectedPayment = "cash";
                
                document.querySelectorAll('.payment-option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                const cashOption = document.querySelector('.payment-option[data-payment="cash"]');
                if (cashOption) {
                    cashOption.classList.add('selected');
                }
                const customerSelection = document.getElementById('customerSelection');
                if (customerSelection) {
                    customerSelection.style.display = 'none';
                    customerSelection.classList.remove('active');
                }
                const customerSearch = document.getElementById('customerSearch');
                if (customerSearch) {
                    customerSearch.value = '';
                }
                
                alert('فرۆشتنەکە بە سەرکەوتوویی تەواو بوو!');
            });
        }

        // نەخشەی تاباتەکان لە بەشی فرۆشتن
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const tabId = this.getAttribute('data-tab');
                
                const parent = this.closest('.tab-buttons');
                if (parent) {
                    parent.querySelectorAll('.tab-btn').forEach(b => {
                        b.classList.remove('active');
                    });
                }
                
                this.classList.add('active');
                
                const container = this.closest('.sale-container');
                if (container) {
                    container.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    const tabContent = document.getElementById(tabId);
                    if (tabContent) {
                        tabContent.classList.add('active');
                    }
                }
            });
        });

        // نەخشەی تاباتەکان لە بەشی مخزن
        document.querySelectorAll('.inventory-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const tabId = this.getAttribute('data-inventory-tab') + 'Tab';
                
                const parent = this.closest('.inventory-tabs');
                if (parent) {
                    parent.querySelectorAll('.inventory-tab').forEach(t => {
                        t.classList.remove('active');
                    });
                }
                
                this.classList.add('active');
                
                const container = this.closest('.inventory-content').parentElement;
                if (container) {
                    container.querySelectorAll('.inventory-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    const tabContent = document.getElementById(tabId);
                    if (tabContent) {
                        tabContent.classList.add('active');
                    }
                }
            });
        });

        // نوێکردنەوەی لیستی کاڵای کەم بوو
        const refreshLowStockBtn = document.getElementById('refreshLowStock');
        if (refreshLowStockBtn) {
            refreshLowStockBtn.addEventListener('click', function() {
                populateSampleData();
                alert('لیستی کاڵای کەم بووەکان نوێ کرایەوە!');
            });
        }

        // نوێکردنەوەی لیستی قەرزداران
        const refreshDebtorsBtn = document.getElementById('refreshDebtors');
        if (refreshDebtorsBtn) {
            refreshDebtorsBtn.addEventListener('click', function() {
                populateSampleData();
                alert('لیستی قەرزدارەکان نوێ کرایەوە!');
            });
        }

        // نوێکردنەوەی مێژووی فرۆشتن
        const refreshSaleHistoryBtn = document.getElementById('refreshSaleHistory');
        if (refreshSaleHistoryBtn) {
            refreshSaleHistoryBtn.addEventListener('click', function() {
                populateSaleHistory();
                alert('مێژووی فرۆشتن نوێ کرایەوە!');
            });
        }

        // گەڕان لە مێژووی فرۆشتن
        const saleHistorySearch = document.getElementById('saleHistorySearch');
        if (saleHistorySearch) {
            saleHistorySearch.addEventListener('input', function() {
                const query = this.value.toLowerCase();
                const items = document.querySelectorAll('#saleHistoryList .list-item');
                
                items.forEach(item => {
                    const text = item.textContent.toLowerCase();
                    if (text.includes(query)) {
                        item.style.display = 'flex';
                    } else {
                        item.style.display = 'none';
                    }
                });
            });
        }

        // پرێنتی بچووک (لە مۆدالی سەرەمی)
        const printSmallBtn = document.getElementById('printSmall');
        if (printSmallBtn) {
            printSmallBtn.addEventListener('click', function() {
                const invoiceCode = document.getElementById('invoiceCode').textContent;
                printRealInvoice(invoiceCode, 'small');
            });
        }

        // پرێنتی A4 (لە مۆدالی سەرەمی)
        const printA4Btn = document.getElementById('printA4');
        if (printA4Btn) {
            printA4Btn.addEventListener('click', function() {
                const invoiceCode = document.getElementById('invoiceCode').textContent;
                printRealInvoice(invoiceCode, 'A4');
            });
        }

        // پرێنتی بچووک (لە مۆدالی فاکتوور)
        const printInvoiceSmallDetailBtn = document.getElementById('printInvoiceSmallDetail');
        if (printInvoiceSmallDetailBtn) {
            printInvoiceSmallDetailBtn.addEventListener('click', function() {
                const invoiceCode = document.getElementById('modalInvoiceCode').textContent;
                printRealInvoice(invoiceCode, 'small');
            });
        }

        // پرێنتی A4 (لە مۆدالی فاکتوور)
        const printInvoiceA4DetailBtn = document.getElementById('printInvoiceA4Detail');
        if (printInvoiceA4DetailBtn) {
            printInvoiceA4DetailBtn.addEventListener('click', function() {
                const invoiceCode = document.getElementById('modalInvoiceCode').textContent;
                printRealInvoice(invoiceCode, 'A4');
            });
        }

        // فەنکشنی پرێنتکردنی ڕاستەقینە
        function printRealInvoice(invoiceCode, size = 'small') {
            // دۆزینەوەی فاکتوورەکە
            const invoice = sampleData.sales.find(s => s.code === invoiceCode);
            if (!invoice) {
                alert('فاکتوورەکە نەدۆزرایەوە!');
                return;
            }
            
            // دروستکردنی پەڕەی نوێ بۆ پرێنت
            const printWindow = window.open('', '_blank');
            
            // دروستکردنی HTML بۆ پرێنت
            const printHTML = `
                <!DOCTYPE html>
                <html lang="ar" dir="rtl">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>فاکتووری فرۆشتن - ${invoiceCode}</title>
                    <style>
                        @media print {
                            body {
                                margin: 0;
                                padding: 0;
                                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                                font-size: ${size === 'small' ? '12px' : '14px'};
                                line-height: 1.4;
                            }
                            
                            .print-container {
                                width: ${size === 'small' ? '80mm' : '210mm'};
                                padding: ${size === 'small' ? '5px' : '20px'};
                                margin: 0 auto;
                            }
                            
                            .invoice-header {
                                text-align: center;
                                border-bottom: 2px solid #4361ee;
                                padding-bottom: 10px;
                                margin-bottom: 20px;
                            }
                            
                            .invoice-logo {
                                font-size: ${size === 'small' ? '1.5rem' : '2rem'};
                                font-weight: 800;
                                color: #4361ee;
                                margin-bottom: 5px;
                            }
                            
                            .invoice-title {
                                font-size: ${size === 'small' ? '1rem' : '1.5rem'};
                                margin: 5px 0;
                            }
                            
                            .invoice-details {
                                display: grid;
                                grid-template-columns: 1fr 1fr;
                                gap: 15px;
                                margin-bottom: 20px;
                            }
                            
                            .invoice-table {
                                width: 100%;
                                border-collapse: collapse;
                                margin-bottom: 20px;
                            }
                            
                            .invoice-table th, .invoice-table td {
                                padding: ${size === 'small' ? '3px 5px' : '8px 10px'};
                                text-align: right;
                                border-bottom: 1px solid #ddd;
                            }
                            
                            .invoice-table th {
                                background-color: #f8f9fa;
                                font-weight: bold;
                            }
                            
                            .invoice-total {
                                margin-top: 20px;
                                padding-top: 10px;
                                border-top: 2px solid #ddd;
                                text-align: left;
                            }
                            
                            .invoice-footer {
                                text-align: center;
                                margin-top: 30px;
                                padding-top: 10px;
                                border-top: 1px dashed #ddd;
                                color: #6c757d;
                                font-size: 0.9rem;
                            }
                            
                            .no-print {
                                display: none !important;
                            }
                        }
                        
                        @page {
                            margin: 0;
                            size: ${size === 'small' ? '80mm auto' : 'A4'};
                        }
                        
                        body {
                            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                            font-size: ${size === 'small' ? '12px' : '14px'};
                        }
                        
                        .print-container {
                            width: ${size === 'small' ? '80mm' : '210mm'};
                            padding: ${size === 'small' ? '5px' : '20px'};
                            margin: 0 auto;
                        }
                        
                        .invoice-header {
                            text-align: center;
                            border-bottom: 2px solid #4361ee;
                            padding-bottom: 10px;
                            margin-bottom: 20px;
                        }
                        
                        .invoice-logo {
                            font-size: ${size === 'small' ? '1.5rem' : '2rem'};
                            font-weight: 800;
                            color: #4361ee;
                            margin-bottom: 5px;
                        }
                        
                        .invoice-title {
                            font-size: ${size === 'small' ? '1rem' : '1.5rem'};
                            margin: 5px 0;
                        }
                        
                        .invoice-details {
                            display: grid;
                            grid-template-columns: 1fr 1fr;
                            gap: 15px;
                            margin-bottom: 20px;
                        }
                        
                        .invoice-table {
                            width: 100%;
                            border-collapse: collapse;
                            margin-bottom: 20px;
                        }
                        
                        .invoice-table th, .invoice-table td {
                            padding: ${size === 'small' ? '3px 5px' : '8px 10px'};
                            text-align: right;
                            border-bottom: 1px solid #ddd;
                        }
                        
                        .invoice-table th {
                            background-color: #f8f9fa;
                            font-weight: bold;
                        }
                        
                        .invoice-total {
                            margin-top: 20px;
                            padding-top: 10px;
                                border-top: 2px solid #ddd;
                            text-align: left;
                        }
                        
                        .invoice-footer {
                            text-align: center;
                            margin-top: 30px;
                            padding-top: 10px;
                            border-top: 1px dashed #ddd;
                            color: #6c757d;
                            font-size: 0.9rem;
                        }
                    </style>
                </head>
                <body>
                    <div class="print-container">
                        <div class="invoice-header">
                            <div class="invoice-logo">الکترۆنیات</div>
                            <h2 class="invoice-title">فاکتووری فرۆشتن</h2>
                            <p>کۆدی فاکتوورە: ${invoiceCode}</p>
                            <p>بەروار: ${invoice.date}</p>
                        </div>
                        
                        <div class="invoice-details">
                            <div>
                                <h4>زانیاری فرۆشەر:</h4>
                                <p>ناوی سیستەم: الکترۆنیات</p>
                                <p>ژمارەی موبایل: ٠٧٧٠١٢٣٤٥٦٧</p>
                                <p>ناونیشان: هەولێر، کوردستان</p>
                            </div>
                            
                            <div>
                                <h4>زانیاری کڕیار:</h4>
                                <p>ناوی کڕیار: ${invoice.customer}</p>
                                <p>شێوازی پارەدان: ${invoice.payment === 'cash' ? 'نەقدی' : 'قەرز'}</p>
                            </div>
                        </div>
                        
                        <table class="invoice-table">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>ناوی کاڵا</th>
                                    <th>یەکە</th>
                                    <th>بڕ</th>
                                    <th>نرخ</th>
                                    <th>کۆی گشتی</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${invoice.originalItems.map((item, index) => `
                                    <tr>
                                        <td>${index + 1}</td>
                                        <td>${item.name}</td>
                                        <td>${getUnitName(item.unit)}</td>
                                        <td>${item.quantity}</td>
                                        <td>${item.price.toLocaleString()} دینار</td>
                                        <td>${(item.price * item.quantity).toLocaleString()} دینار</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                        
                        <div class="invoice-total">
                            <p><strong>کۆی گشتی:</strong> ${invoice.total.toLocaleString()} دینار</p>
                            ${invoice.payment === 'credit' ? `
                                <p><strong>قەرز:</strong> ${invoice.total.toLocaleString()} دینار</p>
                            ` : ''}
                        </div>
                        
                        <div class="invoice-footer">
                            <p>سپاس بۆ بەکارهێنانی سیستەمی ئەلکترۆنیات</p>
                            <p>ژمارەی پەیوەندی: ٠٧٧٠١٢٣٤٥٦٧</p>
                            <p>بەروار: ${new Date().toLocaleDateString('ar-IQ')}</p>
                        </div>
                    </div>
                    
                    <script>
                        window.onload = function() {
                            // پرێنتکردن لەسەر بارکردنی پەڕەکە
                            setTimeout(function() {
                                window.print();
                                
                                // داخستنی پەڕە دوای پرێنتکردن
                                setTimeout(function() {
                                    window.close();
                                }, 1000);
                            }, 500);
                        };
                    <\/script>
                </body>
                </html>
            `;
            
            // نووسینی HTML بۆ پەڕەی نوێ
            printWindow.document.open();
            printWindow.document.write(printHTML);
            printWindow.document.close();
            
            // داخستنی مۆدالەکان پاش پرێنتکردن
            setTimeout(() => {
                document.getElementById('printModal').classList.remove('active');
                const detailModal = document.getElementById('invoiceDetailModal');
                if (detailModal) detailModal.classList.remove('active');
            }, 1000);
        }

        // داخستنی مۆدالی کەس
        const closeCustomerModalBtn = document.getElementById('closeCustomerModal');
        if (closeCustomerModalBtn) {
            closeCustomerModalBtn.addEventListener('click', function() {
                document.getElementById('customerModal').classList.remove('active');
            });
        }

        // داخستنی مۆدالی فاکتوور
        const closeInvoiceModalBtn = document.getElementById('closeInvoiceModal');
        if (closeInvoiceModalBtn) {
            closeInvoiceModalBtn.addEventListener('click', function() {
                document.getElementById('invoiceDetailModal').classList.remove('active');
            });
        }

        // نەخشەی تاباتەکان لە مۆدالی کەس
        document.querySelectorAll('[data-customer-tab]').forEach(tab => {
            tab.addEventListener('click', function() {
                const tabId = this.getAttribute('data-customer-tab');
                
                const parent = this.closest('.tab-buttons');
                if (parent) {
                    parent.querySelectorAll('.tab-btn').forEach(b => {
                        b.classList.remove('active');
                    });
                }
                
                this.classList.add('active');
                
                const modal = this.closest('.modal-content');
                if (modal) {
                    modal.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    const tabContent = document.getElementById(tabId + 'Tab');
                    if (tabContent) {
                        tabContent.classList.add('active');
                    }
                }
            });
        });

        // زیادکردنی کەسی نوێ
        const saveCustomerBtn = document.getElementById('saveCustomerBtn');
        if (saveCustomerBtn) {
            saveCustomerBtn.addEventListener('click', function() {
                const name = document.getElementById('newCustomerName').value.trim();
                const phone = document.getElementById('newCustomerPhone').value.trim();
                
                if (!name || !phone) {
                    alert('تکایە ناو و ژمارەی موبایل پڕ بکەرەوە!');
                    return;
                }
                
                // پشکنین بۆ دووبارەبوونەوە
                const existingCustomer = sampleData.customers.find(c => 
                    c.name === name || c.phone === phone
                );
                
                if (existingCustomer) {
                    alert('کەسێک بەم ناوە یان ژمارەیە هەیە!');
                    return;
                }
                
                const newCustomer = {
                    id: sampleData.customers.length + 1,
                    name: name,
                    phone: phone,
                    address: document.getElementById('newCustomerAddress').value.trim() || '',
                    debt: 0
                };
                
                sampleData.customers.push(newCustomer);
                
                // پاککردنەوەی خانەکان
                document.getElementById('newCustomerName').value = '';
                document.getElementById('newCustomerPhone').value = '';
                document.getElementById('newCustomerAddress').value = '';
                
                // نوێکردنەوەی لیست
                populateSampleData();
                
                // گەڕانەوە بۆ لیست
                document.querySelector('.tab-btn[data-tab="customersList"]').click();
                
                alert('کەسی نوێ بە سەرکەوتوویی زیاد کرا!');
            });
        }

        // پاشگەزبوونەوە لە زیادکردنی کەس
        const cancelCustomerBtn = document.getElementById('cancelCustomerBtn');
        if (cancelCustomerBtn) {
            cancelCustomerBtn.addEventListener('click', function() {
                document.querySelector('.tab-btn[data-tab="customersList"]').click();
                
                document.getElementById('newCustomerName').value = '';
                document.getElementById('newCustomerPhone').value = '';
                document.getElementById('newCustomerAddress').value = '';
            });
        }

        // زیادکردنی شەریکی نوێ
        const savePartnerBtn = document.getElementById('savePartnerBtn');
        if (savePartnerBtn) {
            savePartnerBtn.addEventListener('click', function() {
                const name = document.getElementById('newPartnerName').value.trim();
                const phone = document.getElementById('newPartnerPhone').value.trim();
                
                if (!name || !phone) {
                    alert('تکایە ناو و ژمارەی موبایل پڕ بکەرەوە!');
                    return;
                }
                
                // پشکنین بۆ دووبارەبوونەوە
                const existingPartner = sampleData.partners.find(p => 
                    p.name === name || p.phone === phone
                );
                
                if (existingPartner) {
                    alert('شەریکێک بەم ناوە یان ژمارەیە هەیە!');
                    return;
                }
                
                const newPartner = {
                    id: sampleData.partners.length + 1,
                    name: name,
                    phone: phone,
                    address: document.getElementById('newPartnerAddress').value.trim() || '',
                    debt: 0
                };
                
                sampleData.partners.push(newPartner);
                
                // نوێکردنەوەی لیست
                populateSampleData();
                
                // گەڕانەوە بۆ لیست
                document.querySelector('.tab-btn[data-tab="partnersList"]').click();
                
                // پاککردنەوەی خانەکان
                document.getElementById('newPartnerName').value = '';
                document.getElementById('newPartnerPhone').value = '';
                document.getElementById('newPartnerAddress').value = '';
                
                alert('شەریکی نوێ بە سەرکەوتوویی زیاد کرا!');
            });
        }

        // پاشگەزبوونەوە لە زیادکردنی شەریک
        const cancelPartnerBtn = document.getElementById('cancelPartnerBtn');
        if (cancelPartnerBtn) {
            cancelPartnerBtn.addEventListener('click', function() {
                document.querySelector('.tab-btn[data-tab="partnersList"]').click();
                
                document.getElementById('newPartnerName').value = '';
                document.getElementById('newPartnerPhone').value = '';
                document.getElementById('newPartnerAddress').value = '';
            });
        }

        // نوێکردنەوەی کەسەکان
        const refreshCustomersBtn = document.getElementById('refreshCustomers');
        if (refreshCustomersBtn) {
            refreshCustomersBtn.addEventListener('click', function() {
                populateSampleData();
                alert('لیستی کەسەکان نوێ کرایەوە!');
            });
        }

        // نوێکردنەوەی شەریکەکان
        const refreshPartnersBtn = document.getElementById('refreshPartners');
        if (refreshPartnersBtn) {
            refreshPartnersBtn.addEventListener('click', function() {
                populateSampleData();
                alert('لیستی شەریکەکان نوێ کرایەوە!');
            });
        }

        // گەڕان لە کەسەکان (لە بەشی سەرەکی)
        const customerSearchMain = document.getElementById('customerSearchMain');
        if (customerSearchMain) {
            customerSearchMain.addEventListener('input', function() {
                const query = this.value.toLowerCase();
                const suggestions = document.getElementById('customerSearchSuggestions');
                
                if (!suggestions) return;
                
                if (query.length < 2) {
                    suggestions.style.display = 'none';
                    return;
                }
                
                const filteredCustomers = sampleData.customers.filter(c => 
                    c.name.toLowerCase().includes(query) || 
                    c.phone.includes(query)
                );
                
                suggestions.innerHTML = '';
                
                if (filteredCustomers.length === 0) {
                    suggestions.style.display = 'none';
                    return;
                }
                
                filteredCustomers.forEach(customer => {
                    const div = document.createElement('div');
                    div.className = 'suggestion-item';
                    div.textContent = `${customer.name} - ${customer.phone}`;
                    
                    div.addEventListener('click', function() {
                        viewCustomerDetails(customer.id);
                        customerSearchMain.value = '';
                        suggestions.style.display = 'none';
                    });
                    
                    suggestions.appendChild(div);
                });
                
                suggestions.style.display = 'block';
            });
        }

        // هەڵگرتنی گۆڕانکاریەکانی کەس
        const saveCustomerChangesBtn = document.getElementById('saveCustomerChanges');
        if (saveCustomerChangesBtn) {
            saveCustomerChangesBtn.addEventListener('click', function() {
                const customerName = document.getElementById('modalCustomerName').textContent;
                const customer = sampleData.customers.find(c => c.name === customerName);
                
                if (customer) {
                    customer.name = document.getElementById('editCustomerName').value;
                    customer.phone = document.getElementById('editCustomerPhone').value;
                    customer.address = document.getElementById('editCustomerAddress').value;
                    
                    // نوێکردنەوەی مێژووی فرۆشتن
                    sampleData.sales.forEach(sale => {
                        if (sale.customer === customerName) {
                            sale.customer = customer.name;
                        }
                    });
                    
                    populateSampleData();
                    populateSaleHistory();
                    alert('گۆڕانکاریەکان بە سەرکەوتوویی هەڵگیرا!');
                }
            });
        }

        // سڕینەوەی کەس
        const deleteCustomerBtn = document.getElementById('deleteCustomerBtn');
        if (deleteCustomerBtn) {
            deleteCustomerBtn.addEventListener('click', function() {
                const customerName = document.getElementById('modalCustomerName').textContent;
                
                if (confirm(`دڵنیای لە سڕینەوەی کەسی '${customerName}'؟`)) {
                    const customerIndex = sampleData.customers.findIndex(c => c.name === customerName);
                    
                    if (customerIndex !== -1) {
                        // پشکنین ئەگەر کەسەکە قەرزی هەیە
                        const customer = sampleData.customers[customerIndex];
                        if (customer.debt > 0) {
                            if (!confirm('ئەم کەسە قەرزی هەیە! دڵنیای لە سڕینەوە؟')) {
                                return;
                            }
                        }
                        
                        sampleData.customers.splice(customerIndex, 1);
                        
                        // سڕینەوەی فاکتوورەکانی کەسەکە
                        sampleData.sales = sampleData.sales.filter(s => s.customer !== customerName);
                        
                        document.getElementById('customerModal').classList.remove('active');
                        populateSampleData();
                        populateSaleHistory();
                        alert('کەسەکە بە سەرکەوتوویی سڕایەوە!');
                    }
                }
            });
        }

        // زیادکردنی کەس لە لیستەکە
        const addCustomerBtn = document.getElementById('addCustomerBtn');
        if (addCustomerBtn) {
            addCustomerBtn.addEventListener('click', function() {
                document.querySelector('.tab-btn[data-tab="addCustomer"]').click();
            });
        }

        // زیادکردنی شەریک لە لیستەکە
        const addPartnerBtn = document.getElementById('addPartnerBtn');
        if (addPartnerBtn) {
            addPartnerBtn.addEventListener('click', function() {
                document.querySelector('.tab-btn[data-tab="addPartner"]').click();
            });
        }

        // نوێکردنەوەی مێژووی فرۆشتن
        function populateSaleHistory() {
            const saleHistoryList = document.getElementById('saleHistoryList');
            if (!saleHistoryList) return;
            
            saleHistoryList.innerHTML = '';
            
            if (sampleData.sales.length === 0) {
                saleHistoryList.innerHTML = '<li class="list-item">هیچ مێژووی فرۆشتنی تۆمارنەکراوە</li>';
                return;
            }
            
            sampleData.sales.forEach(sale => {
                const li = document.createElement('li');
                li.className = 'list-item';
                li.innerHTML = `
                    <div>
                        <div class="item-name">${sale.code} - ${sale.customer}</div>
                        <div style="font-size: 0.9rem; color: var(--gray);">
                            ${sale.date} - ${sale.payment === 'cash' ? 'نەقدی' : 'قەرز'}
                        </div>
                    </div>
                    <div>
                        <div class="item-value">${sale.total.toLocaleString()} دینار</div>
                        <div class="history-item-actions">
                            <button class="btn btn-info btn-sm" onclick="viewInvoiceDetails(${sale.id})">
                                <i class="fas fa-eye"></i> بینین
                            </button>
                            <button class="btn btn-warning btn-sm" onclick="printRealInvoice('${sale.code}', 'small')">
                                <i class="fas fa-print"></i> بچووک
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="printRealInvoice('${sale.code}', 'A4')">
                                <i class="fas fa-print"></i> A4
                            </button>
                            <button class="btn btn-danger btn-sm" onclick="deleteSaleInvoice(${sale.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
                saleHistoryList.appendChild(li);
            });
        }

        // گۆڕانکاری فاکتوور
        const editInvoiceBtn = document.getElementById('editInvoiceBtn');
        if (editInvoiceBtn) {
            editInvoiceBtn.addEventListener('click', function() {
                const invoiceCode = document.getElementById('modalInvoiceCode').textContent;
                const invoice = sampleData.sales.find(s => s.code === invoiceCode);
                
                if (!invoice) {
                    alert('فاکتوورەکە نەدۆزرایەوە!');
                    return;
                }
                
                editingInvoiceId = invoice.id;
                
                // نیشاندانی مۆدالی دەستکاری
                document.getElementById('editInvoiceCode').textContent = invoiceCode;
                
                // زیادکردنی کاڵاکانی فاکتوور بۆ سەبەتەی دەستکاری
                const editCartItems = document.getElementById('editCartItems');
                editCartItems.innerHTML = '';
                
                invoice.originalItems.forEach((item, index) => {
                    const li = document.createElement('li');
                    li.className = 'cart-item';
                    li.innerHTML = `
                        <div class="cart-item-info">
                            <div class="cart-item-image"><i class="fas fa-${getProductIcon(item.name)}"></i></div>
                            <div class="cart-item-details">
                                <div class="item-name">${item.name}</div>
                                <div class="cart-item-controls">
                                    <div>
                                        <label>بڕ:</label>
                                        <input type="number" value="${item.quantity}" min="1" 
                                               onchange="updateEditCartItemQuantity(${index}, this.value)">
                                    </div>
                                    <div>
                                        <label>نرخ:</label>
                                        <input type="number" value="${item.price}" min="1" 
                                               onchange="updateEditCartItemPrice(${index}, this.value)">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="cart-item-price">
                            <div class="cart-item-total">${(item.price * item.quantity).toLocaleString()} دینار</div>
                            <div style="margin-top: 10px;">
                                <button class="btn btn-danger btn-sm" onclick="removeFromEditCart(${index})">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    `;
                    editCartItems.appendChild(li);
                });
                
                updateEditCartTotal();
                
                // داخستنی مۆدالی بینین و کردنەوەی مۆدالی دەستکاری
                document.getElementById('invoiceDetailModal').classList.remove('active');
                document.getElementById('editInvoiceModal').classList.add('active');
            });
        }

        // نوێکردنەوەی کۆی گشتی سەبەتەی دەستکاری
        function updateEditCartTotal() {
            const editCartItems = document.querySelectorAll('#editCartItems .cart-item');
            let total = 0;
            
            editCartItems.forEach(item => {
                const quantity = parseInt(item.querySelector('input[type="number"]').value) || 0;
                const price = parseInt(item.querySelectorAll('input[type="number"]')[1].value) || 0;
                total += quantity * price;
            });
            
            const editCartTotalElement = document.getElementById('editCartTotalAmount');
            if (editCartTotalElement) {
                editCartTotalElement.textContent = total.toLocaleString();
            }
        }

        // گۆڕانکاری لە بڕی کاڵا لە سەبەتەی دەستکاری
        window.updateEditCartItemQuantity = function(index, newQuantity) {
            updateEditCartTotal();
        };

        // گۆڕانکاری لە نرخی کاڵا لە سەبەتەی دەستکاری
        window.updateEditCartItemPrice = function(index, newPrice) {
            updateEditCartTotal();
        };

        // سڕینەوەی کاڵا لە سەبەتەی دەستکاری
        window.removeFromEditCart = function(index) {
            const editCartItems = document.getElementById('editCartItems');
            const items = editCartItems.querySelectorAll('.cart-item');
            
            if (items.length > index) {
                items[index].remove();
                updateEditCartTotal();
            }
        };

        // داخستنی مۆدالی دەستکاری
        const closeEditInvoiceModalBtn = document.getElementById('closeEditInvoiceModal');
        if (closeEditInvoiceModalBtn) {
            closeEditInvoiceModalBtn.addEventListener('click', function() {
                document.getElementById('editInvoiceModal').classList.remove('active');
            });
        }

        const cancelEditInvoiceBtn = document.getElementById('cancelEditInvoice');
        if (cancelEditInvoiceBtn) {
            cancelEditInvoiceBtn.addEventListener('click', function() {
                document.getElementById('editInvoiceModal').classList.remove('active');
            });
        }

        // هەڵگرتنی گۆڕانکاریەکانی فاکتوور
        const saveEditInvoiceBtn = document.getElementById('saveEditInvoice');
        if (saveEditInvoiceBtn) {
            saveEditInvoiceBtn.addEventListener('click', function() {
                const invoice = sampleData.sales.find(s => s.id === editingInvoiceId);
                if (!invoice) {
                    alert('فاکتوورەکە نەدۆزرایەوە!');
                    return;
                }
                
                // کۆکردنەوەی کاڵاکانی نوێ
                const editCartItems = document.querySelectorAll('#editCartItems .cart-item');
                const newItems = [];
                let newTotal = 0;
                
                editCartItems.forEach(item => {
                    const name = item.querySelector('.item-name').textContent;
                    const quantity = parseInt(item.querySelector('input[type="number"]').value) || 0;
                    const price = parseInt(item.querySelectorAll('input[type="number"]')[1].value) || 0;
                    const itemTotal = quantity * price;
                    
                    newItems.push(name);
                    newTotal += itemTotal;
                    
                    // گۆڕانکاری لە بەردەستایی
                    const product = sampleData.products.find(p => p.name === name);
                    if (product) {
                        // دۆزینەوەی بڕی کۆن
                        const oldItem = invoice.originalItems.find(i => i.name === name);
                        if (oldItem) {
                            const quantityDifference = quantity - oldItem.quantity;
                            product.stock -= quantityDifference;
                        }
                    }
                });
                
                // نوێکردنەوەی فاکتوورەکە
                invoice.items = newItems;
                invoice.total = newTotal;
                invoice.originalItems = Array.from(editCartItems).map((item, index) => {
                    const name = item.querySelector('.item-name').textContent;
                    const quantity = parseInt(item.querySelector('input[type="number"]').value) || 0;
                    const price = parseInt(item.querySelectorAll('input[type="number"]')[1].value) || 0;
                    const product = sampleData.products.find(p => p.name === name);
                    
                    return {
                        id: product ? product.id : index + 1,
                        name: name,
                        quantity: quantity,
                        price: price,
                        unit: product ? product.unit : 'piece'
                    };
                });
                
                // گۆڕانکاری لە قەرز ئەگەر فرۆشتن بە قەرز بووبێت
                if (invoice.payment === 'credit') {
                    const customer = sampleData.customers.find(c => c.name === invoice.customer);
                    if (customer) {
                        // دۆزینەوەی جیاوازی
                        const oldTotal = invoice.total;
                        const difference = newTotal - oldTotal;
                        customer.debt += difference;
                    }
                }
                
                // نوێکردنەوەی داشبۆرد
                populateSampleData();
                populateSaleHistory();
                
                // داخستنی مۆدال
                document.getElementById('editInvoiceModal').classList.remove('active');
                
                alert('گۆڕانکاریەکانی فاکتوور بە سەرکەوتوویی هەڵگیرا!');
            });
        }

        // گەڕان بۆ کاڵا لە بەشی دەستکاری
        const editProductSearch = document.getElementById('editProductSearch');
        if (editProductSearch) {
            editProductSearch.addEventListener('input', function() {
                const query = this.value.toLowerCase();
                const suggestions = document.getElementById('editProductSuggestions');
                
                if (!suggestions) return;
                
                if (query.length < 1) {
                    suggestions.style.display = 'none';
                    return;
                }
                
                const filteredProducts = sampleData.products.filter(p => 
                    p.name.toLowerCase().includes(query) || 
                    p.barcode.includes(query)
                );
                
                suggestions.innerHTML = '';
                
                if (filteredProducts.length === 0) {
                    suggestions.style.display = 'none';
                    return;
                }
                
                filteredProducts.forEach(product => {
                    const div = document.createElement('div');
                    div.className = 'suggestion-item';
                    
                    div.innerHTML = `
                        <div style="display: flex; align-items: center;">
                            <div style="flex: 1;">
                                <div><strong>${product.name}</strong></div>
                                <div style="font-size: 0.9rem; color: var(--gray);">
                                    ${product.salePrice.toLocaleString()} دینار | بەردەست: ${product.stock} ${getUnitName(product.unit)}
                                </div>
                            </div>
                        </div>
                    `;
                    
                    div.addEventListener('click', function() {
                        // زیادکردنی کاڵا بۆ سەبەتەی دەستکاری
                        addToEditCart(product);
                        editProductSearch.value = '';
                        suggestions.style.display = 'none';
                    });
                    
                    suggestions.appendChild(div);
                });
                
                suggestions.style.display = 'block';
            });
        }

        // زیادکردنی کاڵا بۆ سەبەتەی دەستکاری
        function addToEditCart(product) {
            const editCartItems = document.getElementById('editCartItems');
            
            const li = document.createElement('li');
            li.className = 'cart-item';
            li.innerHTML = `
                <div class="cart-item-info">
                    <div class="cart-item-image"><i class="fas fa-${getProductIcon(product.name)}"></i></div>
                    <div class="cart-item-details">
                        <div class="item-name">${product.name}</div>
                        <div class="cart-item-controls">
                            <div>
                                <label>بڕ:</label>
                                <input type="number" value="1" min="1" max="${product.stock}" 
                                       onchange="updateEditCartItemQuantity(${editCartItems.children.length}, this.value)">
                            </div>
                            <div>
                                <label>نرخ:</label>
                                <input type="number" value="${product.salePrice}" min="1" 
                                       onchange="updateEditCartItemPrice(${editCartItems.children.length}, this.value)">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="cart-item-price">
                    <div class="cart-item-total">${product.salePrice.toLocaleString()} دینار</div>
                    <div style="margin-top: 10px;">
                        <button class="btn btn-danger btn-sm" onclick="removeFromEditCart(${editCartItems.children.length})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            `;
            
            editCartItems.appendChild(li);
            updateEditCartTotal();
        }

        // سڕینەوەی فاکتوور
        const deleteInvoiceBtn = document.getElementById('deleteInvoiceBtn');
        if (deleteInvoiceBtn) {
            deleteInvoiceBtn.addEventListener('click', function() {
                const invoiceCode = document.getElementById('modalInvoiceCode').textContent;
                const invoice = sampleData.sales.find(s => s.code === invoiceCode);
                
                if (!invoice) {
                    alert('فاکتوورەکە نەدۆزرایەوە!');
                    return;
                }
                
                if (confirm(`دڵنیای لە سڕینەوەی فاکتووری ${invoiceCode}؟`)) {
                    deleteSaleInvoice(invoice.id);
                    document.getElementById('invoiceDetailModal').classList.remove('active');
                }
            });
        }

        // پرێنتکردنی زانیاری کەس
        const printCustomerInfoBtn = document.getElementById('printCustomerInfo');
        if (printCustomerInfoBtn) {
            printCustomerInfoBtn.addEventListener('click', function() {
                const customerName = document.getElementById('modalCustomerName').textContent;
                const customer = sampleData.customers.find(c => c.name === customerName);
                
                if (!customer) {
                    alert('کەسەکە نەدۆزرایەوە!');
                    return;
                }
                
                const customerInfo = `
                    <!DOCTYPE html>
                    <html lang="ar" dir="rtl">
                    <head>
                        <meta charset="UTF-8">
                        <title>زانیاری کەس - ${customerName}</title>
                        <style>
                            body {
                                font-family: 'Segoe UI', sans-serif;
                                font-size: 14px;
                                line-height: 1.6;
                            }
                            .print-header {
                                text-align: center;
                                border-bottom: 2px solid #4361ee;
                                padding-bottom: 10px;
                                margin-bottom: 20px;
                            }
                            .info-table {
                                width: 100%;
                                border-collapse: collapse;
                            }
                            .info-table td {
                                padding: 8px;
                                border-bottom: 1px solid #ddd;
                            }
                            .info-table td:first-child {
                                font-weight: bold;
                                width: 40%;
                            }
                            @media print {
                                body { margin: 0; padding: 20px; }
                                .no-print { display: none; }
                            }
                        </style>
                    </head>
                    <body>
                        <div class="print-header">
                            <h2>زانیاری کەس: ${customerName}</h2>
                            <p>سیستەمی ئەلکترۆنیات</p>
                        </div>
                        <table class="info-table">
                            <tr>
                                <td>ناوی کەس:</td>
                                <td>${document.getElementById('editCustomerName').value}</td>
                            </tr>
                            <tr>
                                <td>ژمارەی موبایل:</td>
                                <td>${document.getElementById('editCustomerPhone').value}</td>
                            </tr>
                            <tr>
                                <td>ناونیشان:</td>
                                <td>${document.getElementById('editCustomerAddress').value || 'نەزانراو'}</td>
                            </tr>
                            <tr>
                                <td>کۆی قەرز:</td>
                                <td>${document.getElementById('customerTotalDebt').value}</td>
                            </tr>
                            <tr>
                                <td>کۆتا فرۆشتن:</td>
                                <td>${document.getElementById('customerLastPurchase').value}</td>
                            </tr>
                            <tr>
                                <td>کۆی فرۆشتن:</td>
                                <td>${document.getElementById('customerTotalPurchases').value}</td>
                            </tr>
                        </table>
                        <div style="margin-top: 30px; text-align: center; color: #666; font-size: 12px;">
                            <p>بەروار: ${new Date().toLocaleDateString('ar-IQ')}</p>
                            <p>سیستەمی ئەلکترۆنیات - هەولێر، کوردستان</p>
                        </div>
                    </body>
                    </html>
                `;
                
                const printWindow = window.open('', '_blank');
                printWindow.document.open();
                printWindow.document.write(customerInfo);
                printWindow.document.close();
                
                setTimeout(() => {
                    printWindow.print();
                    printWindow.close();
                }, 500);
            });
        }

        // ==============================================
        // بەشی کڕین - فەنکشنە نوێیەکان
        // ==============================================

        // گەڕان بۆ کاڵا لە بەشی کڕین
        const purchaseProductSearch = document.getElementById('purchaseProductSearch');
        if (purchaseProductSearch) {
            purchaseProductSearch.addEventListener('input', function() {
                const query = this.value.toLowerCase();
                const suggestions = document.getElementById('purchaseProductSuggestions');
                
                if (!suggestions) return;
                
                if (query.length < 1) {
                    suggestions.style.display = 'none';
                    return;
                }
                
                const filteredProducts = sampleData.products.filter(p => 
                    p.name.toLowerCase().includes(query) || 
                    p.barcode.includes(query)
                );
                
                suggestions.innerHTML = '';
                
                if (filteredProducts.length === 0) {
                    suggestions.style.display = 'none';
                    return;
                }
                
                filteredProducts.forEach(product => {
                    const div = document.createElement('div');
                    div.className = 'suggestion-item';
                    
                    div.innerHTML = `
                        <div style="display: flex; align-items: center;">
                            <div style="flex: 1;">
                                <div><strong>${product.name}</strong></div>
                                <div style="font-size: 0.9rem; color: var(--gray);">
                                    نرخی کڕین: ${product.purchasePrice.toLocaleString()} دینار
                                </div>
                                <div style="font-size: 0.9rem; color: var(--info);">
                                    بەردەست: ${product.stock} ${getUnitName(product.unit)}
                                </div>
                            </div>
                        </div>
                    `;
                    
                    div.addEventListener('click', function() {
                        addToPurchaseCartDirectly(product);
                        purchaseProductSearch.value = '';
                        suggestions.style.display = 'none';
                    });
                    
                    suggestions.appendChild(div);
                });
                
                suggestions.style.display = 'block';
            });
            
            // چالاککردنی بارکۆد
            purchaseProductSearch.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    const query = this.value.trim();
                    
                    if (query) {
                        // گەڕان بەبارکۆد
                        const product = sampleData.products.find(p => p.barcode === query);
                        if (product) {
                            addToPurchaseCartDirectly(product);
                            this.value = '';
                        } else {
                            // گەڕان بەناو
                            const productByName = sampleData.products.find(p => 
                                p.name.toLowerCase().includes(query.toLowerCase())
                            );
                            if (productByName) {
                                addToPurchaseCartDirectly(productByName);
                                this.value = '';
                            } else {
                                alert('کاڵایەک بەم بارکۆد یان ناوە نەدۆزرایەوە!');
                            }
                        }
                    }
                }
            });
        }

        // زیادکردنی کاڵا ڕاستەوخۆ بۆ سەبەتەی کڕین
        function addToPurchaseCartDirectly(product) {
            const existingItem = purchaseCart.find(item => item.id === product.id);
            
            if (existingItem) {
                existingItem.quantity += 1;
                existingItem.total = existingItem.newPurchasePrice * existingItem.quantity;
            } else {
                const purchaseCartItem = {
                    id: product.id,
                    name: product.name,
                    oldPurchasePrice: product.purchasePrice,
                    newPurchasePrice: product.purchasePrice,
                    oldSalePrice: product.salePrice,
                    newSalePrice: product.salePrice,
                    quantity: 1,
                    unit: product.unit,
                    image: product.image,
                    total: product.purchasePrice
                };
                
                purchaseCart.push(purchaseCartItem);
            }
            
            updatePurchaseCartDisplay();
        }

        // نوێکردنەوەی سەبەتەی کڕین
        function updatePurchaseCartDisplay() {
            const purchaseCartItems = document.getElementById('purchaseCartItems');
            if (!purchaseCartItems) return;
            
            purchaseCartItems.innerHTML = '';
            
            if (purchaseCart.length === 0) {
                purchaseCartItems.innerHTML = '<li class="empty-cart">هیچ کاڵایەک لە سەبەتەدا نییە</li>';
                updatePurchaseCartTotal();
                return;
            }
            
            let total = 0;
            
            purchaseCart.forEach((item, index) => {
                const li = document.createElement('li');
                li.className = 'cart-item';
                
                const product = sampleData.products.find(p => p.id === item.id);
                const itemTotal = item.newPurchasePrice * item.quantity;
                total += itemTotal;
                
                // دروستکردنی وێنەی کاڵا
                const imageHTML = item.image 
                    ? `<img src="${item.image}" alt="${item.name}">`
                    : `<div class="cart-item-image"><i class="fas fa-${getProductIcon(item.name)}"></i></div>`;
                
                li.innerHTML = `
                    <div class="cart-item-info">
                        ${imageHTML}
                        <div class="cart-item-details">
                            <div class="item-name">${item.name}</div>
                            <div class="cart-item-controls">
                                <div>
                                    <label>بڕ:</label>
                                    <input type="number" value="${item.quantity}" min="1" 
                                           onchange="updatePurchaseCartItemQuantity(${index}, this.value)">
                                </div>
                                <div>
                                    <label>نرخی کڕین:</label>
                                    <input type="number" value="${item.newPurchasePrice}" min="1" 
                                           onchange="updatePurchaseCartItemPurchasePrice(${index}, this.value)">
                                </div>
                                <div>
                                    <label>نرخی فرۆشتن:</label>
                                    <input type="number" value="${item.newSalePrice}" min="1" 
                                           onchange="updatePurchaseCartItemSalePrice(${index}, this.value)">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="cart-item-price">
                        <div class="cart-item-total">${itemTotal.toLocaleString()} دینار</div>
                        <div style="margin-top: 10px;">
                            <button class="btn btn-danger btn-sm" onclick="removeFromPurchaseCart(${index})">
                                <i class="fas fa-trash"></i> سڕینەوە
                            </button>
                        </div>
                    </div>
                `;
                
                purchaseCartItems.appendChild(li);
            });
            
            updatePurchaseCartTotal();
        }

        // نوێکردنەوەی کۆی گشتی سەبەتەی کڕین
        function updatePurchaseCartTotal() {
            const total = purchaseCart.reduce((sum, item) => sum + (item.newPurchasePrice * item.quantity), 0);
            const purchaseCartTotalElement = document.getElementById('purchaseCartTotalAmount');
            if (purchaseCartTotalElement) {
                purchaseCartTotalElement.textContent = total.toLocaleString();
            }
        }

        // گۆڕانکاری لە بڕی کاڵا لە سەبەتەی کڕین
        window.updatePurchaseCartItemQuantity = function(index, newQuantity) {
            const quantity = parseInt(newQuantity) || 1;
            purchaseCart[index].quantity = quantity;
            purchaseCart[index].total = purchaseCart[index].newPurchasePrice * quantity;
            updatePurchaseCartDisplay();
        };

        // گۆڕانکاری لە نرخی کڕین لە سەبەتەی کڕین
        window.updatePurchaseCartItemPurchasePrice = function(index, newPrice) {
            const price = parseInt(newPrice) || purchaseCart[index].oldPurchasePrice;
            purchaseCart[index].newPurchasePrice = price;
            purchaseCart[index].total = price * purchaseCart[index].quantity;
            updatePurchaseCartDisplay();
        };

        // گۆڕانکاری لە نرخی فرۆشتن لە سەبەتەی کڕین
        window.updatePurchaseCartItemSalePrice = function(index, newPrice) {
            const price = parseInt(newPrice) || purchaseCart[index].oldSalePrice;
            purchaseCart[index].newSalePrice = price;
            updatePurchaseCartDisplay();
        };

        // سڕینەوە لە سەبەتەی کڕین
        window.removeFromPurchaseCart = function(index) {
            purchaseCart.splice(index, 1);
            updatePurchaseCartDisplay();
        };

        // سڕینەوەی سەبەتەی کڕین
        const clearPurchaseCartBtn = document.getElementById('clearPurchaseCart');
        if (clearPurchaseCartBtn) {
            clearPurchaseCartBtn.addEventListener('click', function() {
                if (purchaseCart.length === 0) return;
                
                if (confirm('دڵنیای لە پاککردنەوەی هەموو کاڵاکانی سەبەتە؟')) {
                    purchaseCart = [];
                    updatePurchaseCartDisplay();
                }
            });
        }

        // هەڵبژاردنی جۆری پارەدان لە کڕین
        document.querySelectorAll('#newPurchase .payment-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('#newPurchase .payment-option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                
                this.classList.add('selected');
                const paymentType = this.getAttribute('data-payment');
                
                const partnerSelection = document.getElementById('partnerSelection');
                if (partnerSelection) {
                    if (paymentType === 'credit') {
                        partnerSelection.style.display = 'block';
                        partnerSelection.classList.add('active');
                    } else {
                        partnerSelection.style.display = 'none';
                        partnerSelection.classList.remove('active');
                    }
                }
            });
        });

        // گەڕان بەدوای شەریکەکان لە کڕین
        const partnerSearchPurchase = document.getElementById('partnerSearchPurchase');
        if (partnerSearchPurchase) {
            partnerSearchPurchase.addEventListener('input', function() {
                const query = this.value.toLowerCase();
                const suggestions = document.getElementById('partnerSuggestionsPurchase');
                
                if (!suggestions) return;
                
                if (query.length < 2) {
                    suggestions.style.display = 'none';
                    return;
                }
                
                const filteredPartners = sampleData.partners.filter(p => 
                    p.name.toLowerCase().includes(query)
                );
                
                suggestions.innerHTML = '';
                
                if (filteredPartners.length === 0) {
                    suggestions.style.display = 'none';
                    return;
                }
                
                filteredPartners.forEach(partner => {
                    // دیاریکردنی رەنگ بەپێی جۆری قەرز
                    let debtText, debtClass;
                    
                    if (partner.debt > 0) {
                        debtText = partner.debt.toLocaleString() + ' دینار (شەریک قەرزداری منە)';
                        debtClass = 'debt-positive';
                    } else if (partner.debt < 0) {
                        debtText = Math.abs(partner.debt).toLocaleString() + ' دینار (من قەرزداری ئەوانم)';
                        debtClass = 'debt-negative';
                    } else {
                        debtText = 'بێ قەرز';
                        debtClass = 'debt-zero';
                    }
                    
                    const div = document.createElement('div');
                    div.className = 'suggestion-item';
                    div.innerHTML = `
                        <div><strong>${partner.name}</strong></div>
                        <div style="font-size: 0.9rem; color: var(--gray);">
                            <span class="${debtClass}">${debtText}</span>
                        </div>
                    `;
                    
                    div.addEventListener('click', function() {
                        partnerSearchPurchase.value = partner.name;
                        suggestions.style.display = 'none';
                    });
                    
                    suggestions.appendChild(div);
                });
                
                suggestions.style.display = 'block';
            });
        }

        // تەواوکردنی کڕین
        const completePurchaseBtn = document.getElementById('completePurchase');
        if (completePurchaseBtn) {
            completePurchaseBtn.addEventListener('click', function() {
                if (purchaseCart.length === 0) {
                    alert('تکایە یەکێک لە کاڵاکان زیاد بکە بۆ سەبەتە!');
                    return;
                }
                
                const paymentType = document.querySelector('#newPurchase .payment-option.selected')?.getAttribute('data-payment') || 'cash';
                
                let selectedPartner = null;
                if (paymentType === 'credit') {
                    const partnerName = document.getElementById('partnerSearchPurchase')?.value;
                    if (!partnerName) {
                        alert('تکایە شەریکێک هەڵبژێرە بۆ کڕین بە قەرز!');
                        return;
                    }
                    selectedPartner = sampleData.partners.find(p => p.name === partnerName);
                }
                
                const total = purchaseCart.reduce((sum, item) => sum + (item.newPurchasePrice * item.quantity), 0);
                
                // زیادکردنی بۆ مێژووی کڕین
                const newPurchase = {
                    id: samplePurchaseData.purchases.length + 1,
                    code: `PUR-${new Date().getFullYear()}-${samplePurchaseData.purchases.length + 1}`,
                    partner: selectedPartner ? selectedPartner.name : 'نەقدی',
                    date: new Date().toISOString().split('T')[0],
                    total: total,
                    payment: paymentType,
                    items: purchaseCart.map(item => ({
                        name: item.name, 
                        quantity: item.quantity, 
                        price: item.newPurchasePrice,
                        salePrice: item.newSalePrice
                    }))
                };
                
                samplePurchaseData.purchases.unshift(newPurchase);
                
                // ئەگەر کڕین بە نەقدی بوو، پارە کەم بکە
                if (paymentType === 'cash') {
                    if (sampleData.cashBalance < total) {
                        alert(`کۆی پارەی واسڵ کراو بەس نییە! کۆی پارە: ${sampleData.cashBalance.toLocaleString()} دینار، کڕین: ${total.toLocaleString()} دینار`);
                        return;
                    }
                    sampleData.cashBalance -= total;
                    updateDashboardCash();
                    updateAllDashboardCards();
                    alert(`کڕینەکە بە نەقدی تەواو بوو! ${total.toLocaleString()} دینار لە کۆی پارەی واسڵ کراو کەم کرا.`);
                } else if (paymentType === 'credit' && selectedPartner) {
                    // چاکسازی بەپێی حاڵەت:
                    if (selectedPartner.debt <= 0) {
                        // ئەگەر من قەرزداری شەریکم یان بێ قەرز
                        selectedPartner.debt -= total;
                    } else {
                        // ئەگەر شەریک قەرزداری منە
                        selectedPartner.debt += total;
                    }
                    alert(`کڕینەکە بە قەرز تەواو بوو! قەرزی شەریک نوێکرایەوە.`);
                }
                
                // زیادکردنی کاڵاکان بۆ مخزن و نوێکردنەوەی نرخەکان
                purchaseCart.forEach(item => {
                    const product = sampleData.products.find(p => p.id === item.id);
                    if (product) {
                        product.stock += item.quantity;
                        product.purchasePrice = item.newPurchasePrice;
                        product.salePrice = item.newSalePrice;
                    }
                });
                
                // پاککردنەوەی سەبەتە
                purchaseCart = [];
                updatePurchaseCartDisplay();
                
                // پاککردنەوەی خانەکان
                if (document.getElementById('partnerSearchPurchase')) {
                    document.getElementById('partnerSearchPurchase').value = '';
                }
                
                // نوێکردنەوەی داتا
                populateSampleData();
                populatePurchaseHistory();
                
                alert('کڕینەکە بە سەرکەوتوویی تەواو بوو!');
            });
        }

        // نوێکردنەوەی مێژووی کڕین
        function populatePurchaseHistory() {
            const purchaseHistoryList = document.getElementById('purchaseHistoryList');
            if (!purchaseHistoryList) return;
            
            purchaseHistoryList.innerHTML = '';
            
            if (samplePurchaseData.purchases.length === 0) {
                purchaseHistoryList.innerHTML = '<li class="list-item">هیچ مێژووی کڕینی تۆمارنەکراوە</li>';
                return;
            }
            
            samplePurchaseData.purchases.forEach(purchase => {
                const li = document.createElement('li');
                li.className = 'list-item';
                li.setAttribute('data-purchase-id', purchase.id);
                li.innerHTML = `
                    <div>
                        <div class="item-name">${purchase.code} - ${purchase.partner}</div>
                        <div style="font-size: 0.9rem; color: var(--gray);">
                            ${purchase.date} - ${purchase.payment === 'cash' ? 'نەقدی' : 'قەرز'}
                        </div>
                        <div style="font-size: 0.9rem; color: var(--info);">
                            ${purchase.items.length} کاڵا
                        </div>
                    </div>
                    <div>
                        <div class="item-value">${purchase.total.toLocaleString()} دینار</div>
                        <div class="history-item-actions">
                            <button class="btn btn-info btn-sm" onclick="viewPurchaseDetails(${purchase.id})">
                                <i class="fas fa-eye"></i> بینین
                            </button>
                            <button class="btn btn-danger btn-sm" onclick="deletePurchase(${purchase.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
                purchaseHistoryList.appendChild(li);
            });
        }

        // بینینی وردەکارییەکانی کڕین
        window.viewPurchaseDetails = function(purchaseId) {
            const purchase = samplePurchaseData.purchases.find(p => p.id === purchaseId);
            if (!purchase) return;
            
            // چاک کردنی ئەگەر مۆدالێکی پێشوو هەبێت
            const existingModal = document.getElementById('purchaseDetailModal');
            if (existingModal) {
                existingModal.remove();
            }
            
            const modalHTML = `
                <div class="modal active" id="purchaseDetailModal">
                    <div class="modal-content" style="max-width: 1000px;">
                        <div class="modal-header">
                            <h3>فاکتووری کڕین: ${purchase.code}</h3>
                            <button class="modal-close" onclick="document.getElementById('purchaseDetailModal').remove()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="modal-body">
                            <div class="invoice">
                                <div class="invoice-header">
                                    <div class="invoice-logo">الکترۆنیات</div>
                                    <h2>فاکتووری کڕین</h2>
                                    <p>کۆدی فاکتوورە: ${purchase.code}</p>
                                    <p>بەروار: ${purchase.date}</p>
                                </div>
                                
                                <div class="invoice-details">
                                    <div>
                                        <h4>زانیاری فرۆشەر:</h4>
                                        <p>ناوی سیستەم: الکترۆنیات</p>
                                    </div>
                                    
                                    <div>
                                        <h4>زانیاری شەریک:</h4>
                                        <p>ناوی شەریک: ${purchase.partner}</p>
                                        <p>شێوازی پارەدان: ${purchase.payment === 'cash' ? 'نەقدی' : 'قەرز'}</p>
                                    </div>
                                </div>
                                
                                <table class="invoice-table">
                                    <thead>
                                        <tr>
                                            <th>#</th>
                                            <th>ناوی کاڵا</th>
                                            <th>بڕ</th>
                                            <th>نرخی کڕین</th>
                                            <th>نرخی فرۆشتن</th>
                                            <th>کۆی گشتی</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${purchase.items.map((item, index) => {
                                            return `
                                                <tr>
                                                    <td>${index + 1}</td>
                                                    <td>${item.name}</td>
                                                    <td>${item.quantity}</td>
                                                    <td>${item.price.toLocaleString()} دینار</td>
                                                    <td>${item.salePrice.toLocaleString()} دینار</td>
                                                    <td>${(item.price * item.quantity).toLocaleString()} دینار</td>
                                                </tr>
                                            `;
                                        }).join('')}
                                    </tbody>
                                </table>
                                
                                <div class="invoice-total">
                                    <p><strong>کۆی گشتی:</strong> ${purchase.total.toLocaleString()} دینار</p>
                                </div>
                            </div>
                            
                            <div class="print-options" style="margin-top: 30px;">
                                <button class="btn btn-danger" onclick="document.getElementById('purchaseDetailModal').remove()">
                                    <i class="fas fa-times"></i> داخستن
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        };

        // سڕینەوەی کڕین
        window.deletePurchase = function(purchaseId) {
            if (confirm('دڵنیای لە سڕینەوەی ئەم فاکتوورەی کڕین؟')) {
                const index = samplePurchaseData.purchases.findIndex(p => p.id === purchaseId);
                if (index !== -1) {
                    const purchase = samplePurchaseData.purchases[index];
                    
                    // گەڕاندنەوەی پارە ئەگەر کڕین بە نەقدی بوو
                    if (purchase.payment === 'cash') {
                        sampleData.cashBalance += purchase.total;
                        updateDashboardCash();
                    } else if (purchase.payment === 'credit') {
                        const partner = sampleData.partners.find(p => p.name === purchase.partner);
                        if (partner) {
                            // چاکسازی: گەڕاندنەوەی قەرز بەپێی حاڵەت
                            if (partner.debt <= 0) {
                                // من قەرزداری شەریکم، قەرزی زیاد دەبێت
                                partner.debt += purchase.total;
                            } else {
                                // شەریک قەرزداری منە، قەرزی کەم دەبێت
                                partner.debt -= purchase.total;
                            }
                        }
                    }
                    
                    // گەڕاندنەوەی کاڵاکان لە مخزن
                    purchase.items.forEach(item => {
                        const product = sampleData.products.find(p => p.name === item.name);
                        if (product) {
                            product.stock -= item.quantity;
                            if (product.stock < 0) product.stock = 0;
                        }
                    });
                    
                    samplePurchaseData.purchases.splice(index, 1);
                    populatePurchaseHistory();
                    populateSampleData();
                    alert('فاکتووری کڕین بە سەرکەوتوویی سڕایەوە!');
                }
            }
        };

        // نوێکردنەوەی مێژووی کڕین
        const refreshPurchaseHistoryBtn = document.getElementById('refreshPurchaseHistory');
        if (refreshPurchaseHistoryBtn) {
            refreshPurchaseHistoryBtn.addEventListener('click', function() {
                populatePurchaseHistory();
                alert('مێژووی کڕین نوێ کرایەوە!');
            });
        }

        // گەڕان لە مێژووی کڕین
        const purchaseHistorySearch = document.getElementById('purchaseHistorySearch');
        if (purchaseHistorySearch) {
            purchaseHistorySearch.addEventListener('input', function() {
                const query = this.value.toLowerCase();
                const items = document.querySelectorAll('#purchaseHistoryList .list-item');
                
                items.forEach(item => {
                    const text = item.textContent.toLowerCase();
                    if (text.includes(query)) {
                        item.style.display = 'flex';
                    } else {
                        item.style.display = 'none';
                    }
                });
            });
        }

        // ==============================================
        // بەشی پارەواسڵکردن - فەنکشنە نوێیەکان
        // ==============================================

        // نوێکردنەوەی مێژووی پارەواسڵکردن
        function updatePaymentHistoryDisplay() {
            const paymentHistoryList = document.getElementById('paymentHistoryList');
            if (!paymentHistoryList) return;
            
            paymentHistoryList.innerHTML = '';
            
            if (sampleData.paymentHistory.length === 0) {
                paymentHistoryList.innerHTML = '<li class="list-item">هیچ مێژوویەکی پارەواسڵکردن نییە</li>';
                return;
            }
            
            sampleData.paymentHistory.forEach(payment => {
                const li = document.createElement('li');
                li.className = 'list-item';
                
                li.innerHTML = `
                    <div>
                        <div class="item-name">${payment.debtorName}</div>
                        <div style="font-size: 0.9rem; color: var(--gray);">
                            ${payment.date} - ${payment.method === 'cash' ? 'نەقدی' : payment.method === 'transfer' ? 'گوازینەوە' : 'چەک'}
                        </div>
                        <div style="font-size: 0.9rem; color: var(--info);">
                            ${payment.notes || 'بێ تێبینی'}
                        </div>
                    </div>
                    <div>
                        <div class="item-value debt-payment">${payment.amount.toLocaleString()} دینار</div>
                        <div style="margin-top: 10px;">
                            <button class="btn btn-danger btn-sm" onclick="deletePayment(${payment.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
                paymentHistoryList.appendChild(li);
            });
        }

        // نوێکردنەوەی مێژووی پارەواسڵکردن
        const refreshPaymentHistoryBtn = document.getElementById('refreshPaymentHistory');
        if (refreshPaymentHistoryBtn) {
            refreshPaymentHistoryBtn.addEventListener('click', function() {
                updatePaymentHistoryDisplay();
                alert('مێژووی پارەواسڵکردن نوێ کرایەوە!');
            });
        }

        // گەڕان لە مێژووی پارەواسڵکردن
        const paymentHistorySearch = document.getElementById('paymentHistorySearch');
        if (paymentHistorySearch) {
            paymentHistorySearch.addEventListener('input', function() {
                const query = this.value.toLowerCase();
                const items = document.querySelectorAll('#paymentHistoryList .list-item');
                
                items.forEach(item => {
                    const text = item.textContent.toLowerCase();
                    if (text.includes(query)) {
                        item.style.display = 'flex';
                    } else {
                        item.style.display = 'none';
                    }
                });
            });
        }

        // ==============================================
        // بەشی سەرفکردن - فەنکشنە نوێیەکان
        // ==============================================

        // دەستنیشانکردنی جۆری سەرفکردن
        const expenseTypeSelect = document.getElementById('expenseType');
        if (expenseTypeSelect) {
            expenseTypeSelect.addEventListener('change', function() {
                const type = this.value;
                
                // هەموو بەشەکان شاردراوە بکە
                document.getElementById('expensePartnerSection').style.display = 'none';
                document.getElementById('expenseCustomerSection').style.display = 'none';
                document.getElementById('expenseOtherSection').style.display = 'none';
                
                // پاککردنەوەی هەڵبژاردنەکان
                document.getElementById('expensePartnerSearch').value = '';
                document.getElementById('expenseCustomerSearch').value = '';
                document.getElementById('selectedPartnerInfo').style.display = 'none';
                document.getElementById('selectedCustomerInfo').style.display = 'none';
                
                // نیشاندانی بەشی هەڵبژێردراو
                if (type === 'partner') {
                    document.getElementById('expensePartnerSection').style.display = 'block';
                } else if (type === 'customer') {
                    document.getElementById('expenseCustomerSection').style.display = 'block';
                } else if (type === 'other') {
                    document.getElementById('expenseOtherSection').style.display = 'block';
                }
            });
        }

        // نوێکردنەوەی مێژووی سەرفکردن
        function updateExpenseHistoryDisplay() {
            const expenseHistoryList = document.getElementById('expenseHistoryList');
            if (!expenseHistoryList) return;
            
            expenseHistoryList.innerHTML = '';
            
            if (sampleData.expenseHistory.length === 0) {
                expenseHistoryList.innerHTML = '<li class="list-item">هیچ مێژوویەکی سەرفکردن نییە</li>';
                return;
            }
            
            sampleData.expenseHistory.forEach(expense => {
                const li = document.createElement('li');
                li.className = 'list-item';
                
                // دروستکردنی پێناسە بەپێی جۆری سەرفکردن
                let description = expense.description;
                let icon = 'fa-money-bill-wave';
                let colorClass = 'debt-expense';
                
                if (expense.type === 'partner') {
                    icon = 'fa-handshake';
                    colorClass = 'debt-negative';
                } else if (expense.type === 'customer') {
                    icon = 'fa-user';
                    colorClass = 'debt-positive';
                } else if (expense.type === 'other') {
                    icon = 'fa-file-invoice-dollar';
                    colorClass = 'debt-expense';
                }
                
                li.innerHTML = `
                    <div>
                        <div class="item-name">${description}</div>
                        <div style="font-size: 0.9rem; color: var(--gray);">
                            <i class="fas ${icon}"></i> ${expense.date}
                            ${expense.categoryName ? ` | پۆل: ${expense.categoryName}` : ''}
                        </div>
                    </div>
                    <div>
                        <div class="item-value ${colorClass}">${expense.amount.toLocaleString()} دینار</div>
                        <div style="margin-top: 10px;">
                            <button class="btn btn-danger btn-sm" onclick="deleteExpense(${expense.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
                expenseHistoryList.appendChild(li);
            });
        }

        // نوێکردنەوەی مێژووی سەرفکردن
        const refreshExpenseHistoryBtn = document.getElementById('refreshExpenseHistory');
        if (refreshExpenseHistoryBtn) {
            refreshExpenseHistoryBtn.addEventListener('click', function() {
                updateExpenseHistoryDisplay();
                alert('مێژووی سەرفکردن نوێ کرایەوە!');
            });
        }

        // ==============================================
        // فەنکشنی پەیوەندیدار بە وەشانی پێشوو
        // ==============================================

        // فەنکشنی بینینی فاکتووری فرۆشتن (پەیوەندیدار)
        window.viewSaleInvoiceDetails = function(saleId) {
            viewInvoiceDetails(saleId);
        };

        // فەنکشنی سڕینەوەی پارەواسڵکردن (پەیوەندیدار)
        window.deletePayment = function(paymentId) {
            if (confirm('دڵنیای لە سڕینەوەی ئەم پارەواسڵکردنە؟')) {
                const paymentIndex = sampleData.paymentHistory.findIndex(p => p.id === paymentId);
                if (paymentIndex !== -1) {
                    sampleData.paymentHistory.splice(paymentIndex, 1);
                    updatePaymentHistoryDisplay();
                    alert('پارەواسڵکردنەکە بە سەرکەوتوویی سڕایەوە!');
                }
            }
        };

        // فەنکشنی سڕینەوەی سەرفکردن (پەیوەندیدار)
        window.deleteExpense = function(expenseId) {
            if (confirm('دڵنیای لە سڕینەوەی ئەم سەرفکردنە؟')) {
                const expenseIndex = sampleData.expenseHistory.findIndex(e => e.id === expenseId);
                if (expenseIndex !== -1) {
                    sampleData.expenseHistory.splice(expenseIndex, 1);
                    updateExpenseHistoryDisplay();
                    calculateMonthlyExpense();
                    alert('سەرفکردنەکە بە سەرکەوتوویی سڕایەوە!');
                }
            }
        };

        // ==============================================
        // فەرمانەکانی زیادکراو بۆ بەکارهێنان لە HTML
        // ==============================================

        // نوێکردنەوەی گەڕان لە مخزن
        const inventorySearch = document.getElementById('inventorySearch');
        if (inventorySearch) {
            inventorySearch.addEventListener('input', function() {
                const query = this.value.toLowerCase();
                const items = document.querySelectorAll('#productList .list-item');
                
                items.forEach(item => {
                    const text = item.textContent.toLowerCase();
                    if (text.includes(query)) {
                        item.style.display = 'flex';
                    } else {
                        item.style.display = 'none';
                    }
                });
            });
        }

        // چالاککردنی تاباتەکان لە بەشی پارەواسڵکردن
        document.querySelectorAll('#cashSettlementSection .tab-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const tabId = this.getAttribute('data-tab');
                
                const parent = this.closest('.tab-buttons');
                if (parent) {
                    parent.querySelectorAll('.tab-btn').forEach(b => {
                        b.classList.remove('active');
                    });
                }
                
                this.classList.add('active');
                
                const container = this.closest('.sale-container');
                if (container) {
                    container.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    const tabContent = document.getElementById(tabId);
                    if (tabContent) {
                        tabContent.classList.add('active');
                    }
                }
            });
        });

        // دەستپێکردنی سیستم
        window.onload = function() {
            // دانانی بەرواری ئەمڕۆ بۆ هەموو خانەکانی بەروار
            const today = new Date().toISOString().split('T')[0];
            document.querySelectorAll('input[type="date"]').forEach(input => {
                if (!input.value) {
                    input.value = today;
                }
            });
            
            // چالاککردنی گەڕان لە هەموو بەشەکان
            console.log('سیستەمی فرۆشتی ئەلکترۆنیات ئامادەیە!');
        };
    </script>
</body>
</html>